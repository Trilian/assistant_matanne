<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Audit Complet v3 â€” Assistant Matanne</title>
<style>
/* ===== RESET & BASE ===== */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
:root {
  --bg: #ffffff; --bg-alt: #f8f9fa; --bg-card: #ffffff; --bg-sidebar: #1e293b;
  --text: #1e293b; --text-muted: #64748b; --text-sidebar: #e2e8f0;
  --border: #e2e8f0; --accent: #3b82f6; --accent-light: #eff6ff;
  --green: #10b981; --green-bg: #ecfdf5; --yellow: #f59e0b; --yellow-bg: #fffbeb;
  --red: #ef4444; --red-bg: #fef2f2; --orange: #f97316; --orange-bg: #fff7ed;
  --purple: #8b5cf6; --purple-bg: #f5f3ff; --cyan: #06b6d4;
  --shadow: 0 1px 3px rgba(0,0,0,.1); --shadow-lg: 0 4px 15px rgba(0,0,0,.1);
  --radius: 8px; --radius-lg: 12px;
  --font: 'Segoe UI', system-ui, -apple-system, sans-serif;
  --mono: 'Cascadia Code', 'Fira Code', 'Consolas', monospace;
  --sidebar-w: 280px;
}
@media (prefers-color-scheme: dark) {
  :root {
    --bg: #0f172a; --bg-alt: #1e293b; --bg-card: #1e293b; --bg-sidebar: #0f172a;
    --text: #e2e8f0; --text-muted: #94a3b8; --border: #334155;
    --accent-light: #1e3a5f; --green-bg: #064e3b; --yellow-bg: #78350f;
    --red-bg: #7f1d1d; --orange-bg: #7c2d12; --purple-bg: #4c1d95;
    --shadow: 0 1px 3px rgba(0,0,0,.3); --shadow-lg: 0 4px 15px rgba(0,0,0,.3);
  }
}
html { scroll-behavior: smooth; font-size: 15px; }
body { font-family: var(--font); color: var(--text); background: var(--bg); line-height: 1.6; }
a { color: var(--accent); text-decoration: none; }
a:hover { text-decoration: underline; }
code { font-family: var(--mono); font-size: .86em; background: var(--bg-alt); padding: 2px 6px; border-radius: 4px; }
pre { background: var(--bg-alt); padding: 16px; border-radius: var(--radius); overflow-x: auto; font-size: .83rem; border: 1px solid var(--border); }
pre code { background: none; padding: 0; }
h1,h2,h3,h4 { font-weight: 700; line-height: 1.3; }
hr { border: none; border-top: 1px solid var(--border); margin: 2rem 0; }

/* ===== SIDEBAR ===== */
.sidebar { position: fixed; top: 0; left: 0; width: var(--sidebar-w); height: 100vh;
  background: var(--bg-sidebar); color: var(--text-sidebar); overflow-y: auto; z-index: 100; padding: 1.5rem 0;
  border-right: 1px solid rgba(255,255,255,.1); }
.sidebar .logo { text-align: center; padding: 0 1.2rem .8rem; border-bottom: 1px solid rgba(255,255,255,.1); margin-bottom: 1rem; }
.sidebar .logo span { font-size: 1.3rem; font-weight: 800; color: var(--accent); }
.sidebar .logo small { display: block; color: var(--text-muted); font-size: .72rem; margin-top: 2px; }
.sidebar nav a { display: flex; align-items: center; padding: .35rem 1.2rem; color: var(--text-sidebar);
  font-size: .78rem; transition: all .15s; gap: .5rem; border-left: 3px solid transparent; }
.sidebar nav a:hover { background: rgba(255,255,255,.08); text-decoration: none; border-left-color: var(--accent); }
.sidebar nav a.st { font-weight: 700; font-size: .72rem; color: var(--text-muted); text-transform: uppercase;
  letter-spacing: .06em; padding-top: .7rem; cursor: default; }
.sidebar nav a.st:hover { background: none; border-left-color: transparent; }
.sidebar nav a .nb { margin-left: auto; font-size: .68rem; padding: 1px 7px; border-radius: 10px; font-weight: 600; }

/* ===== MAIN CONTENT ===== */
.main { margin-left: var(--sidebar-w); padding: 2rem 3rem 4rem; max-width: 1100px; }
.main > section { margin-bottom: 3rem; }
.main h1 { font-size: 1.9rem; margin-bottom: .3rem; }
.main h2 { font-size: 1.4rem; margin: 2.5rem 0 1rem; padding-bottom: .4rem; border-bottom: 2px solid var(--accent); }
.main h3 { font-size: 1.1rem; margin: 1.5rem 0 .6rem; }
.main h4 { font-size: .95rem; margin: 1rem 0 .4rem; color: var(--text-muted); }
p, li { margin-bottom: .4rem; }
ul, ol { padding-left: 1.5rem; }
table { width: 100%; border-collapse: collapse; margin: .8rem 0; font-size: .82rem; }
th, td { text-align: left; padding: .5rem .7rem; border-bottom: 1px solid var(--border); }
th { font-weight: 700; background: var(--bg-alt); position: sticky; top: 0; white-space: nowrap; }
tr:hover { background: var(--accent-light); }
.ac { text-align: center; }
.ar { text-align: right; }

/* ===== CARDS ===== */
.card { background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius-lg);
  padding: 1.1rem 1.4rem; margin: 1rem 0; box-shadow: var(--shadow); }

/* ===== BADGES ===== */
.b { display: inline-block; padding: 2px 9px; border-radius: 12px; font-size: .76rem; font-weight: 600; }
.bg { background: var(--green-bg); color: var(--green); }
.by { background: var(--yellow-bg); color: var(--yellow); }
.br { background: var(--red-bg); color: var(--red); }
.ba { background: var(--accent-light); color: var(--accent); }
.bp { background: var(--purple-bg); color: var(--purple); }
.bo { background: var(--orange-bg); color: var(--orange); }
.sc { font-size: 1.2rem; font-weight: 800; }
.sg { color: var(--green); }
.sy { color: var(--yellow); }
.sr { color: var(--red); }

/* ===== PROGRESS BARS ===== */
.pb { background: var(--bg-alt); border-radius: 10px; height: 10px; overflow: hidden; margin: 4px 0; }
.pf { height: 100%; border-radius: 10px; transition: width .4s; }
.pfg { background: var(--green); }
.pfy { background: var(--yellow); }
.pfr { background: var(--red); }
.pfa { background: var(--accent); }

/* ===== STATS GRID ===== */
.sg2 { display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin: 1rem 0; }
.sc2 { background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius);
  padding: .9rem 1rem; text-align: center; box-shadow: var(--shadow); }
.sc2 .sv { font-size: 1.8rem; font-weight: 800; line-height: 1.2; }
.sc2 .sl { font-size: .75rem; color: var(--text-muted); margin-top: .2rem; }

/* ===== RADAR ===== */
.rc { display: flex; flex-wrap: wrap; gap: 1.2rem; margin: 1rem 0; }
.ri { flex: 1; min-width: 200px; }
.ri .rl { display: flex; justify-content: space-between; font-size: .84rem; margin-bottom: 3px; }

/* ===== COLLAPSIBLE ===== */
details { border: 1px solid var(--border); border-radius: var(--radius); margin: .7rem 0; overflow: hidden; }
details[open] { box-shadow: var(--shadow); }
summary { padding: .65rem 1rem; cursor: pointer; font-weight: 600; font-size: .92rem;
  background: var(--bg-alt); display: flex; align-items: center; gap: .5rem; list-style: none; }
summary::-webkit-details-marker { display: none; }
summary::before { content: 'â–¶'; font-size: .65rem; transition: transform .2s; display: inline-block; width: .9rem; }
details[open] summary::before { transform: rotate(90deg); }
details > :not(summary) { padding: .7rem 1rem; }

/* ===== SEVERITY TAGS ===== */
.tag { display: inline-block; padding: 1px 7px; border-radius: 4px; font-size: .73rem; font-weight: 600; margin-right: 3px; vertical-align: middle; }
.tc { background: var(--red-bg); color: var(--red); }
.th { background: var(--orange-bg); color: var(--orange); }
.tm { background: var(--yellow-bg); color: var(--yellow); }
.tl { background: var(--green-bg); color: var(--green); }
.ti { background: var(--accent-light); color: var(--accent); }
.tf { background: #d1fae5; color: #047857; }

/* ===== DELTA ===== */
.d { font-size: .73rem; font-weight: 700; margin-left: 5px; }
.du { color: var(--green); }
.dd { color: var(--red); }
.ds { color: var(--text-muted); }

/* ===== TIMELINE ===== */
.tl2 { position: relative; padding-left: 2rem; margin: 1.5rem 0; }
.tl2::before { content: ''; position: absolute; left: 8px; top: 0; bottom: 0; width: 3px; background: var(--border); border-radius: 3px; }
.ti2 { position: relative; margin-bottom: 1.3rem; }
.ti2::before { content: ''; position: absolute; left: -2rem; top: 6px; width: 14px; height: 14px;
  border-radius: 50%; border: 3px solid var(--accent); background: var(--bg); }
.ti2.done::before { border-color: var(--green); background: var(--green); }
.ti2.p1::before { border-color: var(--red); }
.ti2.p2::before { border-color: var(--orange); }
.ti2.p3::before { border-color: var(--yellow); }
.ti2.p4::before { border-color: var(--accent); }
.ti2 h4 { margin: 0 0 .3rem; }
.ti2 p { margin: 0; font-size: .88rem; color: var(--text-muted); }

/* ===== INNOVATION GRID ===== */
.ig { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 1rem; margin: 1rem 0; }
.ic { border: 1px solid var(--border); border-radius: var(--radius-lg); padding: 1.1rem;
  background: var(--bg-card); border-left: 4px solid var(--accent); box-shadow: var(--shadow); }
.ic h4 { margin: 0 0 .4rem; font-size: .95rem; }
.ic .im { font-size: .76rem; margin-top: .4rem; }
.ic .im span { font-weight: 700; }

/* ===== ADOPTION ROW ===== */
.ar2 { display: flex; align-items: center; gap: .8rem; padding: .4rem 0; border-bottom: 1px solid var(--border); }
.ar2 .cn { flex: 0 0 200px; font-weight: 600; font-size: .84rem; }
.ar2 .ra { flex: 0 0 110px; text-align: right; font-size: .84rem; }

/* ===== COMPLETENESS TABLE ===== */
.ct td:nth-child(3) { text-align: center; font-weight: 700; }

/* ===== PRINT ===== */
@media print {
  .sidebar { display: none; }
  .main { margin-left: 0; padding: 1rem; max-width: 100%; }
  details { break-inside: avoid; }
  .card, details { box-shadow: none; border: 1px solid #ccc; }
  table { font-size: .78rem; }
}
@media (max-width: 900px) {
  .sidebar { display: none; }
  .main { margin-left: 0; padding: 1.5rem; }
  .sg2 { grid-template-columns: repeat(2, 1fr); }
}
</style>
</head>
<body>

<!-- ==================== SIDEBAR ==================== -->
<aside class="sidebar">
  <div class="logo">
    <span>ğŸ  Assistant Matanne</span>
    <small>Audit complet v3 â€” 24 fÃ©v. 2026</small>
  </div>
  <nav>
    <a href="#exec" style="font-weight:700;color:#fff;">ğŸ“Š Tableau de bord</a>
    <a href="#completeness">âœ… ComplÃ©tude projet</a>
    <a href="#changelog">ğŸ”„ Changelog v2â†’v3</a>
    <a class="st">ANALYSE DÃ‰TAILLÃ‰E</a>
    <a href="#core">ğŸ§± src/core/<span class="nb" style="background:#10b981;color:#fff;">8.5</span></a>
    <a href="#core-ai">&nbsp;â†³ ai/</a>
    <a href="#core-caching">&nbsp;â†³ caching/</a>
    <a href="#core-config">&nbsp;â†³ config/</a>
    <a href="#core-db">&nbsp;â†³ db/</a>
    <a href="#core-decorators">&nbsp;â†³ decorators/</a>
    <a href="#core-models">&nbsp;â†³ models/</a>
    <a href="#core-state">&nbsp;â†³ state/</a>
    <a href="#core-validation">&nbsp;â†³ validation/</a>
    <a href="#core-monitoring">&nbsp;â†³ monitoring/</a>
    <a href="#core-resilience">&nbsp;â†³ resilience/</a>
    <a href="#core-observability">&nbsp;â†³ observability/</a>
    <a href="#core-dateutils">&nbsp;â†³ date_utils/</a>
    <a href="#core-root">&nbsp;â†³ fichiers racine</a>
    <a href="#services">âš™ï¸ src/services/<span class="nb" style="background:#10b981;color:#fff;">8.2</span></a>
    <a href="#svc-core">&nbsp;â†³ core/ (infrastructure)</a>
    <a href="#svc-cuisine">&nbsp;â†³ cuisine/</a>
    <a href="#svc-famille">&nbsp;â†³ famille/</a>
    <a href="#svc-integrations">&nbsp;â†³ integrations/</a>
    <a href="#svc-inventaire">&nbsp;â†³ inventaire/</a>
    <a href="#svc-jeux">&nbsp;â†³ jeux/</a>
    <a href="#svc-maison">&nbsp;â†³ maison/</a>
    <a href="#svc-rapports">&nbsp;â†³ rapports/</a>
    <a href="#modules">ğŸ“¦ src/modules/<span class="nb" style="background:#10b981;color:#fff;">8.5</span></a>
    <a href="#mod-cuisine">&nbsp;â†³ cuisine/ (51 fichiers)</a>
    <a href="#mod-famille">&nbsp;â†³ famille/ (26 fichiers)</a>
    <a href="#mod-maison">&nbsp;â†³ maison/ (34 fichiers)</a>
    <a href="#mod-jeux">&nbsp;â†³ jeux/ (28 fichiers)</a>
    <a href="#mod-planning">&nbsp;â†³ planning/ (12 fichiers)</a>
    <a href="#mod-parametres">&nbsp;â†³ parametres/ (9 fichiers)</a>
    <a href="#mod-utilitaires">&nbsp;â†³ utilitaires/ (13 fichiers)</a>
    <a href="#mod-framework">&nbsp;â†³ _framework/</a>
    <a href="#ui">ğŸ¨ src/ui/<span class="nb" style="background:#10b981;color:#fff;">7.8</span></a>
    <a href="#api">ğŸŒ src/api/<span class="nb" style="background:#10b981;color:#fff;">8.4</span></a>
    <a href="#app">ğŸš€ app.py<span class="nb" style="background:#10b981;color:#fff;">9.0</span></a>
    <a class="st">SYNTHÃˆSE</a>
    <a href="#adoption">ğŸ” Adoption concepts</a>
    <a href="#events">ğŸ“¡ Bus d'Ã©vÃ©nements</a>
    <a href="#issues">ğŸ› ProblÃ¨mes rÃ©siduels</a>
    <a href="#innovations">ğŸ’¡ Innovations Streamlit</a>
    <a href="#roadmap">ğŸ—ºï¸ Roadmap v3</a>
  </nav>
</aside>

<!-- ==================== MAIN ==================== -->
<div class="main">

<!-- ========== EXECUTIVE ========== -->
<section id="exec">
<h1>ğŸ  Rapport d'audit complet â€” v3</h1>
<p style="color:var(--text-muted);margin-bottom:1.5rem;">Assistant Matanne &bull; AnalysÃ© le 24 fÃ©vrier 2026 &bull; Comparaison v2â†’v3<br><em>~570 fichiers Python &bull; ~96 000 lignes de code &bull; 8 072 tests collectÃ©s</em></p>

<div class="sg2">
  <div class="sc2"><div class="sv" style="color:var(--accent);">570+</div><div class="sl">Fichiers Python</div></div>
  <div class="sc2"><div class="sv" style="color:var(--accent);">96K</div><div class="sl">Lignes de code</div></div>
  <div class="sc2"><div class="sv" style="color:var(--accent);">55</div><div class="sl">@service_factory<span class="d du">+9</span></div></div>
  <div class="sc2"><div class="sv" style="color:var(--accent);">111</div><div class="sl">error_boundary blocs<span class="d du">+94</span></div></div>
  <div class="sc2"><div class="sv" style="color:var(--accent);">35</div><div class="sl">Endpoints API<span class="d du">+9</span></div></div>
  <div class="sc2"><div class="sv" style="color:var(--accent);">8 072</div><div class="sl">Tests collectÃ©s</div></div>
</div>

<h3>Scores de maturitÃ© â€” v1 â†’ v2 â†’ v3</h3>
<div class="rc">
  <div class="ri"><div class="rl"><strong>ğŸ§± core/</strong> <span class="sc sg">8.5<span class="d du">+0.2</span></span></div><div class="pb"><div class="pf pfg" style="width:85%"></div></div></div>
  <div class="ri"><div class="rl"><strong>âš™ï¸ services/</strong> <span class="sc sg">8.2<span class="d du">+0.2</span></span></div><div class="pb"><div class="pf pfg" style="width:82%"></div></div></div>
  <div class="ri"><div class="rl"><strong>ğŸ“¦ modules/</strong> <span class="sc sg">8.5<span class="d du">+0.5</span></span></div><div class="pb"><div class="pf pfg" style="width:85%"></div></div></div>
  <div class="ri"><div class="rl"><strong>ğŸ¨ ui/</strong> <span class="sc sg">7.8<span class="d du">+0.8</span></span></div><div class="pb"><div class="pf pfy" style="width:78%"></div></div></div>
  <div class="ri"><div class="rl"><strong>ğŸŒ api/</strong> <span class="sc sg">8.4<span class="d du">+0.2</span></span></div><div class="pb"><div class="pf pfg" style="width:84%"></div></div></div>
  <div class="ri"><div class="rl"><strong>ğŸš€ app.py</strong> <span class="sc sg">9.0<span class="d du">+0.5</span></span></div><div class="pb"><div class="pf pfg" style="width:90%"></div></div></div>
</div>

<div class="card" style="border-left:4px solid var(--green);">
  <h3>Verdict v3</h3>
  <p>Le projet a connu une <strong>progression spectaculaire</strong> entre v2 et v3. <strong>8 patterns dead code</strong> supprimÃ©s (~6 000 LOC), <strong>18 N+1 queries</strong> corrigÃ©s, <strong>111 blocs error_boundary</strong> dÃ©ployÃ©s (vs 17 en v2), dark mode toggle ajoutÃ©, 27 tests visuels crÃ©Ã©s, navigation migrÃ©e vers <code>st.navigation()</code> natif. Score global : <strong>v2 8.3 â†’ v3 8.5/10</strong>. Axes restants : adoption <code>Sem</code> tokens en UI, subscribers cache manquants et dead code rÃ©siduel (specifications, middleware).</p>
</div>
</section>

<!-- ========== COMPLETENESS ========== -->
<section id="completeness">
<h2>âœ… ComplÃ©tude du projet â€” Analyse multi-dimensions</h2>

<table>
<tr><th>Dimension</th><th>Score</th><th>DÃ©tail</th></tr>
<tr><td>ğŸ—ï¸ Architecture</td><td class="ac"><span class="sc sg">9.5/10</span></td><td>Layered (coreâ†’servicesâ†’modulesâ†’UI), DI via @service_factory, event bus, cache multi-niveaux, resilience composable. Navigation native st.navigation(). Exemplaire.</td></tr>
<tr><td>ğŸ“ QualitÃ© du code</td><td class="ac"><span class="sc sg">8.5/10</span></td><td>PEP 562, type annotations Mapped[], StrEnum, Pydantic v2, docstrings FR. Ruff 0 issues. Code cohÃ©rent et idiomatique.</td></tr>
<tr><td>ğŸ§ª Tests</td><td class="ac"><span class="sc sy">7/10</span></td><td>8 072 tests, 7 736 passÃ©s, 13 Ã©checs pre-existing, 322 skipped (modules maison non implÃ©mentÃ©s). 27 tests visuels snapshot. Coverage partielle.</td></tr>
<tr><td>ğŸ”’ SÃ©curitÃ©</td><td class="ac"><span class="sc sg">8.5/10</span></td><td>JWT dual-mode, rate limiting multi-fenÃªtre + Redis, security headers OWASP complets, anti-brute-force, CORS strict, XSS sanitizer. Pas de fuite d'info dans les erreurs.</td></tr>
<tr><td>âš¡ Performance</td><td class="ac"><span class="sc sg">8.5/10</span></td><td>Cache L1/L2/L3 (65 @avec_cache), QueuePool, lazy loading, CSS single-injection, joinedload N+1 fixÃ©s, fragments Streamlit.</td></tr>
<tr><td>ğŸ“¡ ObservabilitÃ©</td><td class="ac"><span class="sc sg">8/10</span></td><td>RerunProfiler (28/32 modules), Health probes K8s-style, metrics collector, correlation IDs, spans framework (pas utilisÃ©).</td></tr>
<tr><td>ğŸ¨ UX / Design System</td><td class="ac"><span class="sc sy">7.5/10</span></td><td>Tokens (Couleur, Sem), CSS engine MD5, 36 composants, dark mode toggle. Mais Sem sous-adoptÃ© (3/61), tablet hardcoded.</td></tr>
<tr><td>ğŸ“– Documentation</td><td class="ac"><span class="sc sy">7/10</span></td><td>docs/ avec 14 fichiers MD, copilot-instructions, docstrings FR. README API incomplet. ROADMAP Ã  jour.</td></tr>
<tr><td>â™¿ AccessibilitÃ©</td><td class="ac"><span class="sc sy">6/10</span></td><td>a11y.py avec WCAG contrast, ARIA attrs sur atoms, skip-link CSS mais aucun Ã©lÃ©ment rendu. Views sans landmarks.</td></tr>
<tr><td>ğŸ”„ Adoption patterns</td><td class="ac"><span class="sc sg">8.5/10</span></td><td>@service_factory 55/56, obtenir_client_ia() 17/17, error_boundary 24/32, profiler_rerun 28/32. Event bus 27 Ã©vÃ©nements.</td></tr>
<tr><td>ğŸ­ Production-readiness</td><td class="ac"><span class="sc sy">7.5/10</span></td><td>Error recovery, config cascade, health checks, Redis rate limiting. Manque : Sentry, structured logs, deployment CI/CD.</td></tr>
<tr><td>ğŸ“± Mobile / PWA</td><td class="ac"><span class="sc sy">6.5/10</span></td><td>PWA manifest, 8 icons, meta tags. Service Worker partiel. Mode tablette cuisine fonctionnel.</td></tr>
</table>

<div class="card" style="border-left:4px solid var(--accent);">
  <h4>Score de complÃ©tude global : <span class="sc sg">7.9/10</span></h4>
  <p>Projet trÃ¨s mature avec une architecture de qualitÃ© production. Les axes prioritaires restants sont : couverture de tests (+322 skipped), accessibilitÃ© (skip-link, landmarks), et derniÃ¨res adoptions du design system sÃ©mantique.</p>
</div>
</section>

<!-- ========== CHANGELOG v2â†’v3 ========== -->
<section id="changelog">
<h2>ğŸ”„ Changelog v2 â†’ v3 â€” AmÃ©liorations dÃ©taillÃ©es</h2>

<h3>Phase 3 Audit â€” Robustesse modules (23 fÃ©v. 2026)</h3>
<table>
<tr><th>Action</th><th>Impact</th><th>DÃ©tail</th></tr>
<tr><td><span class="tf tag">111 error_boundary blocs</span></td><td>+94 blocs</td><td>DÃ©ployÃ© sur 24/32 modules. Protection exhaustive de tous les onglets.</td></tr>
<tr><td><span class="tf tag">28/32 @profiler_rerun</span></td><td>+24 modules</td><td>Quasiment universel, manque 4 modules mineurs.</td></tr>
<tr><td><span class="tf tag">5 fonctionnalitÃ©s WIP complÃ©tÃ©es</span></td><td>Inter-modules</td><td>batchâ†’planificateur, batchâ†’courses, batchâ†’PDF, planificateurâ†’stock, planificateurâ†’courses.</td></tr>
<tr><td><span class="tf tag">_naviguer_famille()</span></td><td>Navigation</td><td>Helper centralisÃ© remplaÃ§ant 9 occurrences de session_state+rerun manuelles.</td></tr>
<tr><td><span class="tf tag">3 KeyNamespace dÃ©ployÃ©s</span></td><td>Ã‰tat</td><td>charges, recettes, hub_famille â€” 15 fichiers au total utilisent KeyNamespace.</td></tr>
<tr><td><span class="tf tag">Lazy loading fixÃ©</span></td><td>Perf</td><td>parametres + recettes : imports lourds dÃ©placÃ©s dans app().</td></tr>
<tr><td><span class="tf tag">Jardin plan 2D data-driven</span></td><td>Feature</td><td>Plan HTML statique remplacÃ© par grille Streamlit avec plantes rÃ©elles de l'utilisateur.</td></tr>
<tr><td><span class="tf tag">Scan factures â†’ charges</span></td><td>Feature</td><td>OCR Mistral Vision â†’ crÃ©ation automatique de facture dans le module charges.</td></tr>
<tr><td><span class="tf tag">Config foyer persistent DB</span></td><td>Feature</td><td>Lecture/Ã©criture UserPreference avec fallback session_state si DB indisponible.</td></tr>
</table>

<h3>Rationalisation patterns â€” Dead code supprimÃ© (~6 000+ LOC)</h3>
<table>
<tr><th>Pattern supprimÃ©</th><th>LOC</th><th>Raison</th></tr>
<tr><td>Result Monad (core/result/)</td><td>~800</td><td>Zero callers production</td></tr>
<tr><td>Repository (core/repository.py)</td><td>~200</td><td>SQLAlchemy ORM suffit, @avec_session_db remplace</td></tr>
<tr><td>Unit of Work (core/unit_of_work.py)</td><td>~300</td><td>@avec_session_db suffit, pattern incompatible Streamlit</td></tr>
<tr><td>IoC Container (core/container.py)</td><td>~500</td><td>@service_factory + registre suffisent</td></tr>
<tr><td>CQRS (services/core/cqrs/)</td><td>~600</td><td>Inutile pour une app single-user</td></tr>
<tr><td>ReactiveServiceMixin</td><td>~272</td><td>Zero callers, pattern non adoptÃ©</td></tr>
<tr><td>UI v2.0 legacy (dialogs, forms/)</td><td>~500</td><td>Streamlit natif (@st.dialog) suffit</td></tr>
<tr><td>Specification (core/specifications.py)</td><td>~400</td><td>SupprimÃ© du core (version services/ existe encore)</td></tr>
<tr><td>Middleware pipeline (core/middleware/)</td><td>~400</td><td>SupprimÃ© du core (version services/ existe encore)</td></tr>
<tr><td><strong>Total</strong></td><td><strong>~6 000+</strong></td><td>Base de code allÃ©gÃ©e et focalisÃ©e</td></tr>
</table>

<h3>Phase 5 Audit â€” Infrastructure avancÃ©e (24 fÃ©v. 2026)</h3>
<table>
<tr><th>Action</th><th>Statut</th></tr>
<tr><td>Dark Mode toggle dans parametres/affichage.py</td><td><span class="tf tag">âœ… FAIT</span></td></tr>
<tr><td>Design System module enregistrÃ© dans navigation + router</td><td><span class="tf tag">âœ… FAIT</span></td></tr>
<tr><td>27 tests visuels (badge, boite_info, boule_loto + thÃ¨me)</td><td><span class="tf tag">âœ… FAIT</span></td></tr>
<tr><td>8 icÃ´nes PWA gÃ©nÃ©rÃ©es (72â†’512px)</td><td><span class="tf tag">âœ… FAIT</span></td></tr>
<tr><td>ReactiveServiceMixin stale docstring supprimÃ©</td><td><span class="tf tag">âœ… FAIT</span></td></tr>
</table>

<h3>Comparaison v2 â†’ v3</h3>
<table>
<tr><th>MÃ©trique</th><th>v2</th><th>v3</th><th>Delta</th></tr>
<tr><td>@service_factory</td><td>46</td><td><strong>55</strong></td><td><span class="d du">+9</span></td></tr>
<tr><td>@avec_cache</td><td>50</td><td><strong>65</strong></td><td><span class="d du">+15</span></td></tr>
<tr><td>@avec_resilience (cible/actif)</td><td>11/11</td><td><strong>12/9</strong> (3 nouveaux HTTP non couverts identifiÃ©s)</td><td><span class="d dd">-2 identifiÃ© +3 cibles</span></td></tr>
<tr><td>error_boundary (blocs <code>with</code>)</td><td>17</td><td><strong>111</strong></td><td><span class="d du">+94</span></td></tr>
<tr><td>@profiler_rerun</td><td>4</td><td><strong>28/32</strong></td><td><span class="d du">+24</span></td></tr>
<tr><td>Ã‰vÃ©nements bus</td><td>15</td><td><strong>27</strong> (10 services)</td><td><span class="d du">+12</span></td></tr>
<tr><td>N+1 queries corrigÃ©s</td><td>0</td><td><strong>18</strong> (~50 joinedload)</td><td><span class="d du">+18</span></td></tr>
<tr><td>Dead code supprimÃ©</td><td>0</td><td><strong>~6 000 LOC</strong></td><td><span class="d du">-6K LOC</span></td></tr>
<tr><td>push.py KeyError</td><td>Bug actif</td><td><span class="tf tag">âœ… CORRIGÃ‰</span></td><td>â€”</td></tr>
<tr><td>str(e) dans HTTPException</td><td>Bug actif</td><td><span class="tf tag">âœ… CORRIGÃ‰</span></td><td>â€”</td></tr>
<tr><td>JWT secret validation</td><td>RuntimeError en dev</td><td><span class="tf tag">âœ… CORRIGÃ‰</span></td><td>â€”</td></tr>
<tr><td>Navigation</td><td>RouteurOptimise custom</td><td><span class="tf tag">st.navigation() natif</span></td><td>Migration</td></tr>
<tr><td>API endpoints</td><td>26</td><td><strong>35</strong></td><td><span class="d du">+9</span></td></tr>
<tr><td>Tests</td><td>~2 300</td><td><strong>8 072</strong> (7 736 passÃ©s)</td><td><span class="d du">+5 772</span></td></tr>
<tr><td>Tests visuels</td><td>0</td><td><strong>27</strong></td><td><span class="d du">+27</span></td></tr>
<tr><td>Faux positif v2 : styles.py duplication</td><td>SignalÃ©</td><td><span class="tf tag">âœ… Non dupliquÃ©</span> (bridge CSS)</td><td>CorrigÃ©</td></tr>
</table>
</section>

<!-- ========== src/core/ ========== -->
<section id="core">
<h2>ğŸ§± src/core/ â€” Noyau applicatif</h2>
<div class="sg2">
  <div class="sc2"><div class="sv" style="color:var(--green);">86</div><div class="sl">Fichiers</div></div>
  <div class="sc2"><div class="sv" style="color:var(--green);">13 288</div><div class="sl">Lignes</div></div>
  <div class="sc2"><div class="sv" style="color:var(--green);">12</div><div class="sl">Sous-packages</div></div>
  <div class="sc2"><div class="sv" style="color:var(--green);">8.5</div><div class="sl">Score<span class="d du">+0.2</span></div></div>
</div>

<div id="core-ai">
<details open>
<summary>ğŸ¤– ai/ â€” Client IA, Parser, Cache, Rate Limiting, Circuit Breaker <span class="b bg">9/10</span></summary>
<div>
<p><strong>~1 583 LOC, 6 fichiers.</strong> <code>ClientIA</code> singleton via <code>obtenir_client_ia()</code>, <code>AnalyseurIA</code> avec 5 stratÃ©gies cascading JSON, <code>CacheIA</code> sÃ©mantique SHA-256, <code>RateLimitIA</code> quotas journalier/horaire, <code>CircuitBreaker</code> 3 Ã©tats (FERME/OUVERT/SEMI_OUVERT).</p>
<p><span class="tf tag">v3</span> Stale docstring ReactiveServiceMixin supprimÃ©. 17/17 services utilisent <code>obtenir_client_ia()</code> â€” 0 instanciation directe.</p>
<p><span class="tm tag">Bug rÃ©siduel</span> <code>async_wrapper</code> : coroutine non awaitÃ©e dans <code>appeler()</code>.</p>
</div>
</details>
</div>

<div id="core-caching">
<details>
<summary>ğŸ’¾ caching/ â€” Cache multi-niveaux L1/L2/L3 <span class="b bg">8.5/10</span><span class="d du"> +1.5</span></summary>
<div>
<p><strong>~938 LOC, 6 fichiers.</strong> L1 mÃ©moire (LRU), L2 session Streamlit, L3 fichier JSON atomique. <code>obtenir_cache()</code> singleton. <strong>65 usages @avec_cache</strong> dans les services.</p>
<p><span class="tf tag">v3</span> Cache fonctionnel en production (bug singleton corrigÃ© en v2, adoption massive en v3).</p>
</div>
</details>
</div>

<div id="core-config">
<details>
<summary>âš™ï¸ config/ â€” Pydantic BaseSettings cascade <span class="b bg">8/10</span></summary>
<div><p><strong>~901 LOC, 4 fichiers.</strong> Cascade st.secrets â†’ .env.local â†’ .env â†’ defaults. ValidateurConfiguration fluent builder. Pas de changement majeur v2â†’v3.</p></div>
</details>
</div>

<div id="core-db">
<details>
<summary>ğŸ—„ï¸ db/ â€” Engine, Sessions, Migrations <span class="b bg">8.5/10</span></summary>
<div><p><strong>~860 LOC, 5 fichiers.</strong> QueuePool avec pool_pre_ping, context manager <code>obtenir_contexte_db()</code>, migrations SQL-file SHA-256. Solide et stable.</p></div>
</details>
</div>

<div id="core-decorators">
<details>
<summary>ğŸ¯ decorators/ â€” DÃ©corateurs unifiÃ©s <span class="b bg">8.5/10</span></summary>
<div><p><strong>~611 LOC, 5 fichiers.</strong> <code>@avec_cache</code>, <code>@avec_session_db</code>, <code>@avec_gestion_erreurs</code>, <code>@avec_validation</code>, <code>@avec_resilience</code>. BLAKE2b keys, sentinel pattern, functools.wraps. Tous opÃ©rationnels et massivement adoptÃ©s.</p></div>
</details>
</div>

<div id="core-models">
<details>
<summary>ğŸ“Š models/ â€” ModÃ¨les SQLAlchemy 2.0 (20 fichiers) <span class="b bg">9/10</span></summary>
<div><p><strong>~5 200+ LOC, 100+ modÃ¨les, ~35 StrEnum.</strong> Mapped[T] + mapped_column() systÃ©matique. PEP 562 lazy loading pour ~100 symboles. Convention de nommage contraintes. Module de rÃ©fÃ©rence qualitÃ©.</p></div>
</details>
</div>

<div id="core-state">
<details>
<summary>ğŸ”€ state/ â€” Gestion d'Ã©tat <span class="b bg">8/10</span></summary>
<div><p><strong>~747 LOC, 4 fichiers.</strong> State slices par domaine (EtatNavigation, EtatCuisine, EtatUI), Protocol SessionStorage (dÃ©couplage Streamlit), navigation breadcrumbs, GestionnaireEtat singleton.</p></div>
</details>
</div>

<div id="core-validation">
<details>
<summary>âœ… validation/ â€” Schemas + Sanitizer <span class="b by">7/10</span></summary>
<div><p><strong>~1 042 LOC, 11 fichiers.</strong> Sous-package schemas/ Pydantic (recettes, inventaire, courses, planning, famille, projets), sanitizer anti-XSS/injection SQL. Double approche dict/Pydantic encore en place sur certains endpoints.</p></div>
</details>
</div>

<div id="core-monitoring">
<details>
<summary>ğŸ“¡ monitoring/ â€” MÃ©triques et santÃ© <span class="b bg">8.5/10</span></summary>
<div><p><strong>~1 090 LOC, 5 fichiers.</strong> Health probes K8s-style (DB, cache, IA, disk), RerunProfiler spÃ©cifique Streamlit (28/32 modules), MetricCollector compteurs atomiques. _verifier_cache() utilise obtenir_cache() singleton.</p></div>
</details>
</div>

<div id="core-resilience">
<details>
<summary>ğŸ›¡ï¸ resilience/ â€” Politiques composables <span class="b bg">9/10</span></summary>
<div><p><strong>~367 LOC, 2 fichiers.</strong> RetryPolicy, TimeoutPolicy, CircuitBreakerPolicy. Composition via <code>+</code> operator. <code>executer()</code> retourne T directement. Factories : <code>politique_ia()</code>, <code>politique_api_externe()</code>. Production-ready.</p></div>
</details>
</div>

<div id="core-observability">
<details>
<summary>ğŸ”­ observability/ â€” Contexte d'exÃ©cution <span class="b bg">9/10</span></summary>
<div><p><strong>~281 LOC, 2 fichiers.</strong> <code>contextvars.ContextVar</code>, tracing hiÃ©rarchique, FiltreCorrelation. Module le plus propre du projet. ZÃ©ro problÃ¨me.</p></div>
</details>
</div>

<div id="core-dateutils">
<details>
<summary>ğŸ“… date_utils/ â€” Utilitaires de dates <span class="b bg">10/10</span></summary>
<div><p><strong>~440 LOC, 5 fichiers.</strong> Fonctions pures (semaines, periodes, formatage, helpers), zÃ©ro import Streamlit, docstrings exemplaires. Module de rÃ©fÃ©rence qualitÃ© absolue.</p></div>
</details>
</div>

<div id="core-root">
<details>
<summary>ğŸ“ Fichiers racine (11 fichiers) <span class="b bg">8.5/10</span></summary>
<div>
<p><strong>~2 371 LOC.</strong></p>
<ul>
<li><code>lazy_loader.py</code> : PEP 562, RouteurOptimise, MODULE_REGISTRY (34+ modules)</li>
<li><code>logging.py</code> : FiltreSecrets regex masking, configurer_logging()</li>
<li><code>storage.py</code> : SessionStorage Protocol (dÃ©couplage Streamlit)</li>
<li><code>session_keys.py</code> : KeyNamespace thread-safe, typage statique</li>
<li><code>bootstrap.py</code> : Pipeline d'initialisation app</li>
<li><code>errors.py</code> + <code>errors_base.py</code> : HiÃ©rarchie d'exceptions mÃ©tier</li>
<li><code>constants.py</code> : Limites, defaults, constantes app</li>
<li><code>async_utils.py</code> : Helpers event loop</li>
</ul>
<p><span class="tf tag">v3</span> <strong>Dead code supprimÃ©</strong> : result/, repository.py, specifications.py, unit_of_work.py, container.py, middleware/ â€” ~4 000+ LOC Ã©liminÃ©s du core.</p>
</div>
</details>
</div>
</section>

<!-- ========== src/services/ ========== -->
<section id="services">
<h2>âš™ï¸ src/services/ â€” Couche de services</h2>
<div class="sg2">
  <div class="sc2"><div class="sv" style="color:var(--green);">202</div><div class="sl">Fichiers</div></div>
  <div class="sc2"><div class="sv" style="color:var(--green);">40 968</div><div class="sl">Lignes</div></div>
  <div class="sc2"><div class="sv" style="color:var(--green);">55</div><div class="sl">@service_factory</div></div>
  <div class="sc2"><div class="sv" style="color:var(--green);">8.2</div><div class="sl">Score<span class="d du">+0.2</span></div></div>
</div>

<div id="svc-core">
<details open>
<summary>ğŸ—ï¸ core/ â€” Infrastructure (55 fichiers, 9 862 LOC) <span class="b bg">8.5/10</span></summary>
<div>
<p><code>BaseService[T]</code> CRUD gÃ©nÃ©rique, <code>BaseAIService</code> avec rate limiting/cache/circuit breaker intÃ©grÃ©s, <code>BusEvenements</code> pub/sub wildcards, <code>ServiceRegistry</code> + <code>@service_factory</code>, backup (8 fichiers, 1 187 LOC), notifications (9 fichiers, 1 838 LOC), auth utilisateur (10 fichiers, 1 664 LOC).</p>
<p><span class="tf tag">v3</span> CQRS supprimÃ©, ReactiveServiceMixin supprimÃ©.</p>
<h4>âš ï¸ Dead code rÃ©siduel dans services/core/</h4>
<p>Le ROADMAP Phase 3 indiquait suppression de Specification et Middleware du <strong>core/</strong>. Les versions <strong>core/</strong> ont bien Ã©tÃ© supprimÃ©es, mais les copies <strong>services/core/</strong> persistent :</p>
<ul>
<li><span class="th tag">P1</span> <code>specifications/</code> (4 fichiers, 795 LOC) â€” <strong>0 consommateur externe</strong>. Pattern composable intÃ©ressant mais jamais adoptÃ©.</li>
<li><span class="th tag">P1</span> <code>middleware/</code> (2 fichiers, 584 LOC) â€” <strong>1 consommateur unique</strong> (<code>cuisine/recettes/service.py</code> importe <code>service_method</code>).</li>
<li><span class="tm tag">P2</span> <code>observability/spans.py</code> (278 LOC) â€” framework tracing dÃ©fini mais 0 appeler() dans les services.</li>
</ul>
</div>
</details>
</div>

<div id="svc-cuisine">
<details>
<summary>ğŸ½ï¸ cuisine/ â€” 51 fichiers, 9 579 LOC <span class="b bg">A</span></summary>
<div>
<p><strong>5 domaines</strong> : recettes (10 fichiers), planning (8), courses (7), batch_cooking (14), suggestions (3). <strong>11 @service_factory. Module le plus complet â€” gold standard.</strong></p>
<table>
<tr><th>DÃ©corateur</th><th>Count</th></tr>
<tr><td>@avec_cache</td><td class="ac">15</td></tr>
<tr><td>@avec_session_db</td><td class="ac">~70</td></tr>
<tr><td>@avec_gestion_erreurs</td><td class="ac">~40</td></tr>
</table>
<p><strong>Event bus</strong> : 5 Ã©vÃ©nements Ã©mis (recette.creee, recette.importee, planning.cree, batch_cooking.session_creee, courses.ingredients_ajoutes).</p>
</div>
</details>
</div>

<div id="svc-famille">
<details>
<summary>ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦ famille/ â€” 22 fichiers, 4 806 LOC <span class="b bg">A-</span></summary>
<div>
<p><strong>12 @service_factory.</strong> Meilleure adoption event bus : <strong>15 Ã©vÃ©nements</strong> Ã©mis par 5 services. JulesAI + WeekendAI via BaseAIService.</p>
<table>
<tr><th>DÃ©corateur</th><th>Count</th></tr>
<tr><td>@avec_cache</td><td class="ac">35</td></tr>
<tr><td>@avec_session_db</td><td class="ac">~60</td></tr>
<tr><td>@avec_gestion_erreurs</td><td class="ac">~55</td></tr>
</table>
<p><span class="th tag">P1</span> @avec_resilience manquant sur <code>calendrier/service.py</code> et <code>google_calendar.py</code> (appels httpx).</p>
</div>
</details>
</div>

<div id="svc-integrations">
<details>
<summary>ğŸ”Œ integrations/ â€” 30 fichiers, 5 860 LOC <span class="b by">B-</span></summary>
<div>
<p>6 @service_factory. Garmin OAuth, OpenFoodFacts, mÃ©tÃ©o, OCR factures, PWA, images.</p>
<p><strong>Points faibles :</strong></p>
<ul>
<li><span class="th tag">P1</span> <code>images/generator.py</code> â€” 6 appels HTTP sans @avec_resilience, pas de @service_factory</li>
<li><span class="tm tag">P2</span> <code>web/pwa_templates.py</code> (470 LOC) â€” probablement legacy, 0 consommateur visible</li>
<li><span class="tm tag">P2</span> Seulement 3 @avec_cache, 2 @avec_gestion_erreurs sur 30 fichiers</li>
</ul>
</div>
</details>
</div>

<div id="svc-inventaire">
<details>
<summary>ğŸ“¦ inventaire/ â€” 7 fichiers, 1 135 LOC <span class="b bg">B+</span></summary>
<div><p>Architecture exemplaire : mixins (operations, IO, stats, stock), BaseService[ArticleInventaire] + BaseAIService. 3 Ã©vÃ©nements stock.modifie Ã©mis. Design pattern Ã  suivre pour les petits services.</p></div>
</details>
</div>

<div id="svc-jeux">
<details>
<summary>ğŸ® jeux/ â€” 15 fichiers, 5 130 LOC <span class="b bg">B+</span></summary>
<div>
<p>11 @service_factory. JeuxAIService avec prompt Ã©thique (jeu responsable). @avec_resilience sur football_data et loto_data.</p>
<p><span class="tm tag">P2</span> 0 Ã©vÃ©nements bus Ã©mis. 4 services sans @avec_gestion_erreurs (series, scheduler, backtest, sync).</p>
</div>
</details>
</div>

<div id="svc-maison">
<details>
<summary>ğŸ¡ maison/ â€” 13 fichiers, 2 843 LOC <span class="b bo">C+</span></summary>
<div>
<p>5 @service_factory. 3 BaseAIService (entretien, jardin, projets). Gamification unique (badges, streaks, scores).</p>
<ul>
<li><span class="th tag">P1 CRITIQUE</span> <strong>0 @avec_cache</strong> â€” toutes les requÃªtes DB sont rÃ©pÃ©tÃ©es Ã  chaque rerun Streamlit. Impact performance majeur.</li>
<li><span class="tm tag">P2</span> 0 @avec_gestion_erreurs sur les 3 services IA (try/except manuels sans logging structurÃ©).</li>
<li><span class="tm tag">P2</span> 2 Ã©vÃ©nements entretien.* Ã©mis, mais 0 subscriber d'invalidation cache correspondant.</li>
</ul>
</div>
</details>
</div>

<div id="svc-rapports">
<details>
<summary>ğŸ“„ rapports/ â€” 7 fichiers, 1 681 LOC <span class="b bo">C</span></summary>
<div><p>2 @service_factory. PDF multi-domaines (budget, gaspillage, planning). <strong>0 @avec_cache, 3 @avec_gestion_erreurs.</strong> Pas de BaseService hÃ©ritage, pas d'events. Module le plus en retard niveau adoption.</p></div>
</details>
</div>

<h3>Scores par package â€” Services</h3>
<table>
<tr><th>Package</th><th>Fichiers</th><th>LOC</th><th>@service_factory</th><th>@avec_cache</th><th>@avec_gestion_erreurs</th><th>Event Bus</th><th>Score</th></tr>
<tr><td>cuisine/</td><td class="ac">51</td><td class="ar">9 579</td><td class="ac">âœ… 11</td><td class="ac">âœ… 15</td><td class="ac">âœ… 40+</td><td class="ac">âœ… 5</td><td class="ac"><strong>A</strong></td></tr>
<tr><td>famille/</td><td class="ac">22</td><td class="ar">4 806</td><td class="ac">âœ… 12</td><td class="ac">âœ… 35</td><td class="ac">âœ… 55+</td><td class="ac">âœ… 15</td><td class="ac"><strong>A-</strong></td></tr>
<tr><td>inventaire/</td><td class="ac">7</td><td class="ar">1 135</td><td class="ac">âœ… 1</td><td class="ac">âš ï¸ 2</td><td class="ac">âœ… 16+</td><td class="ac">âœ… 3</td><td class="ac"><strong>B+</strong></td></tr>
<tr><td>jeux/</td><td class="ac">15</td><td class="ar">5 130</td><td class="ac">âœ… 11</td><td class="ac">âœ… 10</td><td class="ac">âš ï¸ 11</td><td class="ac">âŒ 0</td><td class="ac"><strong>B+</strong></td></tr>
<tr><td>integrations/</td><td class="ac">30</td><td class="ar">5 860</td><td class="ac">âœ… 6</td><td class="ac">âš ï¸ 3</td><td class="ac">âŒ 2</td><td class="ac">âŒ 0</td><td class="ac"><strong>B-</strong></td></tr>
<tr><td>maison/</td><td class="ac">13</td><td class="ar">2 843</td><td class="ac">âœ… 5</td><td class="ac">âŒ 0</td><td class="ac">âŒ 5</td><td class="ac">âš ï¸ 2</td><td class="ac"><strong>C+</strong></td></tr>
<tr><td>rapports/</td><td class="ac">7</td><td class="ar">1 681</td><td class="ac">âœ… 2</td><td class="ac">âŒ 0</td><td class="ac">âš ï¸ 3</td><td class="ac">âŒ 0</td><td class="ac"><strong>C</strong></td></tr>
</table>
</section>

<!-- ========== src/modules/ ========== -->
<section id="modules">
<h2>ğŸ“¦ src/modules/ â€” Modules mÃ©tier (UI)</h2>
<div class="sg2">
  <div class="sc2"><div class="sv" style="color:var(--green);">187</div><div class="sl">Fichiers</div></div>
  <div class="sc2"><div class="sv" style="color:var(--green);">28 126</div><div class="sl">Lignes</div></div>
  <div class="sc2"><div class="sv" style="color:var(--green);">32</div><div class="sl">Modules app()</div></div>
  <div class="sc2"><div class="sv" style="color:var(--green);">8.5</div><div class="sl">Score<span class="d du">+0.5</span></div></div>
</div>

<div id="mod-cuisine">
<details open>
<summary>ğŸ½ï¸ cuisine/ â€” 51 fichiers, 8 050 LOC <span class="b bg">9/10</span></summary>
<div>
<p>5 sous-packages (batch_cooking_detaille, courses, inventaire, planificateur_repas, recettes). <strong>Module phare du projet â€” rÃ©fÃ©rence Ã  reproduire.</strong></p>
<ul>
<li>âœ… @profiler_rerun : 6/6 app()</li>
<li>âœ… error_boundary : 6/6 modules, dont inventaire 13 blocs, courses 6, recettes 4</li>
<li>âœ… KeyNamespace : recettes, recettes_liste, inventaire â€” 3 namespaces</li>
<li>âœ… 5 WIP features complÃ©tÃ©es (batchâ†”planificateur, stock, PDF, courses)</li>
<li>âœ… Lazy imports, service delegation, SK constants complets</li>
</ul>
</div>
</details>
</div>

<div id="mod-famille">
<details>
<summary>ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦ famille/ â€” 26 fichiers, 3 747 LOC <span class="b bg">9/10</span></summary>
<div>
<ul>
<li>âœ… @profiler_rerun : 7/7 app() (8 sous-modules)</li>
<li>âœ… error_boundary : 7/7 modules â€” hub (6), suivi_perso (5), weekend (5), achats (6), etc.</li>
<li>âœ… _naviguer_famille() helper centralisÃ© (10 appels, remplace session_state+rerun)</li>
<li>âœ… KeyNamespace("famille")</li>
<li>âš ï¸ activites.py et routines.py importent error_boundary mais ne l'utilisent pas avec <code>with</code></li>
</ul>
</div>
</details>
</div>

<div id="mod-maison">
<details>
<summary>ğŸ¡ maison/ â€” 34 fichiers, 3 506 LOC <span class="b bg">8/10</span></summary>
<div>
<ul>
<li>âœ… @profiler_rerun : 5/5</li>
<li>âœ… error_boundary : charges (5), depenses (3), entretien (7), hub (1), jardin (7) â€” <strong>23 blocs</strong></li>
<li>âœ… KeyNamespace : charges, depenses â€” 6 fichiers</li>
<li>âœ… Hub navigation centralisÃ©e, jardin plan 2D data-driven</li>
<li>âœ… Gamification (entretien, jardin) â€” badges, streaks, scores</li>
</ul>
</div>
</details>
</div>

<div id="mod-jeux">
<details>
<summary>ğŸ® jeux/ â€” 28 fichiers, 3 940 LOC <span class="b by">7/10</span></summary>
<div>
<ul>
<li>âœ… @profiler_rerun : 2/2 (loto, paris)</li>
<li>âœ… error_boundary : loto (7 blocs)</li>
<li>âš ï¸ <strong>paris/__init__.py</strong> importe error_boundary mais 0 blocs <code>with</code> â€” 226 LOC non protÃ©gÃ©s</li>
<li>âŒ 0 KeyNamespace, 0 naviguer()</li>
</ul>
</div>
</details>
</div>

<div id="mod-planning">
<details>
<summary>ğŸ“… planning/ â€” 12 fichiers, 2 188 LOC <span class="b bg">8/10</span></summary>
<div>
<ul>
<li>âœ… @profiler_rerun : calendrier â€” <span class="th tag">âš ï¸</span> templates_ui et timeline_ui manquants</li>
<li>âœ… error_boundary : templates_ui (1), timeline_ui (1)</li>
<li>âš ï¸ calendrier/__init__ importe error_boundary mais 0 blocs <code>with</code></li>
<li>âœ… Architecture calendrier excellente (typesâ†’convertersâ†’aggregationâ†’analytics)</li>
</ul>
</div>
</details>
</div>

<div id="mod-parametres">
<details>
<summary>âš™ï¸ parametres/ â€” 9 fichiers, 988 LOC <span class="b bg">9/10</span></summary>
<div>
<ul>
<li>âœ… @profiler_rerun, 8 blocs error_boundary (1 par onglet)</li>
<li>âœ… Lazy loading exemplaire â€” tous imports dans app()</li>
<li>âœ… __getattr__ lazy pour imports directs (tests)</li>
<li><span class="tf tag">v3</span> Dark mode toggle via afficher_selecteur_theme()</li>
</ul>
</div>
</details>
</div>

<div id="mod-utilitaires">
<details>
<summary>ğŸ”§ utilitaires/ â€” 13 fichiers, 2 827 LOC <span class="b bg">8/10</span></summary>
<div>
<ul>
<li>âœ… @profiler_rerun : 5/6 â€” <span class="th tag">âš ï¸</span> chat_ia.py manquant</li>
<li>âœ… error_boundary : barcode (5), notifications (5), rapports (4), scan_factures (2), chat_ia (1)</li>
<li>âš ï¸ recherche_produits.py importe mais n'utilise pas error_boundary</li>
<li>âœ… Scan factures â†’ charges connectÃ© (KeyNamespace("charges"))</li>
<li>âœ… chat_ia.py : seul module avec BaseAIService + @service_factory + st.write_stream()</li>
</ul>
</div>
</details>
</div>

<div id="mod-framework">
<details>
<summary>ğŸ§© _framework/ â€” 6 fichiers, 1 044 LOC <span class="b bp">Architecture 9 â€” Adoption 55%</span></summary>
<div>
<h4>Taux d'adoption framework v3</h4>
<div class="ar2"><div class="cn">error_boundary</div><div style="flex:1"><div class="pb"><div class="pf pfg" style="width:75%"></div></div></div><div class="ra"><strong>24/32</strong><span class="d du"> +7</span></div></div>
<div class="ar2"><div class="cn">@profiler_rerun</div><div style="flex:1"><div class="pb"><div class="pf pfg" style="width:87%"></div></div></div><div class="ra"><strong>28/32</strong><span class="d du"> +24</span></div></div>
<div class="ar2"><div class="cn">@ui_fragment</div><div style="flex:1"><div class="pb"><div class="pf pfg" style="width:76%"></div></div></div><div class="ra"><strong>107 usages</strong> (49 fichiers)</div></div>
<div class="ar2"><div class="cn">ModuleState</div><div style="flex:1"><div class="pb"><div class="pf pfr" style="width:3%"></div></div></div><div class="ra"><strong>1/32</strong><span class="d ds"> â†’</span></div></div>
<div class="ar2"><div class="cn">BaseModule</div><div style="flex:1"><div class="pb"><div class="pf pfr" style="width:0%"></div></div></div><div class="ra"><strong>0/32</strong><span class="d ds"> â†’</span></div></div>
<p style="margin-top:.8rem;"><strong>Recommandation v3 :</strong> <code>BaseModule</code> et <code>ModuleState</code> restent non adoptÃ©s. Le pattern standard <code>def app()</code> + <code>@profiler_rerun</code> + <code>error_boundary</code> fonctionne trÃ¨s bien â€” officialiser ce pattern comme le standard et retirer BaseModule de la documentation.</p>
</div>
</details>
</div>

<h3>ComplÃ©tude fonctionnelle par module</h3>
<table class="ct">
<tr><th>Module</th><th>LOC</th><th>%</th><th>Score</th><th>Notes</th></tr>
<tr><td>cuisine/recettes</td><td class="ar">1 337</td><td>95%</td><td class="ac"><strong>9/10</strong></td><td>CRUD, import URL, gÃ©nÃ©ration IA, images, dÃ©tail riche</td></tr>
<tr><td>cuisine/inventaire</td><td class="ar">2 140</td><td>95%</td><td class="ac"><strong>9/10</strong></td><td>19 fichiers, alertes, photos, prÃ©dictions, notifications</td></tr>
<tr><td>parametres</td><td class="ar">988</td><td>95%</td><td class="ac"><strong>9/10</strong></td><td>8 onglets, lazy loading exemplaire, dark mode toggle</td></tr>
<tr><td>famille/hub</td><td class="ar">2 038</td><td>95%</td><td class="ac"><strong>9/10</strong></td><td>Navigation hub exemplaire, _naviguer_famille()</td></tr>
<tr><td>cuisine/courses</td><td class="ar">1 752</td><td>90%</td><td class="ac"><strong>9/10</strong></td><td>Liste active, historique, suggestions IA, batch integration</td></tr>
<tr><td>cuisine/planificateur</td><td class="ar">1 313</td><td>90%</td><td class="ac"><strong>9/10</strong></td><td>GÃ©nÃ©ration IA, PDF, intÃ©gration stock et courses</td></tr>
<tr><td>jeux/loto</td><td class="ar">1 529</td><td>90%</td><td class="ac"><strong>8/10</strong></td><td>Statistiques, simulation, stratÃ©gies, 7 error_boundary</td></tr>
<tr><td>maison/entretien</td><td class="ar">1 150</td><td>90%</td><td class="ac"><strong>8/10</strong></td><td>Gamification, 7 onglets, export, 7 error_boundary</td></tr>
<tr><td>maison/jardin</td><td class="ar">1 077</td><td>90%</td><td class="ac"><strong>8/10</strong></td><td>Plan 2D data-driven, gamification, 7 onglets</td></tr>
<tr><td>maison/charges</td><td class="ar">1 018</td><td>85%</td><td class="ac"><strong>8/10</strong></td><td>Dashboard, factures OCR, analyse, KeyNamespace</td></tr>
<tr><td>maison/depenses</td><td class="ar">794</td><td>85%</td><td class="ac"><strong>8/10</strong></td><td>CRUD, Plotly, prÃ©visions IA, KeyNamespace</td></tr>
<tr><td>planning/calendrier</td><td class="ar">1 685</td><td>85%</td><td class="ac"><strong>8/10</strong></td><td>Vue unifiÃ©e, analytics, export, typesâ†’converters pipeline</td></tr>
<tr><td>famille/achats</td><td class="ar">394</td><td>90%</td><td class="ac"><strong>8/10</strong></td><td>Dashboard, groupes, historique, 6 error_boundary</td></tr>
<tr><td>famille/weekend</td><td class="ar">390</td><td>85%</td><td class="ac"><strong>8/10</strong></td><td>Planning, suggestions IA, notation, 5 error_boundary</td></tr>
<tr><td>famille/routines</td><td class="ar">315</td><td>90%</td><td class="ac"><strong>8/10</strong></td><td>CRUD, IA, streaks (error_boundary importÃ© non utilisÃ©)</td></tr>
<tr><td>cuisine/batch_cooking</td><td class="ar">629</td><td>85%</td><td class="ac"><strong>8/10</strong></td><td>Session planning, composants, gÃ©nÃ©ration â€” 5 WIP done</td></tr>
<tr><td>famille/jules</td><td class="ar">453</td><td>85%</td><td class="ac"><strong>8/10</strong></td><td>ActivitÃ©s, shopping, conseils IA (JulesAIService)</td></tr>
<tr><td>accueil</td><td class="ar">~500</td><td>85%</td><td class="ac"><strong>8/10</strong></td><td>Dashboard mÃ©triques, alertes, raccourcis rapides</td></tr>
<tr><td>famille/suivi_perso</td><td class="ar">472</td><td>80%</td><td class="ac"><strong>7/10</strong></td><td>Dashboard, Garmin, alimentation, 5 error_boundary</td></tr>
<tr><td>jeux/paris</td><td class="ar">1 916</td><td>80%</td><td class="ac"><strong>7/10</strong></td><td>PrÃ©dictions, sÃ©ries, sync API (error_boundary importÃ© non utilisÃ©)</td></tr>
<tr><td>planning/templates</td><td class="ar">206</td><td>75%</td><td class="ac"><strong>7/10</strong></td><td>CrÃ©ation/application basique</td></tr>
<tr><td>planning/timeline</td><td class="ar">287</td><td>75%</td><td class="ac"><strong>7/10</strong></td><td>Plotly Gantt</td></tr>
<tr><td>utilitaires/chat_ia</td><td class="ar">137</td><td>75%</td><td class="ac"><strong>7/10</strong></td><td>Chat basique avec IA + st.write_stream()</td></tr>
<tr><td>design_system</td><td class="ar">181</td><td>60%</td><td class="ac"><strong>5/10</strong></td><td>Catalogue composants (manque framework complet)</td></tr>
</table>
<p><strong>Moyenne globale : ~86% de fonctionnalitÃ©s implÃ©mentÃ©es.</strong></p>
</section>

<!-- ========== src/ui/ ========== -->
<section id="ui">
<h2>ğŸ¨ src/ui/ â€” Design System et Composants</h2>
<div class="sg2">
  <div class="sc2"><div class="sv" style="color:var(--accent);">61</div><div class="sl">Fichiers</div></div>
  <div class="sc2"><div class="sv" style="color:var(--accent);">10 096</div><div class="sl">Lignes</div></div>
  <div class="sc2"><div class="sv" style="color:var(--accent);">36</div><div class="sl">Composants @composant_ui</div></div>
  <div class="sc2"><div class="sv" style="color:var(--accent);">7.8</div><div class="sl">Score<span class="d du">+0.8</span></div></div>
</div>

<details open>
<summary>Infrastructure Design System <span class="b bg">9/10</span></summary>
<div>
<table>
<tr><th>Module</th><th>LOC</th><th>Score</th><th>Adoption</th></tr>
<tr><td>tokens.py (Couleur, Espacement, Rayon, etc.)</td><td class="ar">245</td><td class="ac"><span class="b bg">9/10</span></td><td>15/61 fichiers importent</td></tr>
<tr><td>tokens_semantic.py (Sem, light/dark mapping)</td><td class="ar">214</td><td class="ac"><span class="b bg">9/10</span></td><td><span class="tc tag">3/61 fichiers seulement</span></td></tr>
<tr><td>engine/css.py (MD5 dedup, batch inject)</td><td class="ar">432</td><td class="ac"><span class="b bg">9/10</span></td><td>Via pipeline CSS global</td></tr>
<tr><td>theme.py (light/dark/auto, densitÃ©, accent)</td><td class="ar">319</td><td class="ac"><span class="b bg">8/10</span></td><td>Toggle fonctionnel v3</td></tr>
<tr><td>fragments.py (7 dÃ©corateurs fragment)</td><td class="ar">453</td><td class="ac"><span class="b bg">8.5/10</span></td><td>107 usages (49 fichiers)</td></tr>
<tr><td>a11y.py (WCAG contrast, ARIA attrs)</td><td class="ar">288</td><td class="ac"><span class="b bg">8.5/10</span></td><td>2/61 fichiers (faible)</td></tr>
<tr><td>components/ (36 composants @composant_ui)</td><td class="ar">2 309</td><td class="ac"><span class="b bg">8/10</span></td><td>XSS-safe, _html() pures</td></tr>
<tr><td>tablet/ (mode cuisine tactile)</td><td class="ar">995</td><td class="ac"><span class="b by">7/10</span></td><td>2 hardcoded gradients</td></tr>
<tr><td>views/ (11 fichiers pages complÃ¨tes)</td><td class="ar">1 338</td><td class="ac"><span class="b by">6.5/10</span></td><td>notifications bypass complet design system</td></tr>
</table>
</div>
</details>

<details>
<summary>ğŸŒ™ Dark Mode â€” statut v3 dÃ©taillÃ©</summary>
<div>
<table>
<tr><th>Composant</th><th>Statut</th><th>DÃ©tail</th></tr>
<tr><td>Tokens sÃ©mantiques (Sem) injection CSS</td><td><span class="tf tag">âœ…</span></td><td>Light/dark/auto mappings complets (26 CSS variables)</td></tr>
<tr><td>Theme CSS overrides (.stApp, sidebar)</td><td><span class="tf tag">âœ…</span></td><td>GÃ©nÃ©rÃ© dans theme.py via generer_css_theme()</td></tr>
<tr><td>Toggle UI (parametres/affichage)</td><td><span class="tf tag">âœ… NEW</span></td><td>afficher_selecteur_theme() â€” Clair/Sombre/Auto + accent picker</td></tr>
<tr><td>styles.py bridge (--sem-*, fallback)</td><td><span class="tf tag">âœ…</span></td><td>Variables :root cascadent vers --sem-* â€” <strong>pas de duplication</strong> (faux positif v2 corrigÃ©)</td></tr>
<tr><td>Auto mode (prefers-color-scheme)</td><td><span class="tf tag">âœ…</span></td><td>@media query injection conditionnelle</td></tr>
<tr><td>atoms.py (badge, carte_metrique, boite_info)</td><td><span class="tm tag">âš ï¸ PARTIEL</span></td><td>Utilisent Couleur.XXX raw â€” ne rÃ©pondent pas au dark mode</td></tr>
<tr><td>tablet/styles.py gradients</td><td><span class="tm tag">âš ï¸</span></td><td>2 hex hardcodÃ©s (#FF6B6B, #ee5a5a) sans token</td></tr>
<tr><td>fragments.py loading skeleton</td><td><span class="tm tag">âš ï¸</span></td><td>#f0f0f0 hardcodÃ© au lieu de Sem.SURFACE_ALT</td></tr>
</table>
<p><strong>Verdict :</strong> Infrastructure dark mode <strong>100% complÃ¨te</strong>. Partiellement fonctionnel au niveau composants â€” le layout global s'adapte, mais les composants atomiques utilisent des couleurs raw. <strong>Migration Couleurâ†’Sem nÃ©cessaire pour activation complÃ¨te â€” estimÃ© 3-4 fichiers Ã  modifier.</strong></p>
</div>
</details>

<details>
<summary>ğŸ§© Fragments Streamlit â€” adoption dÃ©taillÃ©e</summary>
<div>
<table>
<tr><th>DÃ©corateur</th><th>Usages</th><th>Distribution</th><th>Statut</th></tr>
<tr><td>@ui_fragment</td><td>~95</td><td>Tous les domaines</td><td><span class="tf tag">âœ… Bien adoptÃ©</span></td></tr>
<tr><td>@auto_refresh</td><td>~3</td><td>Accueil alertes principalement</td><td><span class="tm tag">âš ï¸ Sous-exploitÃ©</span></td></tr>
<tr><td>@cached_fragment</td><td>0</td><td>â€”</td><td><span class="tc tag">âŒ Non adoptÃ©</span></td></tr>
<tr><td>@lazy</td><td>0</td><td>â€”</td><td><span class="tc tag">âŒ Non adoptÃ©</span></td></tr>
<tr><td>FragmentGroup</td><td>0</td><td>â€”</td><td><span class="tc tag">âŒ Non adoptÃ©</span></td></tr>
</table>
<p>107 usages totaux sur 49 fichiers. <code>@ui_fragment</code> domine (89%). Les patterns avancÃ©s (<code>@cached_fragment</code>, <code>@lazy</code>, <code>FragmentGroup</code>) restent inexploitÃ©s â€” opportunitÃ© majeure pour les dashboards et graphiques lourds.</p>
</div>
</details>

<details>
<summary>ğŸ“Š 36 composants @composant_ui â€” catalogue</summary>
<div>
<table>
<tr><th>CatÃ©gorie</th><th>Composants</th><th>QualitÃ©</th></tr>
<tr><td>Atomes</td><td>badge, badge_statut, boite_info, bouton_action, carte_metrique, etiquette, icone</td><td><span class="b bg">8/10</span></td></tr>
<tr><td>Cartes</td><td>carte_simple, carte_recette, carte_planning, carte_activite</td><td><span class="b bg">8/10</span></td></tr>
<tr><td>Feedback</td><td>smart_spinner, show_success, show_error, show_warning, notification_toast</td><td><span class="b bg">9/10</span></td></tr>
<tr><td>Listes</td><td>liste_triable, element_liste, tableau_donnees</td><td><span class="b bg">8/10</span></td></tr>
<tr><td>Navigation</td><td>breadcrumb, tabs_horizontal, menu_lateral</td><td><span class="b bg">8/10</span></td></tr>
<tr><td>Graphiques</td><td>graphique_barres, graphique_ligne, jauge_circulaire</td><td><span class="b by">7/10</span></td></tr>
<tr><td>Formulaires</td><td>champ_texte, selecteur_date, selecteur_multiple</td><td><span class="b by">7/10</span></td></tr>
<tr><td>Gaming</td><td>boule_loto, grille_loto, tableau_paris</td><td><span class="b bg">8/10</span></td></tr>
</table>
<p>Aucun composant ne bypass les tokens. XSS-safe via _html() + html.escape(). <code>SnapshotTester</code> couvre 27 composants.</p>
</div>
</details>
</section>

<!-- ========== src/api/ ========== -->
<section id="api">
<h2>ğŸŒ src/api/ â€” API REST FastAPI</h2>
<div class="sg2">
  <div class="sc2"><div class="sv" style="color:var(--green);">34</div><div class="sl">Fichiers</div></div>
  <div class="sc2"><div class="sv" style="color:var(--green);">3 404</div><div class="sl">Lignes</div></div>
  <div class="sc2"><div class="sv" style="color:var(--green);">35</div><div class="sl">Endpoints<span class="d du">+9</span></div></div>
  <div class="sc2"><div class="sv" style="color:var(--green);">8.4</div><div class="sl">Score<span class="d du">+0.2</span></div></div>
</div>

<details open>
<summary>Endpoints par domaine (35 total)</summary>
<div>
<table>
<tr><th>Domaine</th><th>GET</th><th>POST</th><th>PUT</th><th>PATCH</th><th>DELETE</th><th>Total</th></tr>
<tr><td>SantÃ© / healthcheck</td><td class="ac">3</td><td class="ac">0</td><td class="ac">0</td><td class="ac">0</td><td class="ac">0</td><td class="ac"><strong>3</strong></td></tr>
<tr><td>Auth (JWT + Supabase)</td><td class="ac">1</td><td class="ac">2</td><td class="ac">0</td><td class="ac">0</td><td class="ac">0</td><td class="ac"><strong>3</strong></td></tr>
<tr><td>Recettes</td><td class="ac">2</td><td class="ac">1</td><td class="ac">1</td><td class="ac">1</td><td class="ac">1</td><td class="ac"><strong>6</strong></td></tr>
<tr><td>Inventaire</td><td class="ac">3</td><td class="ac">1</td><td class="ac">1</td><td class="ac">0</td><td class="ac">1</td><td class="ac"><strong>6</strong></td></tr>
<tr><td>Courses</td><td class="ac">2</td><td class="ac">2</td><td class="ac">2</td><td class="ac">0</td><td class="ac">2</td><td class="ac"><strong>8</strong></td></tr>
<tr><td>Planning</td><td class="ac">1</td><td class="ac">1</td><td class="ac">1</td><td class="ac">0</td><td class="ac">1</td><td class="ac"><strong>4</strong></td></tr>
<tr><td>Push notifications</td><td class="ac">1</td><td class="ac">1</td><td class="ac">0</td><td class="ac">0</td><td class="ac">1</td><td class="ac"><strong>3</strong></td></tr>
<tr><td>Suggestions IA</td><td class="ac">2</td><td class="ac">0</td><td class="ac">0</td><td class="ac">0</td><td class="ac">0</td><td class="ac"><strong>2</strong></td></tr>
<tr><td><strong>Total</strong></td><td class="ac"><strong>15</strong></td><td class="ac"><strong>8</strong></td><td class="ac"><strong>5</strong></td><td class="ac"><strong>1</strong></td><td class="ac"><strong>6</strong></td><td class="ac"><strong>35</strong></td></tr>
</table>
</div>
</details>

<details>
<summary>ğŸ”’ SÃ©curitÃ© â€” audit dÃ©taillÃ© <span class="b bg">8.5/10</span></summary>
<div>
<table>
<tr><th>Aspect</th><th>Statut</th><th>DÃ©tail</th></tr>
<tr><td>JWT dual-mode validation</td><td><span class="tf tag">âœ…</span></td><td>API HS256 secret + Supabase RS256 JWKS, RuntimeError si secret default en prod</td></tr>
<tr><td>Rate limiting multi-fenÃªtre</td><td><span class="tf tag">âœ…</span></td><td>3 fenÃªtres (minute/heure/jour), Redis backend, anti-brute-force (5/min login)</td></tr>
<tr><td>Security headers OWASP</td><td><span class="tf tag">âœ…</span></td><td>CSP, HSTS, X-Frame-Options, X-Content-Type, Referrer-Policy, Permissions-Policy</td></tr>
<tr><td>CORS strict mode</td><td><span class="tf tag">âœ…</span></td><td>Whitelist explicite, pas de wildcard, credentials:true</td></tr>
<tr><td>Error messages (no info leak)</td><td><span class="tf tag">âœ… CORRIGÃ‰ v3</span></td><td>Triple couche (generic, mapped, fallback), 0 fuite str(e). Messages gÃ©nÃ©riques en prod.</td></tr>
<tr><td>push.py KeyError bug</td><td><span class="tf tag">âœ… CORRIGÃ‰ v3</span></td><td>Utilise current_user["id"] partout (cohÃ©rent avec dependencies.py)</td></tr>
<tr><td>ETagMiddleware</td><td><span class="tm tag">âš ï¸ Shell</span></td><td>Ajoute Cache-Control mais pas de 304 conditionnel automatique â€” fonctionalitÃ© incomplÃ¨te</td></tr>
<tr><td>OpenAPI securitySchemes</td><td><span class="tc tag">âŒ MANQUANT</span></td><td>Bouton "Authorize" non-fonctionnel dans Swagger UI. Ajouter HTTPBearer scheme.</td></tr>
<tr><td>LoginRequest email</td><td><span class="tm tag">âš ï¸</span></td><td>Accepte n'importe quel string (pas de validation EmailStr Pydantic)</td></tr>
</table>
</div>
</details>
</section>

<!-- ========== app.py ========== -->
<section id="app">
<h2>ğŸš€ app.py â€” Point d'entrÃ©e principal</h2>
<div class="sg2">
  <div class="sc2"><div class="sv" style="color:var(--green);">112</div><div class="sl">Lignes</div></div>
  <div class="sc2"><div class="sv" style="color:var(--green);">9.0</div><div class="sl">Score<span class="d du">+0.5</span></div></div>
</div>

<div class="card" style="border-left:4px solid var(--green);">
<h4>Changements majeurs v3</h4>
<ul>
<li><span class="tf tag">âœ…</span> <strong>Navigation <code>st.navigation()</code> natif</strong> â€” RouteurOptimise custom remplacÃ© par l'API native Streamlit</li>
<li><span class="tf tag">âœ…</span> <strong>CSS single-injection</strong> via CSSManager pipeline (1 seul st.markdown batch pour tout le CSS)</li>
<li><span class="tf tag">âœ…</span> <strong>Bootstrap propre :</strong> env â†’ paths â†’ logging â†’ bootstrap â†’ layout â†’ st.navigation â†’ footer</li>
<li><span class="tf tag">âœ…</span> <strong>Error recovery :</strong> try/except global + <code>st.exception(e)</code> en debug + bouton "RedÃ©marrer"</li>
<li>âš ï¸ <code>valider_config=False</code> â€” validation config dÃ©sactivÃ©e (lazy mode intentionnel)</li>
</ul>
<p>Architecture app.py exemplaire. 112 lignes Ã©purÃ©es, aucune logique mÃ©tier, pure orchestration.</p>
</div>
</section>

<!-- ========== ADOPTION MATRIX ========== -->
<section id="adoption">
<h2>ğŸ” Matrice d'adoption â€” v3 complÃ¨te</h2>

<h3>Concepts dans les Services (src/services/)</h3>
<div class="ar2"><div class="cn">@service_factory</div><div style="flex:1"><div class="pb"><div class="pf pfg" style="width:98%"></div></div></div><div class="ra"><strong>55/56</strong></div></div>
<div class="ar2"><div class="cn">obtenir_client_ia()</div><div style="flex:1"><div class="pb"><div class="pf pfg" style="width:100%"></div></div></div><div class="ra"><strong>17/17</strong></div></div>
<div class="ar2"><div class="cn">@avec_session_db</div><div style="flex:1"><div class="pb"><div class="pf pfg" style="width:95%"></div></div></div><div class="ra"><strong>~236 usages</strong></div></div>
<div class="ar2"><div class="cn">@avec_cache</div><div style="flex:1"><div class="pb"><div class="pf pfg" style="width:80%"></div></div></div><div class="ra"><strong>65</strong><span class="d du"> +15</span></div></div>
<div class="ar2"><div class="cn">@avec_gestion_erreurs</div><div style="flex:1"><div class="pb"><div class="pf pfg" style="width:75%"></div></div></div><div class="ra"><strong>~139 usages</strong></div></div>
<div class="ar2"><div class="cn">@avec_resilience</div><div style="flex:1"><div class="pb"><div class="pf pfy" style="width:60%"></div></div></div><div class="ra"><strong>9/12 HTTP</strong></div></div>
<div class="ar2"><div class="cn">joinedload/selectinload</div><div style="flex:1"><div class="pb"><div class="pf pfg" style="width:85%"></div></div></div><div class="ra"><strong>~50 usages</strong></div></div>
<div class="ar2"><div class="cn">BaseAIService</div><div style="flex:1"><div class="pb"><div class="pf pfg" style="width:100%"></div></div></div><div class="ra"><strong>17/17 IA</strong></div></div>
<div class="ar2"><div class="cn">Bus Ã©vÃ©nements (Ã©metteurs)</div><div style="flex:1"><div class="pb"><div class="pf pfg" style="width:73%"></div></div></div><div class="ra"><strong>10/14 services</strong></div></div>

<h3>Concepts dans les Modules (src/modules/)</h3>
<div class="ar2"><div class="cn">app() entry point</div><div style="flex:1"><div class="pb"><div class="pf pfg" style="width:100%"></div></div></div><div class="ra"><strong>32/32</strong></div></div>
<div class="ar2"><div class="cn">@profiler_rerun</div><div style="flex:1"><div class="pb"><div class="pf pfg" style="width:87%"></div></div></div><div class="ra"><strong>28/32</strong><span class="d du"> +24</span></div></div>
<div class="ar2"><div class="cn">error_boundary actif (with)</div><div style="flex:1"><div class="pb"><div class="pf pfg" style="width:75%"></div></div></div><div class="ra"><strong>24/32</strong> (111 blocs)</div></div>
<div class="ar2"><div class="cn">Service delegation</div><div style="flex:1"><div class="pb"><div class="pf pfg" style="width:100%"></div></div></div><div class="ra"><strong>32/32</strong> (0 DB direct)</div></div>
<div class="ar2"><div class="cn">Lazy loading imports</div><div style="flex:1"><div class="pb"><div class="pf pfg" style="width:100%"></div></div></div><div class="ra"><strong>32/32</strong></div></div>
<div class="ar2"><div class="cn">SK constants</div><div style="flex:1"><div class="pb"><div class="pf pfg" style="width:90%"></div></div></div><div class="ra"><strong>29 fichiers</strong></div></div>
<div class="ar2"><div class="cn">KeyNamespace</div><div style="flex:1"><div class="pb"><div class="pf pfy" style="width:47%"></div></div></div><div class="ra"><strong>15 fichiers</strong> (10 ns)</div></div>
<div class="ar2"><div class="cn">@ui_fragment</div><div style="flex:1"><div class="pb"><div class="pf pfg" style="width:76%"></div></div></div><div class="ra"><strong>107 usages</strong> (49 files)</div></div>

<h3>Concepts dans le Design System (src/ui/)</h3>
<div class="ar2"><div class="cn">tokens.py (Couleur)</div><div style="flex:1"><div class="pb"><div class="pf pfg" style="width:25%"></div></div></div><div class="ra"><strong>15/61 fichiers</strong></div></div>
<div class="ar2"><div class="cn">tokens_semantic (Sem)</div><div style="flex:1"><div class="pb"><div class="pf pfr" style="width:5%"></div></div></div><div class="ra"><strong>3/61 fichiers</strong></div></div>
<div class="ar2"><div class="cn">@composant_ui</div><div style="flex:1"><div class="pb"><div class="pf pfg" style="width:100%"></div></div></div><div class="ra"><strong>36 composants</strong></div></div>
<div class="ar2"><div class="cn">SnapshotTester</div><div style="flex:1"><div class="pb"><div class="pf pfg" style="width:75%"></div></div></div><div class="ra"><strong>27/36 testÃ©s</strong></div></div>
</section>

<!-- ========== EVENT BUS ========== -->
<section id="events">
<h2>ğŸ“¡ Bus d'Ã©vÃ©nements â€” Cartographie complÃ¨te v3</h2>

<h3>27 Ã©vÃ©nements Ã©mis, 10 services, 7 subscribers</h3>
<table>
<tr><th>Domaine</th><th>Ã‰vÃ©nements</th><th>Service(s)</th><th>Subscriber cache</th></tr>
<tr><td>stock.*</td><td>stock.modifie (Ã—3 contextes)</td><td>InventaireOperationsMixin</td><td><span class="tf tag">âœ… OUI</span></td></tr>
<tr><td>recette.*</td><td>recette.creee, recette.importee</td><td>ServiceRecettes</td><td><span class="tf tag">âœ… OUI</span></td></tr>
<tr><td>courses.*</td><td>courses.ingredients_ajoutes</td><td>ServiceCourses</td><td><span class="tf tag">âœ… OUI</span></td></tr>
<tr><td>entretien.*</td><td>routine_creee, semaine_optimisee</td><td>EntretienService</td><td><span class="tf tag">âœ… OUI</span></td></tr>
<tr><td>planning.*</td><td>planning.cree</td><td>ServicePlanning</td><td><span class="th tag">âŒ PAS DE SUBSCRIBER</span></td></tr>
<tr><td>batch_cooking.*</td><td>session_creee, termine</td><td>ServiceBatchCooking</td><td><span class="th tag">âŒ PAS DE SUBSCRIBER</span></td></tr>
<tr><td>activites.*</td><td>cree, terminee, supprimee</td><td>ServiceActivites</td><td><span class="th tag">âŒ PAS DE SUBSCRIBER</span></td></tr>
<tr><td>routines.*</td><td>cree, tache_ajoutee, tache_complete, supprimee, desactivee</td><td>ServiceRoutines</td><td><span class="th tag">âŒ PAS DE SUBSCRIBER</span></td></tr>
<tr><td>weekend.*</td><td>cree, termine, note</td><td>ServiceWeekend</td><td><span class="th tag">âŒ PAS DE SUBSCRIBER</span></td></tr>
<tr><td>achats.*</td><td>cree, achete, supprime</td><td>ServiceAchatsFamille</td><td><span class="th tag">âŒ PAS DE SUBSCRIBER</span></td></tr>
<tr><td>food_log.*</td><td>food_log.ajoute</td><td>ServiceSuiviPerso</td><td><span class="th tag">âŒ PAS DE SUBSCRIBER</span></td></tr>
</table>

<div class="card" style="border-left:4px solid var(--orange);">
<p><strong>Gap critique :</strong> 7 domaines sur 11 Ã©mettent des Ã©vÃ©nements mais <strong>n'ont aucun subscriber d'invalidation cache dÃ©diÃ©</strong>. Seuls stock.*, recette.*, courses.* et entretien.* ont une invalidation automatique. Les 7 autres se reposent uniquement sur le wildcard <code>*</code> (mÃ©triques + logging), sans invalidation cache.</p>
<p>Cela signifie que les donnÃ©es de planning, batch_cooking, activitÃ©s, routines, weekend, achats et food_log restent en cache obsolÃ¨te aprÃ¨s mutation jusqu'Ã  expiration TTL.</p>
</div>
</section>

<!-- ========== ISSUES ========== -->
<section id="issues">
<h2>ğŸ› ProblÃ¨mes rÃ©siduels â€” Top 15 priorisÃ©</h2>

<table>
<tr><th>#</th><th>SÃ©vÃ©ritÃ©</th><th>Localisation</th><th>Description</th><th>Effort</th></tr>
<tr><td>1</td><td><span class="th tag">P1</span></td><td>services/core/specifications/</td><td>795 LOC, <strong>0 consommateur externe</strong> â€” dead code. ROADMAP dit Â« supprimÃ© Â» mais la version services/ reste.</td><td>1h</td></tr>
<tr><td>2</td><td><span class="th tag">P1</span></td><td>services/core/middleware/</td><td>584 LOC, <strong>1 seul consommateur</strong> (cuisine/recettes/service.py). Dead code quasi-intÃ©gral.</td><td>2h</td></tr>
<tr><td>3</td><td><span class="th tag">P1</span></td><td>services/maison/ (5 services)</td><td><strong>0 @avec_cache.</strong> RequÃªtes DB rÃ©pÃ©tÃ©es Ã  chaque rerun Streamlit. Impact performance direct.</td><td>3h</td></tr>
<tr><td>4</td><td><span class="th tag">P1</span></td><td>services/core/events/subscribers.py</td><td><strong>7 domaines</strong> event bus sans subscriber invalidation cache. DonnÃ©es stale aprÃ¨s mutation.</td><td>3h</td></tr>
<tr><td>5</td><td><span class="tm tag">P2</span></td><td>core/ai/circuit_breaker.py</td><td>async_wrapper : coroutine n'est pas awaitÃ©e dans appeler().</td><td>30min</td></tr>
<tr><td>6</td><td><span class="tm tag">P2</span></td><td>integrations/images/generator.py</td><td>6 appels HTTP (requests) sans @avec_resilience ni @service_factory.</td><td>1h</td></tr>
<tr><td>7</td><td><span class="tm tag">P2</span></td><td>famille/{calendrier,google_calendar}.py</td><td>Appels httpx sans @avec_resilience. Timeout potentiel non gÃ©rÃ©.</td><td>1h</td></tr>
<tr><td>8</td><td><span class="tm tag">P2</span></td><td>ui/tokens_semantic.py (Sem)</td><td>AdoptÃ© par <strong>3/61 fichiers</strong> seulement. Dark mode non cascade aux composants atomiques.</td><td>4h</td></tr>
<tr><td>9</td><td><span class="tm tag">P2</span></td><td>modules (5 fichiers)</td><td>Importent error_boundary mais 0 bloc <code>with</code> : calendrier, paris, recherche_produits, activites, routines.</td><td>2h</td></tr>
<tr><td>10</td><td><span class="tm tag">P2</span></td><td>services/rapports/ (7 fichiers)</td><td>0 @avec_cache, 0 Ã©vÃ©nements bus. Package le plus en retard niveau adoption.</td><td>2h</td></tr>
<tr><td>11</td><td><span class="tl tag">P3</span></td><td>api/main.py</td><td>OpenAPI securitySchemes manquant â€” bouton Authorize non-fonctionnel dans Swagger UI.</td><td>30min</td></tr>
<tr><td>12</td><td><span class="tl tag">P3</span></td><td>modules (4)</td><td>@profiler_rerun manquant : design_system, templates_ui, timeline_ui, chat_ia.</td><td>30min</td></tr>
<tr><td>13</td><td><span class="tl tag">P3</span></td><td>ui/views/notifications.py</td><td>8 inline style= blocks, 0 tokens â€” bypass complet du design system.</td><td>2h</td></tr>
<tr><td>14</td><td><span class="tl tag">P3</span></td><td>api/rate_limiting.py â†’ ETagMiddleware</td><td>Ajoute Cache-Control mais pas de 304 conditionnel. Shell incomplet.</td><td>2h</td></tr>
<tr><td>15</td><td><span class="tl tag">P3</span></td><td>services/core/observability/spans.py</td><td>278 LOC de tracing jamais invoquÃ©. Garder si futur OpenTelemetry prÃ©vu, sinon supprimer.</td><td>30min</td></tr>
</table>
</section>

<!-- ========== INNOVATIONS ========== -->
<section id="innovations">
<h2>ğŸ’¡ AmÃ©liorations innovantes â€” Streamlit 2026</h2>

<div class="ig">

<div class="ic" style="border-left-color:var(--green);">
<h4>1. ğŸŒ™ Dark Mode â€” activation complÃ¨te</h4>
<p>L'infrastructure est 100% en place (tokens Sem, injection CSS, theme.py, toggle). Il suffit de migrer les composants atoms.py de <code>Couleur.XXX</code> vers <code>var(--sem-*)</code> (CSS variables). <strong>3-4 fichiers Ã  modifier pour un dark mode fonctionnel complet.</strong></p>
<div class="im"><span>Impact :</span> UX +++++. ROI exceptionnel â€” 95% du travail est dÃ©jÃ  fait.</div>
</div>

<div class="ic" style="border-left-color:var(--green);">
<h4>2. ğŸ“¡ Cache invalidation via Event Bus</h4>
<p>27 Ã©vÃ©nements Ã©mis, mais 7 domaines sans subscriber cache. Ajouter 7 handlers dans <code>subscribers.py</code> pour invalidation automatique. Pattern identique Ã  <code>_invalider_cache_recettes</code> existant.</p>
<div class="im"><span>Impact :</span> Performance ++++. Cache toujours frais aprÃ¨s mutations. Effort : ~3h.</div>
</div>

<div class="ic" style="border-left-color:var(--accent);">
<h4>3. ğŸ’¬ Migration @st.dialog</h4>
<p>Streamlit 1.35+ fournit <code>@st.dialog</code> natif. La <code>Modale</code> du projet est dÃ©jÃ  marquÃ©e DEPRECATED dans <code>components/dynamic.py</code>. Migration 1:1 vers le natif â€” Ã©limine du CSS custom et simplifie le code.</p>
<div class="im"><span>Impact :</span> UX ++, dette technique --. Effort : ~2h par modale.</div>
</div>

<div class="ic" style="border-left-color:var(--accent);">
<h4>4. ğŸŒŠ st.write_stream() partout</h4>
<p><code>chat_ia.py</code> l'utilise dÃ©jÃ  avec succÃ¨s. Ã‰tendre Ã  toutes les rÃ©ponses IA : suggestions recettes, planning hebdo, analyses Jules, conseils weekend. Remplace les spinners par du contenu progressif natif.</p>
<div class="im"><span>Impact :</span> UX +++. Perception de vitesse amÃ©liorÃ©e. Effort : ~1h par module IA.</div>
</div>

<div class="ic" style="border-left-color:var(--purple);">
<h4>5. ğŸ§© @cached_fragment + @lazy</h4>
<p>DÃ©finis dans fragments.py (7 dÃ©corateurs) mais 0 adoption. <code>@cached_fragment(ttl=300)</code> combinerait <code>@st.cache_data</code> + <code>@st.fragment</code> pour des sections Ã  refresh partiel ET cache. IdÃ©al pour dashboards, graphiques Plotly lourds, tableaux de donnÃ©es.</p>
<div class="im"><span>Impact :</span> Performance ++++. RÃ©duction des re-rendus de 60-80%. ROI Ã©levÃ©.</div>
</div>

<div class="ic" style="border-left-color:var(--purple);">
<h4>6. â±ï¸ @auto_refresh pour dashboards</h4>
<p>3 usages actuels. Ã‰tendre aux dashboards accueil, maison/hub, et monitoring santÃ© pour des mÃ©triques en temps rÃ©el sans interaction utilisateur. Configurable par intervalle.</p>
<div class="im"><span>Impact :</span> UX ++. DonnÃ©es toujours fraÃ®ches sans refresh manuel.</div>
</div>

<div class="ic" style="border-left-color:var(--orange);">
<h4>7. ğŸ“± Service Worker PWA offline</h4>
<p>PWA infrastructure existe (manifest 624 LOC, 8 icons 72â†’512px, meta tags). Ajouter un Service Worker fonctionnel pour consultation offline des recettes, liste de courses et planning â€” les donnÃ©es les plus utiles en dÃ©placement.</p>
<div class="im"><span>Impact :</span> UX ++++. App utilisable en mode avion ou zone sans rÃ©seau.</div>
</div>

<div class="ic" style="border-left-color:var(--orange);">
<h4>8. ğŸ¨ Storybook vivant avec snapshots</h4>
<p><code>design_system.py</code> + 36 <code>@composant_ui</code> + <code>SnapshotTester</code> (27 tests) = tout est lÃ  pour un catalogue interactif complet avec previews live, props explorer et rÃ©gression visuelle automatique.</p>
<div class="im"><span>Impact :</span> DX +++. Documentation vivante du design system.</div>
</div>

<div class="ic" style="border-left-color:var(--cyan);">
<h4>9. ğŸ§  Chat IA contextuel par module</h4>
<p><code>chat_ia.py</code> prouve le pattern (BaseAIService + @service_factory + st.write_stream). Ajouter <code>st.chat_input()</code> contextuel dans cuisine et famille avec prompts context-aware basÃ©s sur les donnÃ©es du module courant.</p>
<div class="im"><span>Impact :</span> Innovation ++++. Interaction naturelle avec les donnÃ©es.</div>
</div>

<div class="ic" style="border-left-color:var(--cyan);">
<h4>10. ğŸ”— Deep linking URL persistant</h4>
<p><code>ui/state/url.py</code> (410 LOC) fournit <code>tabs_with_url</code>, <code>selectbox_with_url</code>, <code>pagination_with_url</code> prÃªts Ã  l'emploi. Adopter dans les modules principaux pour des URLs partageables (cuisine/recettes?id=42&tab=ingredients).</p>
<div class="im"><span>Impact :</span> UX +++. Liens directs vers du contenu spÃ©cifique.</div>
</div>

<div class="ic" style="border-left-color:var(--cyan);">
<h4>11. â™¿ Skip-link + ARIA landmarks</h4>
<p>Le CSS skip-link est injectÃ© mais aucun Ã©lÃ©ment <code>&lt;a class="skip-link"&gt;</code> n'est rendu. Ajouter un skip-link fonctionnel + <code>A11y.landmark()</code> sur les sections principales pour conformitÃ© WCAG 2.1 AA.</p>
<div class="im"><span>Impact :</span> AccessibilitÃ© ++. ConformitÃ© WCAG.</div>
</div>

<div class="ic" style="border-left-color:var(--cyan);">
<h4>12. ğŸ“Š Specification pattern pour filtres dynamiques</h4>
<p><code>services/core/specifications/</code> (795 LOC) implÃ©mente un pattern composable puissant (And, Or, Not, filtrage SQLAlchemy). PlutÃ´t que le supprimer, l'adopter dans inventaire et recettes pour des filtres dynamiques composables cÃ´tÃ© utilisateur.</p>
<div class="im"><span>Impact :</span> Architecture +++, DX ++. Valorise du code existant au lieu de le supprimer.</div>
</div>

</div>
</section>

<!-- ========== ROADMAP v3 ========== -->
<section id="roadmap">
<h2>ğŸ—ºï¸ Roadmap v3 â€” 4 phases, 20 semaines</h2>

<div class="tl2">

<div class="ti2 done">
<h4><span class="tf tag">Phases 1-3 âœ…</span> Corrections critiques, adoption framework, infrastructure â€” <strong>TERMINÃ‰ES</strong></h4>
<p>6 bugs critiques corrigÃ©s, 8 patterns dead code supprimÃ©s (~6 000 LOC), 111 error_boundary blocs dÃ©ployÃ©s, 28/32 profiler_rerun, 18 N+1 fixÃ©s, navigation st.navigation(), dark mode toggle, 27 tests visuels, PWA icons, 5 WIP features complÃ©tÃ©es.</p>
</div>

<div class="ti2 p1">
<h4><span class="tc tag">Phase 4</span> Finitions &amp; cohÃ©rence â€” Semaines 1-4</h4>
<p>Ã‰liminer les derniers gaps d'adoption et le dead code rÃ©siduel.</p>
<ul>
<li>ğŸ”´ <strong>DÃ©cision : specifications/</strong> (795 LOC) â€” adopter pour inventaire/recettes <em>ou</em> supprimer si non pertinent</li>
<li>ğŸ”´ <strong>Supprimer middleware/</strong> (584 LOC) â€” remplacer le seul usage dans recettes/service.py par un dÃ©corateur standard</li>
<li>ğŸ”´ <strong>Ajouter @avec_cache dans maison/</strong> (5 services, 0 cache actuellement) â€” impact performance immÃ©diat</li>
<li>ğŸ”´ <strong>7 subscribers cache manquants</strong> (planning, batch_cooking, activites, routines, weekend, achats, food_log)</li>
<li>ğŸŸ¡ <strong>error_boundary actif</strong> dans les 5 modules qui importent sans utiliser (calendrier, paris, recherche_produits, activites, routines)</li>
<li>ğŸŸ¡ <strong>@profiler_rerun</strong> sur les 4 manquants (design_system, templates_ui, timeline_ui, chat_ia)</li>
<li>ğŸŸ¡ <strong>@avec_resilience</strong> sur images/generator.py (6 HTTP), calendrier/service.py et notif_ntfy.py</li>
<li>ğŸŸ¡ <strong>Fix circuit breaker async</strong> â€” await la coroutine dans appeler()</li>
<li>ğŸŸ¡ <strong>@avec_cache + @avec_gestion_erreurs dans rapports/</strong> (7 fichiers, 0 adoption)</li>
</ul>
</div>

<div class="ti2 p2">
<h4><span class="th tag">Phase 5</span> Design System â€” Dark mode complet â€” Semaines 5-8</h4>
<p>Activer le dark mode au niveau composants et unifier les tokens.</p>
<ul>
<li>ğŸŸ¡ <strong>Migrer atoms.py</strong> de Couleur.XXX vers var(--sem-*) (badge, carte_metrique, boite_info)</li>
<li>ğŸŸ¡ <strong>Migrer tablet/styles.py</strong> â€” remplacer 2 hex hardcodÃ©s par tokens sÃ©mantiques</li>
<li>ğŸŸ¡ <strong>Refactorer views/notifications.py</strong> â€” 8 inline styles â†’ tokens + StyleSheet</li>
<li>ğŸŸ¡ <strong>Fix fragments.py skeleton</strong> â€” #f0f0f0 â†’ Sem.SURFACE_ALT</li>
<li>ğŸŸ¢ <strong>A11y adoption</strong> : skip-link rendu, A11y.attrs() dans views, contrast checks sur Sem</li>
<li>ğŸŸ¢ <strong>Promouvoir @cached_fragment + @lazy</strong> dans les modules lourds (cuisine dashboard, planning)</li>
</ul>
</div>

<div class="ti2 p3">
<h4><span class="tm tag">Phase 6</span> Innovations Streamlit â€” Semaines 9-14</h4>
<p>Exploiter les APIs Streamlit modernes pour une UX de nouvelle gÃ©nÃ©ration.</p>
<ul>
<li>ğŸŸ¡ <strong>st.write_stream()</strong> pour toutes les rÃ©ponses IA (suggestions, planning, analyses)</li>
<li>ğŸŸ¡ <strong>@st.dialog</strong> migration (remplacer Modale deprecated par le natif)</li>
<li>ğŸŸ¡ <strong>@auto_refresh</strong> dashboards (accueil, maison/hub, santÃ©)</li>
<li>ğŸŸ¡ <strong>Deep linking URL</strong> â€” tabs_with_url dans cuisine, famille, planning</li>
<li>ğŸŸ¡ <strong>Chat IA contextuel</strong> cuisine + famille avec prompts context-aware</li>
<li>ğŸŸ¢ <strong>Specification pattern</strong> pour filtres dynamiques inventaire/recettes</li>
</ul>
</div>

<div class="ti2 p4">
<h4><span class="ti tag">Phase 7</span> Production hardening â€” Semaines 15-20</h4>
<p>Durcir pour la production long-terme.</p>
<ul>
<li>ğŸŸ¢ <strong>OpenAPI securitySchemes</strong> pour Swagger Authorize fonctionnel</li>
<li>ğŸŸ¢ <strong>ETagMiddleware</strong> 304 conditionnel ou suppression du shell</li>
<li>ğŸŸ¢ <strong>Tests coverage 80%+</strong> sur core/ et services/, rÃ©soudre 322 tests skipped</li>
<li>ğŸŸ¢ <strong>Sentry integration</strong> pour error tracking production</li>
<li>ğŸŸ¢ <strong>Service Worker PWA</strong> offline fonctionnel avec cache recettes/courses</li>
<li>ğŸŸ¢ <strong>JSON structured logging</strong> pour analyse et monitoring</li>
<li>ğŸŸ¢ <strong>CI/CD pipeline</strong> (GitHub Actions : lint â†’ test â†’ deploy Streamlit Cloud)</li>
</ul>
</div>

</div>

<h3>RÃ©capitulatif phases</h3>
<table>
<tr><th>Phase</th><th>Focus</th><th>DurÃ©e</th><th>Items</th><th>Impact principal</th></tr>
<tr><td><span class="tf tag">1-3 âœ…</span></td><td>Bugs, framework, infrastructure</td><td>Fait</td><td>35+</td><td>Cache, error_boundary, dead code -6K LOC, N+1, navigation native</td></tr>
<tr><td><span class="tc tag">4</span></td><td>Finitions &amp; cohÃ©rence</td><td>4 sem</td><td>9</td><td>Dead code rÃ©siduel, cache maison, subscribers, resilience</td></tr>
<tr><td><span class="th tag">5</span></td><td>Design System dark mode</td><td>4 sem</td><td>6</td><td><strong>Dark mode complet</strong>, a11y, fragments avancÃ©s</td></tr>
<tr><td><span class="tm tag">6</span></td><td>Innovations Streamlit</td><td>6 sem</td><td>6</td><td>Streaming, dialogs, deep linking, chat IA</td></tr>
<tr><td><span class="ti tag">7</span></td><td>Production hardening</td><td>6 sem</td><td>7</td><td>SÃ©curitÃ©, tests 80%+, CI/CD, PWA offline</td></tr>
</table>
</section>

<!-- ========== FOOTER ========== -->
<hr>
<p style="text-align:center;color:var(--text-muted);font-size:.83rem;padding:2rem 0;">
  Rapport d'audit v3 â€” 24 fÃ©vrier 2026 &bull; Assistant Matanne &bull; ~570 fichiers analysÃ©s, ~96 000 lignes de code<br>
  <em>Score global : <strong>8.5/10</strong> (v1 : 7.9 â†’ v2 : 8.3 â†’ v3 : 8.5) â€” progression remarquable et continue.<br>
  Prochains quick wins : dark mode complet (3 fichiers), 7 subscribers cache, @avec_cache maison/ (5 services).<br>
  Objectif v4 : 9.0/10 â€” innovations Streamlit + production hardening.</em>
</p>

</div>

<script>
document.addEventListener('DOMContentLoaded', () => {
  const sections = document.querySelectorAll('section[id], div[id]');
  const navLinks = document.querySelectorAll('.sidebar nav a[href^="#"]');
  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        navLinks.forEach(l => l.style.background = '');
        const active = document.querySelector(`.sidebar nav a[href="#${entry.target.id}"]`);
        if (active) active.style.background = 'rgba(59,130,246,.15)';
      }
    });
  }, { rootMargin: '-20% 0px -70% 0px' });
  sections.forEach(s => observer.observe(s));
});
</script>
</body>
</html>
