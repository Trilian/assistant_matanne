<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Audit Complet â€” Assistant Matanne</title>
<style>
/* ===== RESET & BASE ===== */
*, *::before, *::after { box-sizing: border-box; margin: 0; padding: 0; }
:root {
  --bg: #ffffff; --bg-alt: #f8f9fa; --bg-card: #ffffff; --bg-sidebar: #1e293b;
  --text: #1e293b; --text-muted: #64748b; --text-sidebar: #e2e8f0;
  --border: #e2e8f0; --accent: #3b82f6; --accent-light: #eff6ff;
  --green: #10b981; --green-bg: #ecfdf5; --yellow: #f59e0b; --yellow-bg: #fffbeb;
  --red: #ef4444; --red-bg: #fef2f2; --orange: #f97316; --orange-bg: #fff7ed;
  --purple: #8b5cf6; --purple-bg: #f5f3ff; --cyan: #06b6d4;
  --shadow: 0 1px 3px rgba(0,0,0,.1); --shadow-lg: 0 4px 15px rgba(0,0,0,.1);
  --radius: 8px; --radius-lg: 12px;
  --font: 'Segoe UI', system-ui, -apple-system, sans-serif;
  --mono: 'Cascadia Code', 'Fira Code', 'Consolas', monospace;
  --sidebar-w: 280px;
}
@media (prefers-color-scheme: dark) {
  :root {
    --bg: #0f172a; --bg-alt: #1e293b; --bg-card: #1e293b; --bg-sidebar: #0f172a;
    --text: #e2e8f0; --text-muted: #94a3b8; --border: #334155;
    --accent-light: #1e3a5f; --green-bg: #064e3b; --yellow-bg: #78350f;
    --red-bg: #7f1d1d; --orange-bg: #7c2d12; --purple-bg: #4c1d95;
    --shadow: 0 1px 3px rgba(0,0,0,.3); --shadow-lg: 0 4px 15px rgba(0,0,0,.3);
  }
}
html { scroll-behavior: smooth; font-size: 15px; }
body { font-family: var(--font); color: var(--text); background: var(--bg); line-height: 1.6; }
a { color: var(--accent); text-decoration: none; }
a:hover { text-decoration: underline; }
code { font-family: var(--mono); font-size: .88em; background: var(--bg-alt); padding: 2px 6px; border-radius: 4px; }
pre { background: var(--bg-alt); padding: 16px; border-radius: var(--radius); overflow-x: auto; font-size: .85rem; border: 1px solid var(--border); }
pre code { background: none; padding: 0; }
h1,h2,h3,h4 { font-weight: 700; line-height: 1.3; }
hr { border: none; border-top: 1px solid var(--border); margin: 2rem 0; }

/* ===== SIDEBAR ===== */
.sidebar {
  position: fixed; top: 0; left: 0; width: var(--sidebar-w); height: 100vh;
  background: var(--bg-sidebar); color: var(--text-sidebar);
  overflow-y: auto; z-index: 100; padding: 1.5rem 0;
  border-right: 1px solid rgba(255,255,255,.1);
}
.sidebar h2 { font-size: 1rem; padding: 0 1.2rem; margin-bottom: 1rem; color: #fff; letter-spacing: .02em; }
.sidebar .logo { text-align: center; padding: 0 1.2rem .8rem; border-bottom: 1px solid rgba(255,255,255,.1); margin-bottom: 1rem; }
.sidebar .logo span { font-size: 1.4rem; font-weight: 800; color: var(--accent); }
.sidebar .logo small { display: block; color: var(--text-muted); font-size: .75rem; margin-top: 2px; }
.sidebar nav a {
  display: flex; align-items: center; padding: .45rem 1.2rem; color: var(--text-sidebar);
  font-size: .82rem; transition: all .15s; gap: .5rem; border-left: 3px solid transparent;
}
.sidebar nav a:hover { background: rgba(255,255,255,.08); text-decoration: none; border-left-color: var(--accent); }
.sidebar nav a.section-title { font-weight: 700; font-size: .78rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: .06em; padding-top: .8rem; cursor: default; }
.sidebar nav a.section-title:hover { background: none; border-left-color: transparent; }
.sidebar nav a .nav-badge { margin-left: auto; font-size: .7rem; padding: 1px 7px; border-radius: 10px; font-weight: 600; }

/* ===== MAIN CONTENT ===== */
.main { margin-left: var(--sidebar-w); padding: 2rem 3rem 4rem; max-width: 1100px; }
.main > section { margin-bottom: 3rem; }
.main h1 { font-size: 2rem; margin-bottom: .3rem; }
.main h2 { font-size: 1.5rem; margin: 2.5rem 0 1rem; padding-bottom: .4rem; border-bottom: 2px solid var(--accent); }
.main h3 { font-size: 1.15rem; margin: 1.5rem 0 .6rem; }
.main h4 { font-size: 1rem; margin: 1rem 0 .4rem; color: var(--text-muted); }
p, li { margin-bottom: .4rem; }
ul, ol { padding-left: 1.5rem; }

/* ===== CARDS ===== */
.card {
  background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius-lg);
  padding: 1.2rem 1.5rem; margin: 1rem 0; box-shadow: var(--shadow);
}
.card-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: .5rem; }
.card-header h3 { margin: 0; }

/* ===== SCORE BADGES ===== */
.badge { display: inline-block; padding: 2px 10px; border-radius: 12px; font-size: .78rem; font-weight: 600; }
.badge-green { background: var(--green-bg); color: var(--green); }
.badge-yellow { background: var(--yellow-bg); color: var(--yellow); }
.badge-red { background: var(--red-bg); color: var(--red); }
.badge-accent { background: var(--accent-light); color: var(--accent); }
.badge-purple { background: var(--purple-bg); color: var(--purple); }
.badge-orange { background: var(--orange-bg); color: var(--orange); }
.score { font-size: 1.3rem; font-weight: 800; }
.score-green { color: var(--green); }
.score-yellow { color: var(--yellow); }
.score-red { color: var(--red); }

/* ===== PROGRESS BARS ===== */
.progress-bar { background: var(--bg-alt); border-radius: 10px; height: 10px; overflow: hidden; margin: 4px 0; }
.progress-fill { height: 100%; border-radius: 10px; transition: width .4s; }
.progress-green { background: var(--green); }
.progress-yellow { background: var(--yellow); }
.progress-red { background: var(--red); }
.progress-accent { background: var(--accent); }

/* ===== TABLES ===== */
table { width: 100%; border-collapse: collapse; margin: .8rem 0; font-size: .88rem; }
th, td { text-align: left; padding: .55rem .8rem; border-bottom: 1px solid var(--border); }
th { font-weight: 700; background: var(--bg-alt); position: sticky; top: 0; white-space: nowrap; }
tr:hover { background: var(--accent-light); }
.align-center { text-align: center; }
.align-right { text-align: right; }
.nowrap { white-space: nowrap; }

/* ===== STATS GRID ===== */
.stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(180px, 1fr)); gap: 1rem; margin: 1rem 0; }
.stat-card {
  background: var(--bg-card); border: 1px solid var(--border); border-radius: var(--radius);
  padding: 1rem 1.2rem; text-align: center; box-shadow: var(--shadow);
}
.stat-card .stat-value { font-size: 2rem; font-weight: 800; line-height: 1.2; }
.stat-card .stat-label { font-size: .78rem; color: var(--text-muted); margin-top: .3rem; }

/* ===== RADAR CHART (CSS) ===== */
.radar-container { display: flex; flex-wrap: wrap; gap: 1.5rem; margin: 1.5rem 0; }
.radar-item { flex: 1; min-width: 200px; }
.radar-item .label { display: flex; justify-content: space-between; font-size: .85rem; margin-bottom: 3px; }
.radar-item .label strong { font-weight: 600; }

/* ===== COLLAPSIBLE ===== */
details { border: 1px solid var(--border); border-radius: var(--radius); margin: .8rem 0; overflow: hidden; }
details[open] { box-shadow: var(--shadow); }
summary {
  padding: .7rem 1rem; cursor: pointer; font-weight: 600; font-size: .95rem;
  background: var(--bg-alt); display: flex; align-items: center; gap: .5rem;
  list-style: none;
}
summary::-webkit-details-marker { display: none; }
summary::before { content: 'â–¶'; font-size: .7rem; transition: transform .2s; display: inline-block; width: 1rem; }
details[open] summary::before { transform: rotate(90deg); }
details > :not(summary) { padding: .8rem 1rem; }

/* ===== SEVERITY TAGS ===== */
.tag { display: inline-block; padding: 1px 8px; border-radius: 4px; font-size: .75rem; font-weight: 600; margin-right: 4px; vertical-align: middle; }
.tag-critical { background: var(--red-bg); color: var(--red); }
.tag-high { background: var(--orange-bg); color: var(--orange); }
.tag-medium { background: var(--yellow-bg); color: var(--yellow); }
.tag-low { background: var(--green-bg); color: var(--green); }
.tag-info { background: var(--accent-light); color: var(--accent); }

/* ===== CHECK MATRIX ===== */
.check { color: var(--green); font-weight: 700; }
.cross { color: var(--red); font-weight: 700; }
.warn { color: var(--yellow); font-weight: 700; }

/* ===== TIMELINE / ROADMAP ===== */
.timeline { position: relative; padding-left: 2rem; margin: 1.5rem 0; }
.timeline::before { content: ''; position: absolute; left: 8px; top: 0; bottom: 0; width: 3px; background: var(--border); border-radius: 3px; }
.timeline-item { position: relative; margin-bottom: 1.5rem; }
.timeline-item::before {
  content: ''; position: absolute; left: -2rem; top: 6px; width: 14px; height: 14px;
  border-radius: 50%; border: 3px solid var(--accent); background: var(--bg);
}
.timeline-item.phase1::before { border-color: var(--red); }
.timeline-item.phase2::before { border-color: var(--orange); }
.timeline-item.phase3::before { border-color: var(--yellow); }
.timeline-item.phase4::before { border-color: var(--accent); }
.timeline-item.phase5::before { border-color: var(--green); }
.timeline-item h4 { margin: 0 0 .3rem; }
.timeline-item p { margin: 0; font-size: .9rem; color: var(--text-muted); }
.timeline-item ul { margin-top: .3rem; }

/* ===== INNOVATION CARDS ===== */
.innovation-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(320px, 1fr)); gap: 1rem; margin: 1rem 0; }
.innovation-card {
  border: 1px solid var(--border); border-radius: var(--radius-lg); padding: 1.2rem;
  background: var(--bg-card); border-left: 4px solid var(--accent); box-shadow: var(--shadow);
}
.innovation-card h4 { margin: 0 0 .4rem; font-size: 1rem; }
.innovation-card .impact { font-size: .78rem; margin-top: .5rem; }
.innovation-card .impact span { font-weight: 700; }

/* ===== ADOPTION MATRIX ===== */
.adoption-row { display: flex; align-items: center; gap: .8rem; padding: .4rem 0; border-bottom: 1px solid var(--border); }
.adoption-row .concept { flex: 0 0 200px; font-weight: 600; font-size: .88rem; }
.adoption-row .ratio { flex: 0 0 70px; text-align: right; font-size: .88rem; }

/* ===== PRINT ===== */
@media print {
  .sidebar { display: none; }
  .main { margin-left: 0; padding: 1rem; max-width: 100%; }
  details { break-inside: avoid; }
  details[open] summary ~ * { display: block !important; }
  .card, details { box-shadow: none; border: 1px solid #ccc; }
  table { font-size: .8rem; }
}

/* ===== RESPONSIVE ===== */
@media (max-width: 900px) {
  .sidebar { display: none; }
  .main { margin-left: 0; padding: 1.5rem; }
  .stats-grid { grid-template-columns: repeat(2, 1fr); }
}
</style>
</head>
<body>

<!-- ==================== SIDEBAR ==================== -->
<aside class="sidebar">
  <div class="logo">
    <span>ğŸ  Assistant Matanne</span>
    <small>Rapport d'audit complet â€” FÃ©v. 2026</small>
  </div>
  <nav>
    <a href="#executive" style="font-weight:700;color:#fff;">ğŸ“Š Tableau de bord</a>
    <a class="section-title">ANALYSE PAR DOSSIER</a>
    <a href="#core">ğŸ§± src/core/ <span class="nav-badge" style="background:#10b981;color:#fff;">8.1</span></a>
    <a href="#core-ai">&nbsp;&nbsp;â†³ ai/</a>
    <a href="#core-caching">&nbsp;&nbsp;â†³ caching/</a>
    <a href="#core-config">&nbsp;&nbsp;â†³ config/</a>
    <a href="#core-db">&nbsp;&nbsp;â†³ db/</a>
    <a href="#core-decorators">&nbsp;&nbsp;â†³ decorators/</a>
    <a href="#core-models">&nbsp;&nbsp;â†³ models/</a>
    <a href="#core-state">&nbsp;&nbsp;â†³ state/</a>
    <a href="#core-validation">&nbsp;&nbsp;â†³ validation/</a>
    <a href="#core-monitoring">&nbsp;&nbsp;â†³ monitoring/</a>
    <a href="#core-resilience">&nbsp;&nbsp;â†³ resilience/</a>
    <a href="#core-observability">&nbsp;&nbsp;â†³ observability/</a>
    <a href="#core-dateutils">&nbsp;&nbsp;â†³ date_utils/</a>
    <a href="#core-root">&nbsp;&nbsp;â†³ fichiers racine</a>
    <a href="#services">âš™ï¸ src/services/ <span class="nav-badge" style="background:#f59e0b;color:#fff;">7.4</span></a>
    <a href="#svc-core">&nbsp;&nbsp;â†³ core/</a>
    <a href="#svc-cuisine">&nbsp;&nbsp;â†³ cuisine/</a>
    <a href="#svc-famille">&nbsp;&nbsp;â†³ famille/</a>
    <a href="#svc-inventaire">&nbsp;&nbsp;â†³ inventaire/</a>
    <a href="#svc-integrations">&nbsp;&nbsp;â†³ integrations/</a>
    <a href="#svc-maison">&nbsp;&nbsp;â†³ maison/</a>
    <a href="#svc-jeux">&nbsp;&nbsp;â†³ jeux/</a>
    <a href="#svc-rapports">&nbsp;&nbsp;â†³ rapports/</a>
    <a href="#modules">ğŸ“¦ src/modules/ <span class="nav-badge" style="background:#f59e0b;color:#fff;">7.2</span></a>
    <a href="#mod-accueil">&nbsp;&nbsp;â†³ accueil/</a>
    <a href="#mod-cuisine">&nbsp;&nbsp;â†³ cuisine/</a>
    <a href="#mod-famille">&nbsp;&nbsp;â†³ famille/</a>
    <a href="#mod-maison">&nbsp;&nbsp;â†³ maison/</a>
    <a href="#mod-jeux">&nbsp;&nbsp;â†³ jeux/</a>
    <a href="#mod-planning">&nbsp;&nbsp;â†³ planning/</a>
    <a href="#mod-parametres">&nbsp;&nbsp;â†³ parametres/</a>
    <a href="#mod-utilitaires">&nbsp;&nbsp;â†³ utilitaires/</a>
    <a href="#mod-framework">&nbsp;&nbsp;â†³ _framework/</a>
    <a href="#ui">ğŸ¨ src/ui/ <span class="nav-badge" style="background:#10b981;color:#fff;">8.7</span></a>
    <a href="#api">ğŸŒ src/api/ <span class="nav-badge" style="background:#10b981;color:#fff;">8.2</span></a>
    <a href="#app">ğŸš€ app.py <span class="nav-badge" style="background:#10b981;color:#fff;">8.0</span></a>
    <a class="section-title">SYNTHÃˆSE</a>
    <a href="#adoption">ğŸ” Adoption des concepts</a>
    <a href="#issues">ğŸ› ProblÃ¨mes critiques</a>
    <a href="#innovations">ğŸ’¡ AmÃ©liorations innovantes</a>
    <a href="#roadmap">ğŸ—ºï¸ Roadmap</a>
  </nav>
</aside>

<!-- ==================== MAIN CONTENT ==================== -->
<div class="main">

<!-- ==================== SECTION 0: EXECUTIVE DASHBOARD ==================== -->
<section id="executive">
<h1>ğŸ  Rapport d'Audit Complet</h1>
<p style="color:var(--text-muted);margin-bottom:1.5rem;">Assistant Matanne â€” Application Streamlit de gestion familiale &bull; AnalysÃ© le 23 fÃ©vrier 2026</p>

<div class="stats-grid">
  <div class="stat-card"><div class="stat-value" style="color:var(--accent);">570</div><div class="stat-label">Fichiers Python</div></div>
  <div class="stat-card"><div class="stat-value" style="color:var(--accent);">94 104</div><div class="stat-label">Lignes de code</div></div>
  <div class="stat-card"><div class="stat-value" style="color:var(--accent);">100+</div><div class="stat-label">ModÃ¨les ORM</div></div>
  <div class="stat-card"><div class="stat-value" style="color:var(--accent);">47</div><div class="stat-label">Services enregistrÃ©s</div></div>
  <div class="stat-card"><div class="stat-value" style="color:var(--accent);">33</div><div class="stat-label">Modules app()</div></div>
  <div class="stat-card"><div class="stat-value" style="color:var(--accent);">22</div><div class="stat-label">Endpoints API</div></div>
</div>

<h3>Scores de maturitÃ© par dimension</h3>
<div class="radar-container">
  <div class="radar-item">
    <div class="label"><strong>ğŸ—ï¸ Architecture</strong> <span class="score score-green">9/10</span></div>
    <div class="progress-bar"><div class="progress-fill progress-green" style="width:90%"></div></div>
  </div>
  <div class="radar-item">
    <div class="label"><strong>ğŸ“ QualitÃ© du code</strong> <span class="score score-green">8/10</span></div>
    <div class="progress-bar"><div class="progress-fill progress-green" style="width:80%"></div></div>
  </div>
  <div class="radar-item">
    <div class="label"><strong>ğŸ§ª Tests</strong> <span class="score score-yellow">6/10</span></div>
    <div class="progress-bar"><div class="progress-fill progress-yellow" style="width:60%"></div></div>
  </div>
  <div class="radar-item">
    <div class="label"><strong>ğŸ”’ SÃ©curitÃ©</strong> <span class="score score-yellow">7/10</span></div>
    <div class="progress-bar"><div class="progress-fill progress-yellow" style="width:70%"></div></div>
  </div>
  <div class="radar-item">
    <div class="label"><strong>âš¡ Performance</strong> <span class="score score-green">8/10</span></div>
    <div class="progress-bar"><div class="progress-fill progress-green" style="width:80%"></div></div>
  </div>
  <div class="radar-item">
    <div class="label"><strong>ğŸ“¡ ObservabilitÃ©</strong> <span class="score score-green">8/10</span></div>
    <div class="progress-bar"><div class="progress-fill progress-green" style="width:80%"></div></div>
  </div>
  <div class="radar-item">
    <div class="label"><strong>ğŸ¨ UX / Design System</strong> <span class="score score-green">9/10</span></div>
    <div class="progress-bar"><div class="progress-fill progress-green" style="width:90%"></div></div>
  </div>
  <div class="radar-item">
    <div class="label"><strong>ğŸ“– Documentation</strong> <span class="score score-yellow">7/10</span></div>
    <div class="progress-bar"><div class="progress-fill progress-yellow" style="width:70%"></div></div>
  </div>
</div>

<div class="card" style="border-left:4px solid var(--accent);">
  <h3>Verdict</h3>
  <p>Projet <strong>remarquablement mature</strong> avec une architecture professionnelle (circuit breaker, event bus, cache multi-niveaux, design system complet, PEP 562 lazy loading). Le principal axe d'amÃ©lioration est <strong>l'adoption des concepts</strong> : beaucoup d'infrastructures avancÃ©es dans <code>core/</code> ne sont pas encore utilisÃ©es dans les modules et services. L'objectif de cette roadmap est de combler cet Ã©cart sans supprimer de code.</p>
</div>
</section>

<!-- ==================== SECTION 1: src/core/ ==================== -->
<section id="core">
<h2>ğŸ§± src/core/ â€” Noyau applicatif</h2>
<div class="stats-grid">
  <div class="stat-card"><div class="stat-value" style="color:var(--green);">86</div><div class="stat-label">Fichiers</div></div>
  <div class="stat-card"><div class="stat-value" style="color:var(--green);">13 288</div><div class="stat-label">Lignes</div></div>
  <div class="stat-card"><div class="stat-value" style="color:var(--green);">12</div><div class="stat-label">Sous-packages</div></div>
  <div class="stat-card"><div class="stat-value" style="color:var(--green);">8.1</div><div class="stat-label">Score /10</div></div>
</div>

<!-- AI -->
<div id="core-ai">
<details open>
<summary>ğŸ¤– core/ai/ â€” Client IA, Parser, Cache, Rate Limiting, Circuit Breaker <span class="badge badge-green">9/10</span></summary>
<div>
<table>
<tr><th>Fichier</th><th>Lignes</th><th>Exports clÃ©s</th><th>Type Hints</th><th>Docstrings</th></tr>
<tr><td><code>client.py</code></td><td class="align-right">543</td><td><code>ClientIA</code>, <code>obtenir_client_ia</code></td><td><span class="check">â˜…â˜…â˜…</span></td><td><span class="check">â˜…â˜…â˜…</span></td></tr>
<tr><td><code>parser.py</code></td><td class="align-right">300</td><td><code>AnalyseurIA</code>, <code>analyser_liste_reponse</code></td><td><span class="check">â˜…â˜…â˜…</span></td><td><span class="check">â˜…â˜…â˜…</span></td></tr>
<tr><td><code>cache.py</code></td><td class="align-right">259</td><td><code>CacheIA</code>, <code>afficher_statistiques_cache_ia</code></td><td><span class="check">â˜…â˜…â˜…</span></td><td><span class="check">â˜…â˜…â˜†</span></td></tr>
<tr><td><code>rate_limit.py</code></td><td class="align-right">170</td><td><code>RateLimitIA</code>, <code>LimiteDebit</code></td><td><span class="check">â˜…â˜…â˜…</span></td><td><span class="check">â˜…â˜…â˜…</span></td></tr>
<tr><td><code>circuit_breaker.py</code></td><td class="align-right">280</td><td><code>CircuitBreaker</code>, <code>EtatCircuit</code>, <code>avec_circuit_breaker</code></td><td><span class="check">â˜…â˜…â˜…</span></td><td><span class="check">â˜…â˜…â˜…</span></td></tr>
</table>
<p><strong>Total : ~6 fichiers, ~1 583 lignes</strong></p>

<h4>Patterns de design</h4>
<ul>
<li><strong>Lazy Singleton</strong> : <code>obtenir_client_ia()</code> avec verrou thread</li>
<li><strong>Strategy Pattern</strong> : <code>AnalyseurIA.analyser()</code> utilise 5 stratÃ©gies de parsing ordonnÃ©es (direct â†’ regex â†’ repair â†’ partial â†’ fallback)</li>
<li><strong>Circuit Breaker</strong> : Machine d'Ã©tats complÃ¨te (CLOSED â†’ OPEN â†’ HALF_OPEN) thread-safe</li>
<li><strong>Decorator</strong> : <code>@avec_circuit_breaker</code> encapsule transparemment les appels</li>
</ul>

<h4>ProblÃ¨mes identifiÃ©s</h4>
<ul>
<li><span class="tag tag-high">High</span> <code>@avec_circuit_breaker</code> ne supporte pas les fonctions async â€” le wrapper appelle <code>func(*args)</code> de maniÃ¨re synchrone malgrÃ© la doc montrant <code>async def</code></li>
<li><span class="tag tag-medium">Medium</span> <code>client.py</code> : <code>import os</code> inline dans <code>_ensure_config_loaded()</code> â€” devrait Ãªtre au niveau module</li>
<li><span class="tag tag-low">Low</span> <code>LimiteDebit</code> alias exportÃ© mais jamais utilisÃ© dans la codebase</li>
<li><span class="tag tag-low">Low</span> <code>cache.py</code> : paramÃ¨tre <code>ttl</code> acceptÃ© mais ignorÃ© sur <code>obtenir()</code></li>
</ul>
</div>
</details>
</div>

<!-- CACHING -->
<div id="core-caching">
<details>
<summary>ğŸ’¾ core/caching/ â€” Cache multi-niveaux (L1/L2/L3) <span class="badge badge-yellow">7/10</span></summary>
<div>
<table>
<tr><th>Fichier</th><th>Lignes</th><th>Exports clÃ©s</th></tr>
<tr><td><code>base.py</code></td><td class="align-right">63</td><td><code>EntreeCache</code>, <code>StatistiquesCache</code></td></tr>
<tr><td><code>cache.py</code></td><td class="align-right">190</td><td><code>Cache</code> (faÃ§ade statique)</td></tr>
<tr><td><code>memory.py</code></td><td class="align-right">120</td><td><code>CacheMemoireN1</code> (LRU <code>OrderedDict</code>)</td></tr>
<tr><td><code>session.py</code></td><td class="align-right">110</td><td><code>CacheSessionN2</code> (Streamlit session)</td></tr>
<tr><td><code>file.py</code></td><td class="align-right">190</td><td><code>CacheFichierN3</code> (JSON files)</td></tr>
<tr><td><code>orchestrator.py</code></td><td class="align-right">265</td><td><code>CacheMultiNiveau</code>, <code>obtenir_cache</code>, <code>reinitialiser_cache</code></td></tr>
</table>
<p><strong>Total : 7 fichiers, ~979 lignes</strong></p>

<h4>Patterns de design</h4>
<ul>
<li><strong>Multi-Level Cache</strong> : L1 mÃ©moire (O(1) LRU) â†’ L2 session Streamlit â†’ L3 fichiers JSON</li>
<li><strong>Promotion</strong> : lectures depuis niveaux infÃ©rieurs promues vers les niveaux supÃ©rieurs</li>
<li><strong>Singleton Factory</strong> : <code>obtenir_cache()</code> avec double-check locking</li>
<li><strong>SÃ©curitÃ©</strong> : L3 utilise JSON (pas pickle) â€” pas de risque d'exÃ©cution de code arbitraire</li>
</ul>

<h4>ProblÃ¨mes identifiÃ©s</h4>
<ul>
<li><span class="tag tag-critical">Critical</span> Le dÃ©corateur <code>@avec_cache</code> (dans <code>decorators/cache.py</code>) crÃ©e un <strong>nouveau <code>CacheMultiNiveau()</code></strong> Ã  chaque appel au lieu d'utiliser <code>obtenir_cache()</code>. RÃ©sultat : <strong>chaque fonction cachÃ©e a son propre cache vide</strong> â€” aucun cache hit ne se produira jamais.</li>
<li><span class="tag tag-medium">Medium</span> L'invalidation par pattern au niveau L3 ne fonctionne pas car les noms de fichiers sont des hash MD5</li>
<li><span class="tag tag-medium">Medium</span> <code>max_size_bytes</code> sur L1 est configurÃ© mais jamais vÃ©rifiÃ©</li>
</ul>
</div>
</details>
</div>

<!-- CONFIG -->
<div id="core-config">
<details>
<summary>âš™ï¸ core/config/ â€” Configuration Pydantic BaseSettings <span class="badge badge-green">8/10</span></summary>
<div>
<table>
<tr><th>Fichier</th><th>Lignes</th><th>Exports clÃ©s</th></tr>
<tr><td><code>settings.py</code></td><td class="align-right">431</td><td><code>Parametres</code>, <code>obtenir_parametres</code>, <code>reinitialiser_parametres</code></td></tr>
<tr><td><code>loader.py</code></td><td class="align-right">170</td><td><code>charger_secrets_streamlit</code>, <code>_is_streamlit_cloud</code></td></tr>
<tr><td><code>validator.py</code></td><td class="align-right">280</td><td><code>ValidateurConfiguration</code>, <code>RapportValidation</code></td></tr>
</table>
<p><strong>Total : 4 fichiers, ~901 lignes</strong></p>

<h4>Points forts</h4>
<ul>
<li>Pydantic v2 <code>BaseSettings</code> avec <code>@property</code> cascading (st.secrets â†’ env â†’ .env â†’ defaults)</li>
<li>Builder pattern fluide sur <code>ValidateurConfiguration</code></li>
<li>SÃ©curitÃ© : les secrets ne sont jamais exposÃ©s dans les logs</li>
</ul>

<h4>ProblÃ¨mes</h4>
<ul>
<li><span class="tag tag-low">Low</span> <code>FOOTBALL_DATA_API_KEY</code> et Google Calendar : blocs try/except redondants</li>
<li><span class="tag tag-low">Low</span> <code>_is_streamlit_cloud()</code> retourne toujours <code>False</code> pour le check <code>st.secrets</code></li>
</ul>
</div>
</details>
</div>

<!-- DB -->
<div id="core-db">
<details>
<summary>ğŸ—„ï¸ core/db/ â€” Moteur, Sessions, Migrations <span class="badge badge-green">8/10</span></summary>
<div>
<table>
<tr><th>Fichier</th><th>Lignes</th><th>Exports clÃ©s</th></tr>
<tr><td><code>engine.py</code></td><td class="align-right">145</td><td><code>obtenir_moteur</code>, <code>obtenir_moteur_securise</code></td></tr>
<tr><td><code>session.py</code></td><td class="align-right">130</td><td><code>obtenir_fabrique_session</code>, <code>obtenir_contexte_db</code></td></tr>
<tr><td><code>migrations.py</code></td><td class="align-right">314</td><td><code>GestionnaireMigrations</code></td></tr>
<tr><td><code>utils.py</code></td><td class="align-right">228</td><td><code>verifier_connexion</code>, <code>initialiser_database</code>, <code>vacuum_database</code></td></tr>
</table>
<p><strong>Total : 5 fichiers, ~860 lignes</strong></p>

<h4>Points forts</h4>
<ul>
<li>Thread-safe singleton avec double-check locking</li>
<li>Context manager <code>obtenir_contexte_db()</code> avec rollback/commit/close</li>
<li>Migrations SQL-file avec vÃ©rification SHA-256</li>
<li>Pool <code>QueuePool</code> avec <code>pool_pre_ping=True</code></li>
</ul>

<h4>ProblÃ¨mes</h4>
<ul>
<li><span class="tag tag-medium">Medium</span> <code>obtenir_contexte_db()</code> auto-commit en sortie â€” non conventionnel, pourrait causer des problÃ¨mes avec des context managers imbriquÃ©s</li>
<li><span class="tag tag-low">Low</span> <code>creer_toutes_tables()</code> risque d'import circulaire (models â†’ base â†’ db)</li>
</ul>
</div>
</details>
</div>

<!-- DECORATORS -->
<div id="core-decorators">
<details>
<summary>ğŸ¯ core/decorators/ â€” DÃ©corateurs unifiÃ©s <span class="badge badge-yellow">7/10</span></summary>
<div>
<table>
<tr><th>Fichier</th><th>Lignes</th><th>Exports clÃ©s</th></tr>
<tr><td><code>cache.py</code></td><td class="align-right">173</td><td><code>avec_cache</code>, <code>cache_ui</code></td></tr>
<tr><td><code>db.py</code></td><td class="align-right">60</td><td><code>avec_session_db</code></td></tr>
<tr><td><code>errors.py</code></td><td class="align-right">162</td><td><code>avec_gestion_erreurs</code></td></tr>
<tr><td><code>validation.py</code></td><td class="align-right">195</td><td><code>avec_validation</code>, <code>avec_resilience</code></td></tr>
</table>
<p><strong>Total : 5 fichiers, ~611 lignes</strong></p>

<h4>Points forts</h4>
<ul>
<li>Tous utilisent <code>functools.wraps</code> pour prÃ©server les mÃ©tadonnÃ©es</li>
<li>Signatures prÃ©-calculÃ©es Ã  la dÃ©coration (pas par appel)</li>
<li><code>avec_resilience</code> compose <code>RetryPolicy + TimeoutPolicy + CircuitBreaker</code></li>
</ul>

<h4>ProblÃ¨mes</h4>
<ul>
<li><span class="tag tag-critical">Critical</span> <code>avec_cache</code> crÃ©e <code>CacheMultiNiveau()</code> (orphelin) au lieu de <code>obtenir_cache()</code> â€” <strong>le cache via dÃ©corateur est cassÃ©</strong></li>
<li><span class="tag tag-medium">Medium</span> <code>avec_session_db</code> ne gÃ¨re pas le paramÃ¨tre <code>db</code> positionnel (uniquement kwargs)</li>
<li><span class="tag tag-low">Low</span> <code>field_mapping</code> pourrait Ãªtre <code>None</code> dans <code>avec_validation</code></li>
</ul>
</div>
</details>
</div>

<!-- MODELS -->
<div id="core-models">
<details>
<summary>ğŸ“Š core/models/ â€” ModÃ¨les SQLAlchemy ORM (19 fichiers) <span class="badge badge-green">9/10</span></summary>
<div>
<table>
<tr><th>Fichier</th><th>Lignes</th><th>ModÃ¨les clÃ©s</th></tr>
<tr><td><code>base.py</code></td><td class="align-right">82</td><td><code>Base</code>, <code>metadata</code>, enums globaux</td></tr>
<tr><td><code>recettes.py</code></td><td class="align-right">429</td><td><code>Recette</code>, <code>Ingredient</code>, <code>RecetteIngredient</code>, <code>EtapeRecette</code>, <code>BatchMeal</code></td></tr>
<tr><td><code>planning.py</code></td><td class="align-right">256</td><td><code>Planning</code>, <code>Repas</code>, <code>CalendarEvent</code>, <code>TemplateSemaine</code></td></tr>
<tr><td><code>famille.py</code></td><td class="align-right">266</td><td><code>ChildProfile</code>, <code>WellbeingEntry</code>, <code>Milestone</code>, <code>FamilyActivity</code></td></tr>
<tr><td><code>courses.py</code></td><td class="align-right">200</td><td><code>ListeCourses</code>, <code>ArticleCourses</code>, <code>ModeleCourses</code></td></tr>
<tr><td><code>inventaire.py</code></td><td class="align-right">100</td><td><code>ArticleInventaire</code>, <code>HistoriqueInventaire</code></td></tr>
<tr><td><code>sante.py</code></td><td class="align-right">150</td><td><code>HealthRoutine</code>, <code>HealthEntry</code>, <code>HealthObjective</code></td></tr>
<tr><td><code>finances.py</code></td><td class="align-right">200</td><td><code>Depense</code>, <code>HouseExpense</code>, <code>BudgetMensuelDB</code></td></tr>
<tr><td><code>habitat.py</code></td><td class="align-right">200</td><td><code>Furniture</code>, <code>MaintenanceTask</code>, <code>HouseStock</code></td></tr>
<tr><td><code>maison.py</code></td><td class="align-right">200</td><td><code>Project</code>, <code>Routine</code>, <code>GardenItem</code></td></tr>
<tr><td><code>jeux.py</code></td><td class="align-right">300</td><td>18 classes : <code>GrilleLoto</code>, <code>PariSportif</code>, <code>Match</code>, etc.</td></tr>
<tr><td><code>batch_cooking.py</code></td><td class="align-right">200</td><td><code>SessionBatchCooking</code>, <code>PreparationBatch</code></td></tr>
<tr><td><code>+ 7 autres</code></td><td class="align-right">~870</td><td>calendrier, jardin, notifications, systeme, users, user_preferences, temps_entretien</td></tr>
</table>
<p><strong>Total : 20 fichiers, ~3 900+ lignes, ~100+ modÃ¨les</strong></p>

<h4>Points forts</h4>
<ul>
<li>SQLAlchemy 2.0 ORM moderne : <code>Mapped[T]</code> et <code>mapped_column()</code> partout</li>
<li>PEP 562 lazy loading dans <code>__init__.py</code> pour ~100 symboles</li>
<li>Tous les enums hÃ©ritent de <code>enum.StrEnum</code> (Python 3.11+)</li>
<li>Contraintes nommÃ©es via convention <code>MetaData(naming_convention=...)</code></li>
<li>Relations bidirectionnelles avec <code>back_populates</code></li>
</ul>

<h4>Observations</h4>
<ul>
<li><span class="tag tag-info">Info</span> Nommage mixte anglais/franÃ§ais (<code>ChildProfile</code> vs <code>Recette</code>) â€” fonctionnel mais inconsistant</li>
<li><span class="tag tag-low">Low</span> <code>Optional</code> importÃ© de typing dans certains fichiers â€” inutile en Python 3.11+ (utiliser <code>X | None</code>)</li>
</ul>
</div>
</details>
</div>

<!-- STATE -->
<div id="core-state">
<details>
<summary>ğŸ”€ core/state/ â€” Gestion d'Ã©tat applicatif <span class="badge badge-green">8/10</span></summary>
<div>
<table>
<tr><th>Fichier</th><th>Lignes</th><th>Exports clÃ©s</th></tr>
<tr><td><code>manager.py</code></td><td class="align-right">285</td><td><code>GestionnaireEtat</code> (mÃ©thodes statiques)</td></tr>
<tr><td><code>shortcuts.py</code></td><td class="align-right">60</td><td><code>obtenir_etat</code>, <code>naviguer</code>, <code>revenir</code>, <code>est_mode_debug</code></td></tr>
<tr><td><code>slices.py</code></td><td class="align-right">347</td><td><code>EtatNavigation</code>, <code>EtatCuisine</code>, <code>EtatUI</code>, <code>EtatApp</code></td></tr>
</table>
<p><strong>Total : 4 fichiers, ~747 lignes</strong></p>

<h4>Points forts</h4>
<ul>
<li><strong>State Slices</strong> par domaine (Navigation, Cuisine, UI)</li>
<li>DÃ©couplage via Protocol <code>SessionStorage</code> â€” pas d'accÃ¨s direct Ã  <code>st.session_state</code></li>
<li>Navigation breadcrumb avec historique des 5 derniÃ¨res pages</li>
<li><code>naviguer()</code> dÃ©clenche <code>st.rerun</code> via callback dÃ©couplÃ©</li>
</ul>
</div>
</details>
</div>

<!-- VALIDATION -->
<div id="core-validation">
<details>
<summary>âœ… core/validation/ â€” Validation et sanitisation <span class="badge badge-yellow">7/10</span></summary>
<div>
<table>
<tr><th>Fichier</th><th>Lignes</th><th>Exports clÃ©s</th></tr>
<tr><td><code>sanitizer.py</code></td><td class="align-right">250</td><td><code>NettoyeurEntrees</code> (anti-XSS/injection)</td></tr>
<tr><td><code>validators.py</code></td><td class="align-right">231</td><td><code>valider_modele</code>, <code>valider_formulaire_streamlit</code>, <code>valider_et_nettoyer_formulaire</code></td></tr>
<tr><td><code>schemas/</code> (7 fichiers)</td><td class="align-right">~460</td><td><code>RecetteInput</code>, <code>ArticleInventaireInput</code>, <code>ArticleCoursesInput</code>, <code>RepasInput</code>, <code>RoutineInput</code>, <code>ProjetInput</code></td></tr>
</table>
<p><strong>Total : 11 fichiers, ~1 042 lignes</strong></p>

<h4>ProblÃ¨mes</h4>
<ul>
<li><span class="tag tag-medium">Medium</span> Double approche validation (dict schemas legacy + Pydantic) â€” charge de maintenance</li>
<li><span class="tag tag-low">Low</span> DÃ©corateur <code>valider_entree</code> incomplet dans la fonction wrapper</li>
</ul>
</div>
</details>
</div>

<!-- MONITORING -->
<div id="core-monitoring">
<details>
<summary>ğŸ“¡ core/monitoring/ â€” MÃ©triques et santÃ© systÃ¨me <span class="badge badge-green">8/10</span></summary>
<div>
<table>
<tr><th>Fichier</th><th>Lignes</th><th>Exports clÃ©s</th></tr>
<tr><td><code>collector.py</code></td><td class="align-right">301</td><td><code>CollecteurMetriques</code>, <code>enregistrer_metrique</code>, <code>obtenir_snapshot</code></td></tr>
<tr><td><code>decorators.py</code></td><td class="align-right">120</td><td><code>chronometre</code>, <code>chronometre_async</code></td></tr>
<tr><td><code>health.py</code></td><td class="align-right">368</td><td><code>SanteSysteme</code>, <code>verifier_liveness</code>, <code>verifier_readiness</code>, <code>verifier_sante_globale</code></td></tr>
<tr><td><code>rerun_profiler.py</code></td><td class="align-right">229</td><td><code>RerunProfiler</code>, <code>profiler_rerun</code>, <code>obtenir_stats_rerun</code></td></tr>
</table>
<p><strong>Total : 5 fichiers, ~1 090 lignes</strong></p>

<h4>Points forts</h4>
<ul>
<li>3 types de mÃ©triques : COMPTEUR, JAUGE, HISTOGRAMME avec fenÃªtre glissante</li>
<li>Health checks Kubernetes-style (Liveness, Readiness, Startup)</li>
<li><code>RerunProfiler</code> spÃ©cifique Streamlit â€” suivi des changements <code>session_state</code></li>
</ul>

<h4>ProblÃ¨mes</h4>
<ul>
<li><span class="tag tag-medium">Medium</span> <code>_verifier_cache()</code> dans health.py crÃ©e un nouveau <code>CacheMultiNiveau()</code> au lieu du singleton â€” health checks voient toujours un cache vide</li>
</ul>
</div>
</details>
</div>

<!-- RESILIENCE -->
<div id="core-resilience">
<details>
<summary>ğŸ›¡ï¸ core/resilience/ â€” Politiques de rÃ©silience composables <span class="badge badge-green">8/10</span></summary>
<div>
<table>
<tr><th>Fichier</th><th>Lignes</th><th>Exports clÃ©s</th></tr>
<tr><td><code>policies.py</code></td><td class="align-right">320</td><td><code>Policy</code>, <code>RetryPolicy</code>, <code>TimeoutPolicy</code>, <code>BulkheadPolicy</code>, <code>FallbackPolicy</code>, <code>PolicyComposee</code></td></tr>
</table>
<p><strong>Total : 2 fichiers, ~367 lignes</strong></p>

<h4>Points forts</h4>
<ul>
<li><strong>OpÃ©rateur <code>+</code></strong> pour composer les politiques : <code>TimeoutPolicy(30) + RetryPolicy(3)</code></li>
<li>ModÃ¨le oignon : <code>PolicyComposee</code> encapsule de l'intÃ©rieur vers l'extÃ©rieur</li>
<li>Factories prÃ©-configurÃ©es : <code>politique_ia()</code>, <code>politique_api_externe()</code>, <code>politique_cache()</code></li>
</ul>

<h4>ProblÃ¨mes</h4>
<ul>
<li><span class="tag tag-high">High</span> <code>PolicyComposee.__add__</code> et <code>__repr__</code> sont du dead code (mauvaise indentation â€” dÃ©finis hors du corps de la classe aprÃ¨s une fonction standalone)</li>
<li><span class="tag tag-low">Low</span> <code>_TIMEOUT_EXECUTOR</code> jamais nettoyÃ© Ã  l'arrÃªt â€” devrait utiliser <code>atexit</code></li>
</ul>
</div>
</details>
</div>

<!-- OBSERVABILITY -->
<div id="core-observability">
<details>
<summary>ğŸ”­ core/observability/ â€” Contexte d'exÃ©cution et corrÃ©lation <span class="badge badge-green">9/10</span></summary>
<div>
<table>
<tr><th>Fichier</th><th>Lignes</th><th>Exports clÃ©s</th></tr>
<tr><td><code>context.py</code></td><td class="align-right">243</td><td><code>ContexteExecution</code>, <code>contexte_operation</code>, <code>FiltreCorrelation</code></td></tr>
</table>
<p><strong>Total : 2 fichiers, ~281 lignes</strong></p>

<h4>Points forts</h4>
<ul>
<li>Utilise <code>contextvars.ContextVar</code> (thread-safe + async-safe)</li>
<li>Context manager hiÃ©rarchique avec suivi parent</li>
<li><code>FiltreCorrelation</code> injecte <code>correlation_id</code> dans tous les logs</li>
</ul>
<p><span class="tag tag-low">Info</span> Module le plus propre de la codebase â€” aucun problÃ¨me identifiÃ©</p>
</div>
</details>
</div>

<!-- DATE_UTILS -->
<div id="core-dateutils">
<details>
<summary>ğŸ“… core/date_utils/ â€” Utilitaires de dates <span class="badge badge-green">10/10</span></summary>
<div>
<table>
<tr><th>Fichier</th><th>Lignes</th><th>Exports clÃ©s</th></tr>
<tr><td><code>semaines.py</code></td><td class="align-right">110</td><td><code>obtenir_debut_semaine</code>, <code>semaines_entre</code></td></tr>
<tr><td><code>periodes.py</code></td><td class="align-right">85</td><td><code>obtenir_bornes_mois</code>, <code>plage_dates</code>, <code>ajouter_jours_ouvres</code></td></tr>
<tr><td><code>formatage.py</code></td><td class="align-right">110</td><td><code>formater_date_fr</code>, <code>formater_jour_fr</code>, <code>formater_mois_fr</code></td></tr>
<tr><td><code>helpers.py</code></td><td class="align-right">72</td><td><code>est_weekend</code>, <code>est_aujourd_hui</code>, <code>get_weekday_names</code></td></tr>
</table>
<p><strong>Total : 5 fichiers, ~440 lignes</strong></p>

<h4>Points forts</h4>
<ul>
<li>Fonctions pures â€” aucun Ã©tat, aucun effet de bord</li>
<li>ZÃ©ro import Streamlit â€” entiÃ¨rement testable</li>
<li>Type hints et docstrings excellents avec exemples</li>
</ul>
<p><strong>Module de la plus haute qualitÃ© dans toute la codebase.</strong></p>
</div>
</details>
</div>

<!-- ROOT FILES -->
<div id="core-root">
<details>
<summary>ğŸ“ core/ â€” Fichiers racine <span class="badge badge-green">8/10</span></summary>
<div>
<table>
<tr><th>Fichier</th><th>Lignes</th><th>RÃ´le</th></tr>
<tr><td><code>__init__.py</code></td><td class="align-right">177</td><td>PEP 562 lazy loading (~100 symboles)</td></tr>
<tr><td><code>bootstrap.py</code></td><td class="align-right">150</td><td>Initialisation app, config, atexit cleanup</td></tr>
<tr><td><code>constants.py</code></td><td class="align-right">210</td><td>Constantes centralisÃ©es (pas de magic numbers)</td></tr>
<tr><td><code>errors.py</code></td><td class="align-right">210</td><td>Gestion erreurs UI-aware</td></tr>
<tr><td><code>errors_base.py</code></td><td class="align-right">417</td><td>HiÃ©rarchie exceptions : <code>ExceptionApp</code> â†’ 7 types</td></tr>
<tr><td><code>lazy_loader.py</code></td><td class="align-right">372</td><td><code>ChargeurModuleDiffere</code>, <code>RouteurOptimise</code> + <code>MODULE_REGISTRY</code></td></tr>
<tr><td><code>logging.py</code></td><td class="align-right">359</td><td>Console colorÃ©e, JSON structurÃ©, filtre secrets</td></tr>
<tr><td><code>session_keys.py</code></td><td class="align-right">211</td><td><code>SK</code> namespace pour toutes les clÃ©s session_state</td></tr>
<tr><td><code>storage.py</code></td><td class="align-right">210</td><td><code>SessionStorage</code> protocol, <code>StreamlitSessionStorage</code></td></tr>
<tr><td><code>async_utils.py</code></td><td class="align-right">55</td><td><code>executer_async()</code> â€” pont asyncâ†’sync pour Streamlit</td></tr>
</table>
<p><strong>Total : 11 fichiers, ~2 371 lignes</strong></p>
</div>
</details>
</div>

</section>

<!-- ==================== SECTION 2: src/services/ ==================== -->
<section id="services">
<h2>âš™ï¸ src/services/ â€” Couche de services</h2>
<div class="stats-grid">
  <div class="stat-card"><div class="stat-value" style="color:var(--orange);">204</div><div class="stat-label">Fichiers</div></div>
  <div class="stat-card"><div class="stat-value" style="color:var(--orange);">41 222</div><div class="stat-label">Lignes</div></div>
  <div class="stat-card"><div class="stat-value" style="color:var(--orange);">47</div><div class="stat-label">@service_factory</div></div>
  <div class="stat-card"><div class="stat-value" style="color:var(--orange);">7.4</div><div class="stat-label">Score /10</div></div>
</div>

<!-- SVC-CORE -->
<div id="svc-core">
<details open>
<summary>ğŸ—ï¸ services/core/ â€” Infrastructure de base <span class="badge badge-green">9/10</span></summary>
<div>
<table>
<tr><th>Fichier</th><th>Lignes</th><th>RÃ´le</th><th>Score</th></tr>
<tr><td><code>registry.py</code></td><td class="align-right">457</td><td>Registre de services thread-safe + <code>@service_factory</code></td><td><span class="badge badge-green">9/10</span></td></tr>
<tr><td><code>base/ai_service.py</code></td><td class="align-right">400</td><td><code>BaseAIService</code> avec rate limiting, cache, circuit breaker</td><td><span class="badge badge-green">9/10</span></td></tr>
<tr><td><code>base/types.py</code></td><td class="align-right">216</td><td><code>BaseService[T]</code> gÃ©nÃ©rique avec CRUD + filtres avancÃ©s</td><td><span class="badge badge-green">8/10</span></td></tr>
<tr><td><code>base/protocols.py</code></td><td class="align-right">209</td><td>6 Protocols PEP 544 : CRUD, AI, IO, Cache, Health, Observable</td><td><span class="badge badge-green">9/10</span></td></tr>
<tr><td><code>base/advanced.py</code></td><td class="align-right">231</td><td><code>AdvancedQueryMixin</code> â€” full-text, bulk, stats</td><td><span class="badge badge-green">8/10</span></td></tr>
<tr><td><code>base/reactive.py</code></td><td class="align-right">360</td><td>Invalidation cache rÃ©active via Event Bus</td><td><span class="badge badge-green">8/10</span></td></tr>
<tr><td><code>base/ai_streaming.py</code></td><td class="align-right">130</td><td>Streaming IA (mixin)</td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>events/bus.py</code></td><td class="align-right">388</td><td>Event bus pub/sub avec wildcards et prioritÃ©s</td><td><span class="badge badge-green">9/10</span></td></tr>
<tr><td><code>events/events.py</code></td><td class="align-right">150</td><td>Types d'Ã©vÃ©nements domaine (immutables)</td><td><span class="badge badge-green">8/10</span></td></tr>
<tr><td><code>middleware/pipeline.py</code></td><td class="align-right">670</td><td>Pipeline middleware composable</td><td><span class="badge badge-yellow">N/A</span></td></tr>
</table>

<div class="card" style="border-left:4px solid var(--yellow);">
<h4>âš ï¸ Infrastructure non cÃ¢blÃ©e</h4>
<p><code>middleware/pipeline.py</code> (670 lignes) fournit une chaÃ®ne middleware composable (Logging â†’ RateLimit â†’ Cache â†’ ErrorHandler â†’ Session) avec presets â€” <strong>mais n'est utilisÃ©e nulle part en production</strong>. Marquer pour adoption en Phase 4.</p>
</div>

<h4>ProblÃ¨mes <code>ai_streaming.py</code></h4>
<ul>
<li><span class="tag tag-medium">Medium</span> <code>call_with_streaming_sync()</code> collecte TOUS les chunks avant de yield â€” ce n'est pas vraiment du streaming progressif</li>
</ul>
</div>
</details>
</div>

<!-- SVC-CUISINE -->
<div id="svc-cuisine">
<details>
<summary>ğŸ½ï¸ services/cuisine/ â€” Recettes, courses, planning, batch cooking <span class="badge badge-yellow">7.5/10</span></summary>
<div>
<table>
<tr><th>Service</th><th>Lignes</th><th>HÃ©ritage</th><th>@service_factory</th><th>DÃ©corateurs</th><th>Score</th></tr>
<tr><td><code>recettes/service.py</code></td><td class="align-right">643</td><td><code>BaseService + BaseAIService</code></td><td><span class="check">âœ…</span></td><td><span class="check">âœ…</span> les 3</td><td><span class="badge badge-green">8/10</span></td></tr>
<tr><td><code>recettes/importer.py</code></td><td class="align-right">432</td><td>Statique</td><td><span class="cross">âŒ</span></td><td><span class="cross">âŒ</span></td><td><span class="badge badge-red">5/10</span></td></tr>
<tr><td><code>recettes/import_url.py</code></td><td class="align-right">~300</td><td><code>BaseAIService</code></td><td><span class="check">âœ…</span></td><td><span class="check">âœ…</span></td><td><span class="badge badge-green">8/10</span></td></tr>
<tr><td><code>courses/service.py</code></td><td class="align-right">564</td><td><code>BaseService + BaseAIService</code></td><td><span class="check">âœ…</span></td><td><span class="check">âœ…</span> les 3</td><td><span class="badge badge-green">8/10</span></td></tr>
<tr><td><code>planning/service.py</code></td><td class="align-right">399</td><td><code>BaseService + BaseAIService</code></td><td><span class="check">âœ…</span></td><td><span class="check">âœ…</span></td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>planning/utils.py</code></td><td class="align-right">123</td><td>DÃ‰PRÃ‰CIÃ‰</td><td><span class="cross">âŒ</span></td><td><span class="cross">âŒ</span></td><td><span class="badge badge-red">3/10</span></td></tr>
<tr><td><code>suggestions/service.py</code></td><td class="align-right">~400</td><td><code>BaseAIService</code></td><td><span class="check">âœ…</span></td><td><span class="check">âœ…</span></td><td><span class="badge badge-green">8/10</span></td></tr>
<tr><td><code>batch_cooking/service.py</code></td><td class="align-right">~350</td><td><code>BaseService + BaseAIService</code></td><td><span class="check">âœ…</span></td><td><span class="check">âœ…</span></td><td><span class="badge badge-yellow">7/10</span></td></tr>
</table>

<h4>Duplications de code</h4>
<ul>
<li><span class="tag tag-high">High</span> Import URL dupliquÃ© entre <code>importer.py</code> (dÃ©prÃ©ciÃ©, 3 TODOs) et <code>import_url.py</code></li>
<li><span class="tag tag-medium">Medium</span> AgrÃ©gation ingrÃ©dients dupliquÃ©e entre <code>planning/service.py</code> et <code>planning/agregation.py</code></li>
</ul>
</div>
</details>
</div>

<!-- SVC-FAMILLE -->
<div id="svc-famille">
<details>
<summary>ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦ services/famille/ â€” Services famille <span class="badge badge-yellow">7/10</span></summary>
<div>
<table>
<tr><th>Service</th><th>Lignes</th><th>@service_factory</th><th>@avec_cache</th><th>@avec_gestion_erreurs</th><th>Score</th></tr>
<tr><td><code>jules_ai.py</code></td><td class="align-right">85</td><td><span class="cross">âŒ</span></td><td><span class="cross">âŒ</span></td><td><span class="cross">âŒ</span></td><td><span class="badge badge-yellow">6/10</span></td></tr>
<tr><td><code>weekend_ai.py</code></td><td class="align-right">75</td><td><span class="cross">âŒ</span></td><td><span class="cross">âŒ</span></td><td><span class="cross">âŒ</span></td><td><span class="badge badge-yellow">6/10</span></td></tr>
<tr><td><code>achats.py</code></td><td class="align-right">319</td><td><span class="check">âœ…</span></td><td><span class="cross">âŒ</span></td><td><span class="cross">âŒ</span></td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>activites.py</code></td><td class="align-right">175</td><td><span class="check">âœ…</span></td><td><span class="cross">âŒ</span></td><td><span class="cross">âŒ</span></td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>routines.py</code></td><td class="align-right">396</td><td><span class="check">âœ…</span></td><td><span class="cross">âŒ</span></td><td><span class="cross">âŒ</span></td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>sante.py</code></td><td class="align-right">350</td><td><span class="check">âœ…</span></td><td><span class="cross">âŒ</span></td><td><span class="cross">âŒ</span></td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>suivi_perso.py</code></td><td class="align-right">307</td><td><span class="check">âœ…</span></td><td><span class="cross">âŒ</span></td><td><span class="cross">âŒ</span></td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>jules.py</code></td><td class="align-right">161</td><td><span class="check">âœ…</span></td><td><span class="cross">âŒ</span></td><td><span class="cross">âŒ</span></td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>weekend.py</code></td><td class="align-right">342</td><td><span class="check">âœ…</span></td><td><span class="cross">âŒ</span></td><td><span class="cross">âŒ</span></td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>calendrier_planning.py</code></td><td class="align-right">365</td><td><span class="check">âœ…</span></td><td><span class="cross">âŒ</span></td><td><span class="cross">âŒ</span></td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>budget/service.py</code></td><td class="align-right">~400</td><td><span class="check">âœ…</span></td><td><span class="cross">âŒ</span></td><td><span class="cross">âŒ</span></td><td><span class="badge badge-yellow">7/10</span></td></tr>
</table>

<div class="card" style="border-left:4px solid var(--orange);">
<h4>Points d'attention famille</h4>
<ul>
<li><code>JulesAIService</code> et <code>WeekendAIService</code> crÃ©ent <code>ClientIA()</code> directement au lieu d'utiliser <code>obtenir_client_ia()</code></li>
<li>Aucun service famille n'utilise <code>@avec_cache</code> â€” les mÃ©thodes de lecture intensives ne sont pas cachÃ©es</li>
<li>Aucun service famille n'utilise <code>@avec_gestion_erreurs</code> â€” les exceptions remontent brutes</li>
<li><code>assert db is not None</code> utilisÃ© frÃ©quemment au lieu d'une gestion d'erreur propre</li>
<li>Points positifs : Event bus (<code>obtenir_bus().emettre()</code>) utilisÃ© dans les mutations, TypedDict pour les retours structurÃ©s</li>
</ul>
</div>
</div>
</details>
</div>

<!-- SVC-INVENTAIRE -->
<div id="svc-inventaire">
<details>
<summary>ğŸ“¦ services/inventaire/ â€” Gestion des stocks <span class="badge badge-green">8/10</span></summary>
<div>
<table>
<tr><th>Fichier</th><th>Lignes</th><th>RÃ´le</th></tr>
<tr><td><code>service.py</code></td><td class="align-right">220</td><td>Orchestrateur principal avec 6 mixins</td></tr>
<tr><td><code>inventaire_io.py</code></td><td class="align-right">~200</td><td>Import/export CSV/JSON</td></tr>
<tr><td><code>inventaire_operations.py</code></td><td class="align-right">~200</td><td>CRUD opÃ©rations</td></tr>
<tr><td><code>inventaire_stats.py</code></td><td class="align-right">~200</td><td>Statistiques et rapports</td></tr>
<tr><td><code>inventaire_stock.py</code></td><td class="align-right">~200</td><td>Gestion stock, pÃ©remption, alertes</td></tr>
</table>
<p><strong>Meilleure dÃ©composition en mixins de la codebase</strong> â€” chaque responsabilitÃ© dans son propre fichier.</p>
</div>
</details>
</div>

<!-- SVC-INTEGRATIONS -->
<div id="svc-integrations">
<details>
<summary>ğŸ”Œ services/integrations/ â€” Services externes <span class="badge badge-yellow">7.5/10</span></summary>
<div>
<table>
<tr><th>Service</th><th>@service_factory</th><th>@avec_resilience</th><th>Score</th></tr>
<tr><td><code>codes_barres.py</code> (501 lignes)</td><td><span class="check">âœ…</span></td><td><span class="cross">âŒ</span></td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>facture.py</code> â€” OCR Mistral Vision (271 lignes)</td><td><span class="check">âœ…</span></td><td><span class="cross">âŒ</span></td><td><span class="badge badge-green">8/10</span></td></tr>
<tr><td><code>produit.py</code> â€” OpenFoodFacts (321 lignes)</td><td><span class="check">âœ…</span></td><td><span class="check">âœ…</span></td><td><span class="badge badge-green">8/10</span></td></tr>
<tr><td><code>garmin/</code> â€” IntÃ©gration Garmin</td><td><span class="check">âœ…</span></td><td><span class="cross">âŒ</span></td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>weather/</code> â€” MÃ©tÃ©o jardin</td><td><span class="check">âœ…</span></td><td><span class="cross">âŒ</span></td><td><span class="badge badge-yellow">7/10</span></td></tr>
</table>

<div class="card" style="border-left:4px solid var(--yellow);">
<p><strong>Seul <code>produit.py</code></strong> utilise <code>@avec_resilience</code>. Tous les appels HTTP externes (Garmin, mÃ©tÃ©o, Football-Data, OpenFoodFacts) devraient l'utiliser â€” c'est le cas d'usage principal de ce dÃ©corateur.</p>
</div>
</div>
</details>
</div>

<!-- SVC-MAISON -->
<div id="svc-maison">
<details>
<summary>ğŸ  services/maison/ â€” Entretien, jardin, dÃ©penses, projets <span class="badge badge-yellow">7/10</span></summary>
<div>
<table>
<tr><th>Service</th><th>Lignes</th><th>BaseAIService</th><th>@service_factory</th><th>Score</th></tr>
<tr><td><code>entretien_service.py</code> + gamification mixin</td><td class="align-right">431</td><td><span class="check">âœ…</span></td><td><span class="check">âœ…</span></td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>jardin_service.py</code> + 3 mixins</td><td class="align-right">456</td><td><span class="check">âœ…</span></td><td><span class="check">âœ…</span></td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>depenses_crud_service.py</code></td><td class="align-right">223</td><td>â€”</td><td><span class="check">âœ…</span></td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>projets_service.py</code></td><td class="align-right">476</td><td>â€”</td><td><span class="check">âœ…</span></td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>hub_data_service.py</code></td><td class="align-right">73</td><td>â€”</td><td><span class="check">âœ…</span></td><td><span class="badge badge-yellow">6/10</span></td></tr>
</table>
</div>
</details>
</div>

<!-- SVC-JEUX -->
<div id="svc-jeux">
<details>
<summary>ğŸ® services/jeux/ â€” Loto et paris sportifs <span class="badge badge-green">8/10</span></summary>
<div>
<table>
<tr><th>Service</th><th>Lignes</th><th>@service_factory</th><th>Score</th></tr>
<tr><td><code>ai_service.py</code> â€” IA jeux avec prompt Ã©thique</td><td class="align-right">519</td><td><span class="check">âœ…</span></td><td><span class="badge badge-green">8/10</span></td></tr>
<tr><td><code>loto_crud_service.py</code></td><td class="align-right">407</td><td><span class="check">âœ…</span></td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>paris_crud_service.py</code></td><td class="align-right">666</td><td><span class="check">âœ…</span></td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>prediction_service.py</code></td><td class="align-right">515</td><td><span class="check">âœ…</span></td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>football_data.py</code> â€” API externe</td><td class="align-right">~400</td><td><span class="check">âœ…</span></td><td><span class="badge badge-yellow">7/10</span></td></tr>
</table>
<p><span class="tag tag-info">Info</span> <code>JeuxAIService</code> a un excellent <code>SYSTEM_PROMPT</code> qui rappelle systÃ©matiquement que les jeux sont alÃ©atoires â€” <strong>design Ã©thique exemplaire</strong>.</p>
</div>
</details>
</div>

<!-- SVC-RAPPORTS -->
<div id="svc-rapports">
<details>
<summary>ğŸ“„ services/rapports/ â€” GÃ©nÃ©ration PDF et exports <span class="badge badge-yellow">7/10</span></summary>
<div>
<table>
<tr><th>Service</th><th>Lignes</th><th>@service_factory</th><th>RÃ´le</th></tr>
<tr><td><code>export.py</code></td><td class="align-right">496</td><td><span class="check">âœ…</span></td><td>Export PDF multi-domaines</td></tr>
<tr><td><code>generation.py</code></td><td class="align-right">399</td><td><span class="check">âœ…</span></td><td>Rapports PDF spÃ©cialisÃ©s (stocks, budget, gaspillage)</td></tr>
<tr><td><code>planning_pdf.py</code></td><td class="align-right">~200</td><td><span class="check">âœ…</span></td><td>PDF planning hebdomadaire</td></tr>
</table>
</div>
</details>
</div>

</section>

<!-- ==================== SECTION 3: src/modules/ ==================== -->
<section id="modules">
<h2>ğŸ“¦ src/modules/ â€” Modules mÃ©tier (UI)</h2>
<div class="stats-grid">
  <div class="stat-card"><div class="stat-value" style="color:var(--orange);">188</div><div class="stat-label">Fichiers</div></div>
  <div class="stat-card"><div class="stat-value" style="color:var(--orange);">27 654</div><div class="stat-label">Lignes</div></div>
  <div class="stat-card"><div class="stat-value" style="color:var(--orange);">33</div><div class="stat-label">Points d'entrÃ©e app()</div></div>
  <div class="stat-card"><div class="stat-value" style="color:var(--orange);">7.2</div><div class="stat-label">Score /10</div></div>
</div>

<!-- MOD-ACCUEIL -->
<div id="mod-accueil">
<details open>
<summary>ğŸ  modules/accueil/ â€” Tableau de bord central <span class="badge badge-green">8/10</span></summary>
<div>
<p><strong>6 fichiers</strong> : dashboard.py (222), alerts.py (121), stats.py (~100), summaries.py (205), utils.py (155)</p>
<h4>FonctionnalitÃ©s</h4>
<ul>
<li>âœ… Stats globales (recettes, inventaire, courses, planning) avec <code>st.metric</code></li>
<li>âœ… Alertes critiques (stock bas, pÃ©remption, tÃ¢ches en retard) avec boutons d'action</li>
<li>âœ… Cartes rÃ©sumÃ© par module avec Plotly</li>
<li>âœ… Timeline Ã©vÃ©nements 7 jours</li>
<li>âœ… Quick actions, widget Jules, santÃ© systÃ¨me</li>
</ul>
<h4>Adoption des concepts</h4>
<ul>
<li><span class="check">âœ…</span> <code>@profiler_rerun("accueil")</code></li>
<li><span class="check">âœ…</span> Lazy loading services dans <code>app()</code></li>
<li><span class="check">âœ…</span> <code>GestionnaireEtat.naviguer_vers()</code></li>
<li><span class="check">âœ…</span> <code>KeyNamespace("accueil")</code></li>
<li><span class="cross">âŒ</span> <code>error_boundary</code> non utilisÃ©</li>
</ul>
</div>
</details>
</div>

<!-- MOD-CUISINE -->
<div id="mod-cuisine">
<details>
<summary>ğŸ½ï¸ modules/cuisine/ â€” Hub cuisine (50 fichiers, 5 sous-modules) <span class="badge badge-yellow">7.5/10</span></summary>
<div>
<table>
<tr><th>Sous-module</th><th>Fichiers</th><th>Tabs</th><th>@profiler</th><th>error_boundary</th><th>Score</th></tr>
<tr><td><code>recettes/</code></td><td>7</td><td>Liste, Ajouter, Importer, GÃ©nÃ©rer IA</td><td><span class="check">âœ…</span></td><td><span class="cross">âŒ</span></td><td><span class="badge badge-green">8/10</span></td></tr>
<tr><td><code>courses/</code></td><td>10</td><td>6 tabs dont Suggestions IA, ModÃ¨les</td><td><span class="cross">âŒ</span></td><td><span class="cross">âŒ</span></td><td><span class="badge badge-green">8/10</span></td></tr>
<tr><td><code>inventaire/</code></td><td>20</td><td>9 tabs dont Photos, Notifications, PrÃ©visions</td><td><span class="check">âœ…</span></td><td><span class="check">âœ…</span> (13x)</td><td><span class="badge badge-green">9/10</span></td></tr>
<tr><td><code>planificateur_repas/</code></td><td>6</td><td>Planifier, PrÃ©fÃ©rences, Historique</td><td><span class="cross">âŒ</span></td><td><span class="cross">âŒ</span></td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>batch_cooking_detaille/</code></td><td>5</td><td>PrÃ©parer, Session Batch, Finitions</td><td><span class="cross">âŒ</span></td><td><span class="cross">âŒ</span></td><td><span class="badge badge-yellow">7/10</span></td></tr>
</table>

<h4>ğŸ† ModÃ¨le Gold Standard : <code>inventaire/</code></h4>
<p>Seul module utilisant <code>error_boundary</code> en production (13 instances). Utilise <code>ModuleState</code>, <code>MetricConfig</code>, <code>init_module_state</code>. <strong>Pattern Ã  rÃ©pliquer sur tous les autres modules.</strong></p>

<h4>ğŸš§ FonctionnalitÃ©s WIP</h4>
<ul>
<li><code>batch_cooking</code> : Navigation planner, Export PDF, IntÃ©gration courses</li>
<li><code>planificateur_repas</code> : "Utiliser mon stock" (stub)</li>
</ul>

<h4>Fichiers Ã  nettoyer</h4>
<ul>
<li><span class="tag tag-low">Low</span> <code>inventaire/__init__old.py</code> â€” fichier legacy Ã  supprimer</li>
</ul>
</div>
</details>
</div>

<!-- MOD-FAMILLE -->
<div id="mod-famille">
<details>
<summary>ğŸ‘¨â€ğŸ‘©â€ğŸ‘¦ modules/famille/ â€” Hub familial (25 fichiers, 4 sous-modules) <span class="badge badge-yellow">7/10</span></summary>
<div>
<table>
<tr><th>Sous-module</th><th>Fichiers</th><th>Features clÃ©s</th><th>Score</th></tr>
<tr><td><code>hub_famille.py</code></td><td>1</td><td>Dashboard cartes + routing interne</td><td><span class="badge badge-green">8/10</span></td></tr>
<tr><td><code>jules/</code></td><td>4</td><td>Suivi dÃ©veloppement, conseils IA, shopping taille</td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>weekend/</code></td><td>4</td><td>Suggestions IA mÃ©tÃ©o-aware, lieux testÃ©s, budget</td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>suivi_perso/</code></td><td>6</td><td>Multi-user (Anne/Mathieu), Garmin, alimentation</td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>achats_famille/</code></td><td>3</td><td>CRUD achats avec stats par magasin</td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>activites.py</code></td><td>1</td><td>Planning semaine, idÃ©es, budget (boutons no-op)</td><td><span class="badge badge-yellow">6/10</span></td></tr>
<tr><td><code>routines.py</code></td><td>1</td><td>Rappels IA, CRUD routines, suivi</td><td><span class="badge badge-yellow">7/10</span></td></tr>
</table>

<h4>ProblÃ¨mes</h4>
<ul>
<li><span class="tag tag-medium">Medium</span> <code>activites.py</code> : les boutons suggestion sont des no-op (<code>pass</code>)</li>
<li><span class="tag tag-medium">Medium</span> Navigation via <code>session_state[SK.FAMILLE_PAGE]</code> brut au lieu de <code>naviguer()</code></li>
<li><span class="cross">âŒ</span> Aucun <code>error_boundary</code> dans tout le module famille</li>
<li><span class="cross">âŒ</span> Seul <code>hub_famille</code> utilise <code>@profiler_rerun</code></li>
</ul>
</div>
</details>
</div>

<!-- MOD-MAISON -->
<div id="mod-maison">
<details>
<summary>ğŸ¡ modules/maison/ â€” Gestion habitat (30 fichiers, 5 sous-modules) <span class="badge badge-yellow">7/10</span></summary>
<div>
<table>
<tr><th>Sous-module</th><th>Fichiers</th><th>Tabs</th><th>Score</th></tr>
<tr><td><code>hub/</code></td><td>4</td><td>Briefing, prioritÃ©s, charge mentale, navigation</td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>entretien/</code></td><td>9</td><td>7 tabs avec gamification (score, streak, badges)</td><td><span class="badge badge-green">8/10</span></td></tr>
<tr><td><code>charges/</code></td><td>6</td><td>5 tabs : factures, simulation, conseils</td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>depenses/</code></td><td>8</td><td>CRUD, Plotly charts, prÃ©dictions IA, export</td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>jardin/</code></td><td>6</td><td>7 tabs avec gamification, mÃ©tÃ©o, autonomie</td><td><span class="badge badge-green">8/10</span></td></tr>
</table>

<h4>ProblÃ¨mes</h4>
<ul>
<li><span class="tag tag-medium">Medium</span> Hub quick actions sont tous des stubs (<code>st.info("Formulaire...")</code>)</li>
<li><span class="tag tag-low">Low</span> 3 variables CSS deprecated (<code>CSS = ""</code>) dans styles.py</li>
<li>ğŸš§ Plan jardin interactif 2D (avec drag & drop) â€” incomplet</li>
<li><span class="cross">âŒ</span> Aucun <code>@profiler_rerun</code>, aucun <code>error_boundary</code></li>
</ul>
</div>
</details>
</div>

<!-- MOD-JEUX -->
<div id="mod-jeux">
<details>
<summary>ğŸ® modules/jeux/ â€” Loto et paris sportifs (27 fichiers) <span class="badge badge-green">8/10</span></summary>
<div>
<table>
<tr><th>Sous-module</th><th>Fichiers</th><th>Tabs</th><th>Score</th></tr>
<tr><td><code>loto/</code></td><td>13</td><td>7 tabs : Stats, Tendances, GÃ©nÃ©rer, Simulation, Maths, Tirages</td><td><span class="badge badge-green">8/10</span></td></tr>
<tr><td><code>paris/</code></td><td>13</td><td>5 tabs : PrÃ©dictions IA, SÃ©ries, Performance, Classements</td><td><span class="badge badge-green">8/10</span></td></tr>
</table>
<p>Modules excellents : bien sÃ©parÃ©s, API intÃ©grÃ©e (Football-Data), prompt Ã©thique, 5 championnats europÃ©ens.</p>
</div>
</details>
</div>

<!-- MOD-PLANNING -->
<div id="mod-planning">
<details>
<summary>ğŸ“… modules/planning/ â€” Calendrier unifiÃ© (14 fichiers) <span class="badge badge-green">8/10</span></summary>
<div>
<table>
<tr><th>Sous-module</th><th>Fichiers</th><th>Features</th><th>Score</th></tr>
<tr><td><code>calendrier/</code></td><td>10</td><td>Vue semaine unifiÃ©e, analytics Plotly, IA, Google Calendar</td><td><span class="badge badge-green">8/10</span></td></tr>
<tr><td><code>timeline_ui.py</code></td><td>1</td><td>Visualisation timeline jour + Gantt semaine</td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>templates_ui.py</code></td><td>1</td><td>CRUD templates semaine + appliquer</td><td><span class="badge badge-yellow">7/10</span></td></tr>
</table>
<p><span class="tag tag-low">Low</span> <code>components/</code> contient uniquement un <code>__init__.py</code> vide â€” Ã  supprimer.</p>
</div>
</details>
</div>

<!-- MOD-PARAMETRES -->
<div id="mod-parametres">
<details>
<summary>âš™ï¸ modules/parametres/ â€” ParamÃ¨tres multi-onglets (9 fichiers) <span class="badge badge-yellow">7/10</span></summary>
<div>
<p><strong>8 tabs</strong> : Foyer, IA, BD, Cache, Sauvegarde, Affichage, Budget, Ã€ Propos</p>
<h4>ProblÃ¨mes</h4>
<ul>
<li><span class="tag tag-medium">Medium</span> Imports eagerly au niveau module (7 tabs) â€” devrait Ãªtre lazy dans <code>app()</code></li>
<li><span class="tag tag-medium">Medium</span> Config foyer sauvegardÃ©e uniquement en <code>session_state</code> â€” non persistÃ©e en DB</li>
</ul>
</div>
</details>
</div>

<!-- MOD-UTILITAIRES -->
<div id="mod-utilitaires">
<details>
<summary>ğŸ”§ modules/utilitaires/ â€” Outils et intÃ©grations (12 fichiers) <span class="badge badge-yellow">7/10</span></summary>
<div>
<table>
<tr><th>Module</th><th>Lignes</th><th>Features</th><th>Score</th></tr>
<tr><td><code>barcode/</code></td><td>~500</td><td>Scanner multi-mode (vidÃ©o, photo, manuel), pyzbar + zxing fallback</td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>notifications_push.py</code></td><td>427</td><td>ntfy.sh, QR code, mode dÃ©mo, alertes retard</td><td><span class="badge badge-green">8/10</span></td></tr>
<tr><td><code>rapports.py</code></td><td>543</td><td>GÃ©nÃ©ration PDF (stocks, budget, gaspillage), preview</td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>scan_factures.py</code></td><td>283</td><td>OCR Mistral Vision, factures Ã©nergie</td><td><span class="badge badge-yellow">7/10</span></td></tr>
<tr><td><code>recherche_produits.py</code></td><td>276</td><td>OpenFoodFacts, Nutri-Score, NOVA, Eco-Score</td><td><span class="badge badge-green">8/10</span></td></tr>
</table>
<p>ğŸš§ <code>scan_factures.py</code> : "IntÃ©gration avec le module Charges Ã  venir"</p>
</div>
</details>
</div>

<!-- MOD-FRAMEWORK -->
<div id="mod-framework">
<details>
<summary>ğŸ§© modules/_framework/ â€” Framework de modules (6 fichiers) <span class="badge badge-yellow">Adoption : 3%</span></summary>
<div>
<p>Fournit <code>BaseModule</code>, <code>error_boundary</code>, <code>ModuleState</code>, <code>fragments</code> pour standardiser le dÃ©veloppement de modules.</p>

<h4>Taux d'adoption actuel</h4>
<div class="adoption-row">
  <div class="concept"><code>error_boundary</code></div>
  <div style="flex:1"><div class="progress-bar"><div class="progress-fill progress-red" style="width:3%"></div></div></div>
  <div class="ratio">1/33</div>
</div>
<div class="adoption-row">
  <div class="concept"><code>ModuleState</code></div>
  <div style="flex:1"><div class="progress-bar"><div class="progress-fill progress-red" style="width:3%"></div></div></div>
  <div class="ratio">1/33</div>
</div>
<div class="adoption-row">
  <div class="concept"><code>BaseModule</code></div>
  <div style="flex:1"><div class="progress-bar"><div class="progress-fill progress-red" style="width:0%"></div></div></div>
  <div class="ratio">0/33</div>
</div>
<div class="adoption-row">
  <div class="concept"><code>fragments</code></div>
  <div style="flex:1"><div class="progress-bar"><div class="progress-fill progress-red" style="width:0%"></div></div></div>
  <div class="ratio">0/33</div>
</div>

<div class="card" style="border-left:4px solid var(--purple);">
<p><strong>Le framework existe et est bien conÃ§u</strong> â€” le module <code>inventaire/</code> prouve que le pattern fonctionne. L'enjeu est l'adoption progressive sur les 32 autres modules. C'est l'amÃ©lioration Ã  plus fort impact/effort ratio.</p>
</div>
</div>
</details>
</div>

</section>

<!-- ==================== SECTION 4: src/ui/ ==================== -->
<section id="ui">
<h2>ğŸ¨ src/ui/ â€” Couche UI et Design System</h2>
<div class="stats-grid">
  <div class="stat-card"><div class="stat-value" style="color:var(--green);">60</div><div class="stat-label">Fichiers</div></div>
  <div class="stat-card"><div class="stat-value" style="color:var(--green);">8 783</div><div class="stat-label">Lignes</div></div>
  <div class="stat-card"><div class="stat-value" style="color:var(--green);">12</div><div class="stat-label">Sous-packages</div></div>
  <div class="stat-card"><div class="stat-value" style="color:var(--green);">8.7</div><div class="stat-label">Score /10</div></div>
</div>

<details open>
<summary>ğŸ¨ Design System â€” Tokens, Theme, CSS Engine <span class="badge badge-green">9/10</span></summary>
<div>
<table>
<tr><th>Composant</th><th>Lignes</th><th>RÃ´le</th><th>Score</th></tr>
<tr><td><code>tokens.py</code></td><td>~350</td><td>StrEnum tokens : <code>Couleur</code> (40+ couleurs), <code>Espacement</code>, <code>Rayon</code>, <code>Typographie</code>, <code>Ombre</code></td><td><span class="badge badge-green">9/10</span></td></tr>
<tr><td><code>tokens_semantic.py</code></td><td>~200</td><td>CSS custom properties (<code>var(--sem-*)</code>) avec mappings light/dark</td><td><span class="badge badge-green">9/10</span></td></tr>
<tr><td><code>theme.py</code></td><td>~250</td><td>Mode light/dark/auto, densitÃ© (compact/normal/comfortable)</td><td><span class="badge badge-green">9/10</span></td></tr>
<tr><td><code>engine/css.py</code></td><td>~400</td><td><code>CSSEngine</code> â€” injection batch, hash MD5, dÃ©duplication, keyframes</td><td><span class="badge badge-green">9/10</span></td></tr>
</table>
<p><strong>Design system complet</strong> : source unique de vÃ©ritÃ© pour les couleurs, espacements, typographie. Architecture de tokens â†’ CSS variables â†’ composants trÃ¨s professionnelle.</p>
</div>
</details>

<details>
<summary>ğŸ§© Components â€” Widgets rÃ©utilisables <span class="badge badge-green">9/10</span></summary>
<div>
<table>
<tr><th>Composant</th><th>RÃ©utilisabilitÃ©</th><th>@st.cache_data</th><th>HTML Escape</th></tr>
<tr><td><code>atoms.py</code> â€” badge, carte_metrique, etat_vide, separateur</td><td>Haute</td><td>â€”</td><td><span class="check">âœ…</span></td></tr>
<tr><td><code>charts.py</code> â€” Plotly charts</td><td>Haute</td><td><span class="check">âœ… ttl=300</span></td><td>â€”</td></tr>
<tr><td><code>data.py</code> â€” pagination, mÃ©triques, export</td><td>Haute</td><td>â€”</td><td><span class="check">âœ…</span></td></tr>
<tr><td><code>filters.py</code> â€” FilterConfig, barre filtres, recherche</td><td>TrÃ¨s haute</td><td>â€”</td><td>â€”</td></tr>
<tr><td><code>forms.py</code> â€” formulaire gÃ©nÃ©rique type-safe</td><td>TrÃ¨s haute</td><td>â€”</td><td>â€”</td></tr>
<tr><td><code>layouts.py</code> â€” grille, carte_item</td><td>Haute</td><td>â€”</td><td><span class="check">âœ…</span></td></tr>
<tr><td><code>metrics.py</code> â€” cartes mÃ©triques avancÃ©es</td><td>Haute</td><td>â€”</td><td><span class="check">âœ…</span></td></tr>
<tr><td><code>metrics_row.py</code> â€” MetricConfig, KPI banners</td><td>TrÃ¨s haute</td><td>â€”</td><td><span class="check">âœ…</span></td></tr>
<tr><td><code>streaming.py</code> â€” StreamingContainer</td><td>Haute</td><td>â€”</td><td>â€”</td></tr>
<tr><td><code>system.py</code> â€” indicateur santÃ©</td><td>Moyenne</td><td><span class="check">âœ… ttl=30</span></td><td><span class="check">âœ…</span></td></tr>
<tr><td><code>dynamic.py</code> â€” Modale</td><td>âš ï¸ DEPRECATED</td><td>â€”</td><td>â€”</td></tr>
</table>
</div>
</details>

<details>
<summary>ğŸ“¢ Feedback â€” Notifications, spinners, progression <span class="badge badge-green">9/10</span></summary>
<div>
<ul>
<li><code>toasts.py</code> â€” <strong>DÃ©duplication</strong> (fenÃªtre 3s), historique (50 derniers), shortcuts <code>afficher_succes/erreur/avertissement</code></li>
<li><code>spinners.py</code> â€” Context manager avec estimation de temps, skeleton loader shimmer</li>
<li><code>results.py</code> â€” Pont <code>Result[T, E]</code> entre services et UI â€” excellente boundary</li>
<li><code>progress_v2.py</code> â€” <code>st.status()</code> (Streamlit 1.25+), multi-Ã©tapes, estimation temps</li>
</ul>
</div>
</details>

<details>
<summary>â™¿ AccessibilitÃ© et Responsive <span class="badge badge-green">8/10</span></summary>
<div>
<h4>AccessibilitÃ© (WCAG 2.1)</h4>
<ul>
<li><span class="check">âœ…</span> <code>a11y.py</code> : <code>.sr-only</code>, ARIA live regions, landmarks, <strong>calculateur ratio contraste</strong> AA/AAA</li>
<li><span class="check">âœ…</span> <code>prefers-reduced-motion</code> respectÃ© dans animations et styles</li>
<li><span class="check">âœ…</span> <code>:focus-visible</code> styling global</li>
<li><span class="cross">âŒ</span> Pas d'<code>aria-label</code> sur la plupart des composants HTML custom</li>
<li><span class="cross">âŒ</span> CSS <code>.skip-link</code> dÃ©fini mais aucun Ã©lÃ©ment <code>&lt;a class="skip-link"&gt;</code> rendu</li>
</ul>

<h4>Responsive</h4>
<ul>
<li><span class="check">âœ…</span> 3 breakpoints (<480px mobile, 481-768px tablet, >768px desktop)</li>
<li><span class="check">âœ…</span> Typographie fluide avec <code>clamp()</code></li>
<li><span class="check">âœ…</span> Mode tablette dÃ©diÃ© (<code>tablet/</code>) avec styles tactiles</li>
<li><span class="check">âœ…</span> Print stylesheet pour recettes/planning</li>
</ul>

<h4>Autres modules notables</h4>
<ul>
<li><code>fragments.py</code> â€” 4 dÃ©corateurs (<code>@ui_fragment</code>, <code>@auto_refresh</code>, <code>@lazy</code>, <code>@cached_fragment</code>) wrappant <code>st.fragment</code></li>
<li><code>keys.py</code> â€” <code>KeyNamespace</code> pour clÃ©s widget scoped avec dÃ©tection de collision</li>
<li><code>registry.py</code> â€” <code>@composant_ui</code> auto-enregistre les composants â†’ <code>obtenir_catalogue()</code></li>
<li><code>state/url.py</code> â€” Deep linking via <code>st.query_params</code></li>
</ul>
</div>
</details>
</section>

<!-- ==================== SECTION 5: src/api/ ==================== -->
<section id="api">
<h2>ğŸŒ src/api/ â€” API REST FastAPI</h2>
<div class="stats-grid">
  <div class="stat-card"><div class="stat-value" style="color:var(--green);">32</div><div class="stat-label">Fichiers</div></div>
  <div class="stat-card"><div class="stat-value" style="color:var(--green);">3 043</div><div class="stat-label">Lignes</div></div>
  <div class="stat-card"><div class="stat-value" style="color:var(--green);">22</div><div class="stat-label">Endpoints</div></div>
  <div class="stat-card"><div class="stat-value" style="color:var(--green);">8.2</div><div class="stat-label">Score /10</div></div>
</div>

<div class="card" style="border-left:4px solid var(--accent);">
<p><strong>Composant standalone</strong> â€” L'API n'est PAS utilisÃ©e par l'app Streamlit. Elle partage les modÃ¨les et services (<code>src/core/</code>, <code>src/services/</code>) et fournit un accÃ¨s programmatique pour des clients externes (mobile, scripts, intÃ©grations).</p>
</div>

<details open>
<summary>ğŸ“¡ Endpoints & Authentification</summary>
<div>
<table>
<tr><th>Route</th><th>MÃ©thodes</th><th>Auth</th><th>Description</th></tr>
<tr><td><code>/</code></td><td>GET</td><td>â€”</td><td>Root info + liens docs</td></tr>
<tr><td><code>/health</code></td><td>GET</td><td>â€”</td><td>Health check (DB, cache, IA)</td></tr>
<tr><td><code>/metrics</code></td><td>GET</td><td>â€”</td><td>MÃ©triques API (latence, compteurs)</td></tr>
<tr><td><code>/api/v1/auth/login</code></td><td>POST</td><td>â€”</td><td>Supabase email/password â†’ JWT</td></tr>
<tr><td><code>/api/v1/auth/refresh</code></td><td>POST</td><td>JWT</td><td>RafraÃ®chir le token</td></tr>
<tr><td><code>/api/v1/auth/me</code></td><td>GET</td><td>JWT</td><td>Info utilisateur courant</td></tr>
<tr><td><code>/api/v1/recettes</code></td><td>GET, POST</td><td>POST: JWT</td><td>CRUD recettes paginÃ©</td></tr>
<tr><td><code>/api/v1/recettes/{id}</code></td><td>GET, PUT, DEL</td><td>Mutate: JWT</td><td>CRUD recette unique</td></tr>
<tr><td><code>/api/v1/inventaire</code></td><td>GET, POST</td><td>POST: JWT</td><td>CRUD inventaire filtrÃ©</td></tr>
<tr><td><code>/api/v1/inventaire/barcode/{code}</code></td><td>GET</td><td>â€”</td><td>Recherche code-barres</td></tr>
<tr><td><code>/api/v1/courses</code></td><td>GET, POST</td><td>POST: JWT</td><td>Listes de courses</td></tr>
<tr><td><code>/api/v1/courses/{id}</code></td><td>GET</td><td>â€”</td><td>Liste avec articles</td></tr>
<tr><td><code>/api/v1/courses/{id}/items</code></td><td>POST</td><td>JWT</td><td>Ajouter article</td></tr>
<tr><td><code>/api/v1/planning/semaine</code></td><td>GET</td><td>â€”</td><td>Planning hebdomadaire</td></tr>
<tr><td><code>/api/v1/planning/repas</code></td><td>POST, PUT, DEL</td><td>JWT</td><td>CRUD repas planifiÃ©s</td></tr>
<tr><td><code>/api/v1/suggestions/recettes</code></td><td>GET</td><td>JWT + IA</td><td>Suggestions IA recettes</td></tr>
<tr><td><code>/api/v1/suggestions/planning</code></td><td>GET</td><td>JWT + IA</td><td>Suggestions IA planning</td></tr>
<tr><td><code>/api/v1/push/*</code></td><td>POST, DEL, GET</td><td>JWT</td><td>Push notifications</td></tr>
</table>

<h4>Points forts</h4>
<ul>
<li>Rate limiting multi-fenÃªtres (minute/heure/jour) avec tiers d'utilisateurs</li>
<li>DÃ©tection d'abus : auto-block IP au-delÃ  de 2x la limite</li>
<li>Headers standard (<code>X-RateLimit-*</code>, <code>Retry-After</code>)</li>
<li>ETag middleware (MD5 weak ETags)</li>
<li>Documentation auto OpenAPI + README avec exemples Python/JS/cURL</li>
</ul>

<h4>ProblÃ¨mes</h4>
<ul>
<li><span class="tag tag-high">High</span> Rate limiting in-memory â€” <strong>ne fonctionne pas avec multi-workers uvicorn</strong>. NÃ©cessite Redis en production.</li>
<li><span class="tag tag-high">High</span> Secret JWT par dÃ©faut <code>dev-secret-key-change-in-production</code> â€” doit Ã©chouer bruyamment si non changÃ© en prod</li>
<li><span class="tag tag-medium">Medium</span> Pas de schÃ©ma <code>RecettePatch</code> (mise Ã  jour partielle) â€” PUT utilise le mÃªme schÃ©ma que POST</li>
<li><span class="tag tag-low">Low</span> Mode dev retourne un utilisateur admin sans token â€” correct pour le dev mais doit Ãªtre dÃ©sactivÃ© en prod</li>
</ul>
</div>
</details>
</section>

<!-- ==================== SECTION 6: app.py ==================== -->
<section id="app">
<h2>ğŸš€ app.py â€” Point d'entrÃ©e principal</h2>

<div class="stats-grid">
  <div class="stat-card"><div class="stat-value" style="color:var(--green);">113</div><div class="stat-label">Lignes</div></div>
  <div class="stat-card"><div class="stat-value" style="color:var(--green);">8.0</div><div class="stat-label">Score /10</div></div>
</div>

<details open>
<summary>SÃ©quence de bootstrap (10 Ã©tapes)</summary>
<div>
<table>
<tr><th>#</th><th>Ã‰tape</th><th>DÃ©tail</th></tr>
<tr><td>1</td><td>Environnement</td><td><code>.env.local</code> â†’ <code>.env</code> via python-dotenv</td></tr>
<tr><td>2</td><td>Chemins</td><td>Ajout racine projet Ã  <code>sys.path</code></td></tr>
<tr><td>3</td><td>Logging</td><td><code>GestionnaireLog.initialiser(niveau_log="INFO")</code></td></tr>
<tr><td>4</td><td>Bootstrap IoC</td><td><code>demarrer_application(valider_config=False)</code></td></tr>
<tr><td>5</td><td>Imports minimal</td><td><code>GestionnaireEtat</code>, <code>RouteurOptimise</code></td></tr>
<tr><td>6</td><td>Layout</td><td>Header, sidebar, footer, styles</td></tr>
<tr><td>7</td><td><code>st.set_page_config()</code></td><td>Layout wide, sidebar expanded</td></tr>
<tr><td>8</td><td>CSS</td><td><code>injecter_css()</code> â†’ batch unique</td></tr>
<tr><td>9</td><td>PWA</td><td><code>injecter_meta_pwa()</code></td></tr>
<tr><td>10</td><td>Initialisation</td><td><code>initialiser_app()</code> â†’ DB check, IA client, CSS pipeline</td></tr>
</table>

<h4>Routage</h4>
<pre><code>etat = obtenir_etat()
RouteurOptimise.charger_module(etat.module_actuel)</code></pre>
<p><code>RouteurOptimise</code> utilise <code>MODULE_REGISTRY</code> pour mapper les clÃ©s de module aux chemins d'import. Chargement paresseux uniquement quand l'utilisateur navigue.</p>

<h4>Gestion d'erreurs</h4>
<pre><code>try:
    afficher_header()
    afficher_sidebar()
    RouteurOptimise.charger_module(etat.module_actuel)
    afficher_footer()
except Exception as e:
    logger.exception("âŒ Erreur critique dans main()")
    st.error("âŒ Une erreur critique est survenue...")
    if obtenir_etat().mode_debug:
        st.exception(e)
    if st.button("ğŸ”„ RedÃ©marrer"):
        GestionnaireEtat.reset_complet()
        st.rerun()</code></pre>
<p>Bon mÃ©canisme de recovery avec bouton reset.</p>

<h4>ProblÃ¨mes</h4>
<ul>
<li><span class="tag tag-low">Low</span> <code>injecter_css()</code> appelÃ© deux fois : ligne 93 ET dans <code>initialiser_app()</code> â€” la 2Ã¨me Ã©crase la 1Ã¨re</li>
<li><span class="tag tag-low">Low</span> <code>valider_config=False</code> â€” validation config dÃ©sactivÃ©e (risque de config invalide silencieuse)</li>
</ul>
</div>
</details>
</section>

<!-- ==================== SECTION 7: ADOPTION DES CONCEPTS ==================== -->
<section id="adoption">
<h2>ğŸ” Matrice d'adoption des concepts</h2>
<p>L'infrastructure <code>core/</code> fournit des concepts avancÃ©s. Voici leur taux d'utilisation rÃ©el dans les services et modules :</p>

<h3>Concepts dans les Services</h3>
<div class="adoption-row">
  <div class="concept"><code>@service_factory</code></div>
  <div style="flex:1"><div class="progress-bar"><div class="progress-fill progress-green" style="width:96%"></div></div></div>
  <div class="ratio"><strong>47/49</strong></div>
</div>
<div class="adoption-row">
  <div class="concept"><code>BaseAIService</code></div>
  <div style="flex:1"><div class="progress-bar"><div class="progress-fill progress-green" style="width:85%"></div></div></div>
  <div class="ratio">~12/14 IA</div>
</div>
<div class="adoption-row">
  <div class="concept"><code>@avec_session_db</code></div>
  <div style="flex:1"><div class="progress-bar"><div class="progress-fill progress-green" style="width:90%"></div></div></div>
  <div class="ratio">~40+ mÃ©th.</div>
</div>
<div class="adoption-row">
  <div class="concept"><code>@avec_cache</code></div>
  <div style="flex:1"><div class="progress-bar"><div class="progress-fill progress-yellow" style="width:40%"></div></div></div>
  <div class="ratio">Cuisine seul.</div>
</div>
<div class="adoption-row">
  <div class="concept"><code>@avec_gestion_erreurs</code></div>
  <div style="flex:1"><div class="progress-bar"><div class="progress-fill progress-yellow" style="width:35%"></div></div></div>
  <div class="ratio">Cuisine seul.</div>
</div>
<div class="adoption-row">
  <div class="concept"><code>@avec_resilience</code></div>
  <div style="flex:1"><div class="progress-bar"><div class="progress-fill progress-red" style="width:5%"></div></div></div>
  <div class="ratio"><strong>1/~10</strong></div>
</div>
<div class="adoption-row">
  <div class="concept">Event Bus</div>
  <div style="flex:1"><div class="progress-bar"><div class="progress-fill progress-yellow" style="width:50%"></div></div></div>
  <div class="ratio">Famille OK</div>
</div>
<div class="adoption-row">
  <div class="concept">Middleware Pipeline</div>
  <div style="flex:1"><div class="progress-bar"><div class="progress-fill progress-red" style="width:0%"></div></div></div>
  <div class="ratio"><strong>0/47</strong></div>
</div>

<h3>Concepts dans les Modules</h3>
<div class="adoption-row">
  <div class="concept"><code>app()</code> entry point</div>
  <div style="flex:1"><div class="progress-bar"><div class="progress-fill progress-green" style="width:100%"></div></div></div>
  <div class="ratio"><strong>33/33</strong></div>
</div>
<div class="adoption-row">
  <div class="concept"><code>@profiler_rerun</code></div>
  <div style="flex:1"><div class="progress-bar"><div class="progress-fill progress-red" style="width:12%"></div></div></div>
  <div class="ratio"><strong>4/33</strong></div>
</div>
<div class="adoption-row">
  <div class="concept"><code>error_boundary</code></div>
  <div style="flex:1"><div class="progress-bar"><div class="progress-fill progress-red" style="width:3%"></div></div></div>
  <div class="ratio"><strong>1/33</strong></div>
</div>
<div class="adoption-row">
  <div class="concept"><code>ModuleState</code></div>
  <div style="flex:1"><div class="progress-bar"><div class="progress-fill progress-red" style="width:3%"></div></div></div>
  <div class="ratio"><strong>1/33</strong></div>
</div>
<div class="adoption-row">
  <div class="concept"><code>BaseModule</code></div>
  <div style="flex:1"><div class="progress-bar"><div class="progress-fill progress-red" style="width:0%"></div></div></div>
  <div class="ratio"><strong>0/33</strong></div>
</div>
<div class="adoption-row">
  <div class="concept">Lazy loading correct</div>
  <div style="flex:1"><div class="progress-bar"><div class="progress-fill progress-green" style="width:85%"></div></div></div>
  <div class="ratio">~28/33</div>
</div>
<div class="adoption-row">
  <div class="concept"><code>naviguer()</code></div>
  <div style="flex:1"><div class="progress-bar"><div class="progress-fill progress-yellow" style="width:30%"></div></div></div>
  <div class="ratio">~10/33</div>
</div>
<div class="adoption-row">
  <div class="concept"><code>KeyNamespace</code></div>
  <div style="flex:1"><div class="progress-bar"><div class="progress-fill progress-yellow" style="width:30%"></div></div></div>
  <div class="ratio">~10/33</div>
</div>
<div class="adoption-row">
  <div class="concept"><code>@st.fragment</code></div>
  <div style="flex:1"><div class="progress-bar"><div class="progress-fill progress-red" style="width:0%"></div></div></div>
  <div class="ratio"><strong>0/33</strong></div>
</div>
</section>

<!-- ==================== SECTION 8: PROBLÃˆMES CRITIQUES ==================== -->
<section id="issues">
<h2>ğŸ› ProblÃ¨mes critiques â€” Top 10</h2>

<table>
<tr><th>#</th><th>SÃ©vÃ©ritÃ©</th><th>Localisation</th><th>Description</th></tr>
<tr>
<td>1</td>
<td><span class="tag tag-critical">CRITICAL</span></td>
<td><code>core/decorators/cache.py</code></td>
<td><code>@avec_cache</code> crÃ©e un nouveau <code>CacheMultiNiveau()</code> orphelin Ã  chaque appel â€” le cache est fonctionnellement cassÃ© (aucun hit possible). Fix : utiliser <code>obtenir_cache()</code>.</td>
</tr>
<tr>
<td>2</td>
<td><span class="tag tag-high">HIGH</span></td>
<td><code>core/ai/circuit_breaker.py</code></td>
<td><code>@avec_circuit_breaker</code> ne supporte pas les fonctions async â€” appelle <code>func()</code> de maniÃ¨re synchrone. Les services async IA ne sont pas protÃ©gÃ©s.</td>
</tr>
<tr>
<td>3</td>
<td><span class="tag tag-high">HIGH</span></td>
<td><code>core/resilience/policies.py</code></td>
<td><code>PolicyComposee.__add__</code> et <code>__repr__</code> sont du dead code (indentation incorrecte hors du corps de classe).</td>
</tr>
<tr>
<td>4</td>
<td><span class="tag tag-high">HIGH</span></td>
<td><code>api/auth.py</code></td>
<td>Secret JWT par dÃ©faut <code>dev-secret-key-change-in-production</code> â€” doit fail-fast si non changÃ© en production.</td>
</tr>
<tr>
<td>5</td>
<td><span class="tag tag-high">HIGH</span></td>
<td><code>api/rate_limiting/</code></td>
<td>Stockage rate limiting in-memory â€” ne survit pas aux redÃ©marrages et ne fonctionne pas avec multi-workers.</td>
</tr>
<tr>
<td>6</td>
<td><span class="tag tag-medium">MEDIUM</span></td>
<td><code>core/monitoring/health.py</code></td>
<td><code>_verifier_cache()</code> crÃ©e un nouveau <code>CacheMultiNiveau()</code> au lieu du singleton â€” health check toujours "vide".</td>
</tr>
<tr>
<td>7</td>
<td><span class="tag tag-medium">MEDIUM</span></td>
<td><code>services/famille/</code></td>
<td><code>JulesAIService</code> et <code>WeekendAIService</code> : pas de <code>@service_factory</code>, <code>ClientIA()</code> directement, aucun dÃ©corateur.</td>
</tr>
<tr>
<td>8</td>
<td><span class="tag tag-medium">MEDIUM</span></td>
<td><code>services/cuisine/recettes/importer.py</code></td>
<td>Code dÃ©prÃ©ciÃ© (432 lignes) avec 3 TODOs â€” dupliquÃ© par <code>import_url.py</code>. Migration UI incomplÃ¨te.</td>
</tr>
<tr>
<td>9</td>
<td><span class="tag tag-medium">MEDIUM</span></td>
<td><code>modules/_framework/</code></td>
<td>Framework bien conÃ§u mais adoptÃ© Ã  3% seulement (1/33 modules). 670 lignes de middleware pipeline inutilisÃ©es.</td>
</tr>
<tr>
<td>10</td>
<td><span class="tag tag-medium">MEDIUM</span></td>
<td><code>core/db/session.py</code></td>
<td><code>obtenir_contexte_db()</code> auto-commit en sortie â€” comportement non standard, risquÃ© si contextes imbriquÃ©s.</td>
</tr>
</table>
</section>

<!-- ==================== SECTION 9: INNOVATIONS ==================== -->
<section id="innovations">
<h2>ğŸ’¡ AmÃ©liorations innovantes Streamlit</h2>

<div class="innovation-grid">

<div class="innovation-card">
<h4>1. ğŸ”€ <code>st.navigation()</code> + <code>st.Page()</code></h4>
<p>Migrer de <code>RouteurOptimise</code> vers le routage natif Streamlit 1.36+. BÃ©nÃ©fices : URL deep-linking natif, transitions de page, bouton back du navigateur, multi-page native.</p>
<div class="impact"><span>Impact :</span> UX ++, maintenance --, SEO +</div>
</div>

<div class="innovation-card">
<h4>2. ğŸ§© <code>@st.fragment</code> pour refresh partiel</h4>
<p>Votre <code>ui/fragments.py</code> encapsule dÃ©jÃ  <code>@st.fragment</code> mais aucun module ne l'utilise. Permet de rafraÃ®chir un composant sans recharger toute la page â€” critique pour le dashboard.</p>
<div class="impact"><span>Impact :</span> Performance +++, UX ++</div>
</div>

<div class="innovation-card">
<h4>3. â±ï¸ Dashboard auto-refresh</h4>
<p><code>@st.fragment(run_every=30)</code> pour le dashboard accueil : alertes, mÃ©triques, timeline se mettent Ã  jour automatiquement sans interaction utilisateur.</p>
<div class="impact"><span>Impact :</span> UX +++</div>
</div>

<div class="innovation-card">
<h4>4. ğŸ’¬ <code>@st.dialog</code> pour les modales</h4>
<p><code>Modale</code> est dÃ©jÃ  deprecated. Streamlit 1.35+ fournit <code>@st.dialog</code> natif pour formulaires interactifs. Plus fiable, mieux intÃ©grÃ©.</p>
<div class="impact"><span>Impact :</span> UX ++, maintenance --</div>
</div>

<div class="innovation-card">
<h4>5. ğŸŒŠ <code>st.write_stream()</code> pour l'IA</h4>
<p>Streamlit 1.31+ offre <code>st.write_stream()</code> natif. Remplacer le <code>StreamingContainer</code> custom (qui bufferise tous les chunks) par le streaming progressif natif.</p>
<div class="impact"><span>Impact :</span> UX +++, code --</div>
</div>

<div class="innovation-card">
<h4>6. ğŸ”Œ <code>st.connection("postgresql")</code></h4>
<p>Utiliser le cache de connexion natif Streamlit au lieu du <code>QueuePool</code> SQLAlchemy custom. BÃ©nÃ©ficie du lifecycle management Streamlit (reconnexion auto, health check intÃ©grÃ©).</p>
<div class="impact"><span>Impact :</span> FiabilitÃ© +, maintenance -</div>
</div>

<div class="innovation-card">
<h4>7. ğŸ“± PWA mode offline</h4>
<p>Les meta tags PWA sont dÃ©jÃ  injectÃ©s. Ajouter un Service Worker pour le mode offline : consultation de recettes, liste de courses, planning sans connexion.</p>
<div class="impact"><span>Impact :</span> UX ++++</div>
</div>

<div class="innovation-card">
<h4>8. ğŸ”„ Cache rÃ©actif <code>st.cache_resource</code></h4>
<p>Pour les singletons de service, <code>@st.cache_resource</code> pourrait remplacer ou complÃ©ter <code>@service_factory</code> avec invalidation intÃ©grÃ©e via <code>.clear()</code>.</p>
<div class="impact"><span>Impact :</span> SimplicitÃ© +</div>
</div>

<div class="innovation-card">
<h4>9. ğŸ“Š Drag & drop planning</h4>
<p>IntÃ©grer <code>streamlit-sortables</code> pour rÃ©ordonnner les repas du planning par glisser-dÃ©poser. Plus intuitif que les selectbox actuels.</p>
<div class="impact"><span>Impact :</span> UX +++</div>
</div>

<div class="innovation-card">
<h4>10. ğŸ§  Chat IA contextuel</h4>
<p>IntÃ©grer <code>st.chat_input()</code> + <code>st.chat_message()</code> pour un assistant conversationnel contextuel dans chaque module (recettes, planning, budget).</p>
<div class="impact"><span>Impact :</span> Innovation ++++</div>
</div>

</div>
</section>

<!-- ==================== SECTION 10: ROADMAP ==================== -->
<section id="roadmap">
<h2>ğŸ—ºï¸ Roadmap priorisÃ©e â€” 5 phases, 20 semaines</h2>

<div class="timeline">

<div class="timeline-item phase1">
<h4><span class="tag tag-critical">Phase 1</span> Corrections critiques â€” Semaines 1-2</h4>
<p>Corriger les bugs bloquants qui empÃªchent le bon fonctionnement des concepts existants.</p>
<ul>
<li>âœï¸ <strong>Corriger <code>@avec_cache</code></strong> : remplacer <code>CacheMultiNiveau()</code> par <code>obtenir_cache()</code> dans <code>decorators/cache.py</code></li>
<li>âœï¸ <strong>Corriger <code>@avec_circuit_breaker</code></strong> : supporter les fonctions async (<code>asyncio.iscoroutinefunction</code>)</li>
<li>âœï¸ <strong>Corriger <code>PolicyComposee</code></strong> : rÃ©-indenter <code>__add__</code> et <code>__repr__</code> dans le corps de la classe</li>
<li>âœï¸ <strong>Corriger <code>_verifier_cache()</code></strong> : utiliser <code>obtenir_cache()</code> dans <code>monitoring/health.py</code></li>
<li>ğŸ—‘ï¸ <strong>Supprimer</strong> : <code>planning/utils.py</code> (dÃ©prÃ©ciÃ©), <code>inventaire/__init__old.py</code> (legacy), <code>planning/components/</code> (vide)</li>
<li>âœï¸ <strong>Corriger double CSS</strong> : supprimer l'appel <code>injecter_css()</code> redondant dans <code>app.py</code> ligne 93</li>
</ul>
</div>

<div class="timeline-item phase2">
<h4><span class="tag tag-high">Phase 2</span> Adoption des concepts dans les services â€” Semaines 3-6</h4>
<p>DÃ©ployer les dÃ©corateurs et patterns de <code>core/</code> dans tous les services.</p>
<ul>
<li>ğŸ“ <strong>Enregistrer</strong> <code>JulesAIService</code> et <code>WeekendAIService</code> avec <code>@service_factory</code></li>
<li>ğŸ“ <strong>Remplacer</strong> <code>ClientIA()</code> par <code>obtenir_client_ia()</code> dans les 2 services IA famille</li>
<li>ğŸ“ <strong>Ajouter <code>@avec_cache</code></strong> aux mÃ©thodes de lecture dans tous les services famille (achats, routines, sante, suivi_perso, weekend, calendrier)</li>
<li>ğŸ“ <strong>Ajouter <code>@avec_gestion_erreurs</code></strong> (avec fallback) dans les services famille</li>
<li>ğŸ“ <strong>Ajouter <code>@avec_resilience</code></strong> sur tous les appels HTTP externes : Garmin, mÃ©tÃ©o, Football-Data, OpenFoodFacts (actuellement seul <code>produit.py</code> l'utilise)</li>
<li>ğŸ“ <strong>Corriger l'ordre</strong> des dÃ©corateurs dans <code>AccueilDataService</code> (<code>@avec_gestion_erreurs</code> en premier) et supprimer le singleton <code>_instance</code> redondant</li>
<li>ğŸ“ <strong>Remplacer</strong> <code>assert db is not None</code> par une gestion d'erreur propre dans les services famille</li>
<li>ğŸ“ <strong>ComplÃ©ter migration</strong> <code>importer.py</code> â†’ <code>import_url.py</code> : mettre Ã  jour les rÃ©fÃ©rences UI, supprimer le code dÃ©prÃ©ciÃ©</li>
</ul>
</div>

<div class="timeline-item phase3">
<h4><span class="tag tag-medium">Phase 3</span> Adoption du framework dans les modules â€” Semaines 7-10</h4>
<p>DÃ©ployer <code>error_boundary</code>, <code>@profiler_rerun</code>, et <code>naviguer()</code> dans tous les modules.</p>
<ul>
<li>ğŸ›¡ï¸ <strong>DÃ©ployer <code>error_boundary</code></strong> sur les 32 modules manquants (wrapper chaque tab)</li>
<li>ğŸ“Š <strong>Ajouter <code>@profiler_rerun</code></strong> sur les 29 modules manquants</li>
<li>ğŸ§­ <strong>Standardiser navigation</strong> : remplacer <code>session_state[SK.FAMILLE_PAGE]</code> par <code>naviguer()</code></li>
<li>ğŸ”‘ <strong>Adopter <code>KeyNamespace</code></strong> dans les modules qui utilisent des clÃ©s brutes</li>
<li>âš¡ <strong>Corriger lazy loading</strong> dans <code>parametres/__init__.py</code> et <code>recettes/__init__.py</code></li>
<li>ğŸš§ <strong>ComplÃ©ter 5 features WIP</strong> : batch cooking (3), planificateur "Utiliser stock", jardin plan 2D</li>
<li>ğŸ”— <strong>Connecter</strong> scan factures au module Charges</li>
<li>âœï¸ <strong>ImplÃ©menter</strong> les boutons suggestion (no-op) dans <code>famille/activites.py</code></li>
<li>ğŸ’¾ <strong>Persister</strong> config foyer en DB</li>
</ul>
</div>

<div class="timeline-item phase4">
<h4><span class="tag tag-info">Phase 4</span> Innovations Streamlit modernes â€” Semaines 11-16</h4>
<p>Adopter les fonctionnalitÃ©s Streamlit 1.31+ pour moderniser l'UX.</p>
<ul>
<li>ğŸ”€ <strong>Migrer vers <code>st.navigation() + st.Page()</code></strong> â€” routage natif avec deep-linking</li>
<li>ğŸ’¬ <strong>Adopter <code>@st.dialog</code></strong> â€” remplacer le Modale deprecated</li>
<li>ğŸ§© <strong>DÃ©ployer <code>@st.fragment</code></strong> â€” refresh partiel sur le dashboard et les tabs coÃ»teux</li>
<li>â±ï¸ <strong>Auto-refresh dashboard</strong> â€” <code>@st.fragment(run_every=30)</code></li>
<li>ğŸŒŠ <strong>Streaming IA natif</strong> â€” <code>st.write_stream()</code> au lieu de <code>StreamingContainer</code></li>
<li>ğŸ—ï¸ <strong>Piloter middleware pipeline</strong> sur un service candidate (ex: recettes)</li>
<li>ğŸ“Š <strong>Drag & drop planning</strong> â€” intÃ©grer <code>streamlit-sortables</code></li>
<li>ğŸ§  <strong>Chat IA contextuel</strong> â€” <code>st.chat_input()</code> dans les modules clÃ©s</li>
</ul>
</div>

<div class="timeline-item phase5">
<h4><span class="tag tag-low">Phase 5</span> Production hardening â€” Semaines 17-20</h4>
<p>SÃ©curiser et fiabiliser pour un usage production rÃ©el.</p>
<ul>
<li>ğŸ”’ <strong>Redis rate limiting</strong> â€” remplacer le stockage in-memory de l'API</li>
<li>ğŸ”’ <strong>Auth hardening</strong> â€” fail-fast si secret JWT = default en prod, dÃ©sactiver dev user en prod</li>
<li>â™¿ <strong>AccessibilitÃ©</strong> â€” ajouter <code>aria-label</code> sur tous les composants HTML custom, rendre le skip-link fonctionnel</li>
<li>ğŸ“ <strong>API partial update</strong> â€” ajouter <code>RecettePatch</code> pour PUT/PATCH</li>
<li>ğŸ“± <strong>PWA offline</strong> â€” Service Worker pour consultation recettes/courses hors-ligne</li>
<li>ğŸ§ª <strong>Tests</strong> â€” augmenter la couverture (actuellement estimÃ©e ~60%) vers 80%+ sur core/ et services/</li>
<li>ğŸ“– <strong>Documentation</strong> â€” gÃ©nÃ©rer doc API automatique depuis <code>@composant_ui</code> registre</li>
</ul>
</div>

</div>

<!-- SUMMARY TABLE -->
<h3>RÃ©capitulatif par phase</h3>
<table>
<tr><th>Phase</th><th>Focus</th><th>DurÃ©e</th><th>Items</th><th>Impact estimÃ©</th></tr>
<tr>
<td><span class="tag tag-critical">1</span></td>
<td>Corrections critiques</td><td>2 sem.</td><td>6</td>
<td>Cache fonctionne, code propre, bugs corrigÃ©s</td>
</tr>
<tr>
<td><span class="tag tag-high">2</span></td>
<td>Concepts â†’ Services</td><td>4 sem.</td><td>8</td>
<td>RÃ©silience +80%, cache famille, erreurs gÃ©rÃ©es</td>
</tr>
<tr>
<td><span class="tag tag-medium">3</span></td>
<td>Framework â†’ Modules</td><td>4 sem.</td><td>9</td>
<td>Robustesse UI +90%, profiling universel, WIP done</td>
</tr>
<tr>
<td><span class="tag tag-info">4</span></td>
<td>Innovations Streamlit</td><td>6 sem.</td><td>8</td>
<td>UX moderne, deep-linking, streaming IA, chat</td>
</tr>
<tr>
<td><span class="tag tag-low">5</span></td>
<td>Production hardening</td><td>4 sem.</td><td>7</td>
<td>SÃ©curitÃ©, accessibilitÃ©, tests, doc</td>
</tr>
</table>

</section>

<!-- ==================== FOOTER ==================== -->
<hr>
<p style="text-align:center;color:var(--text-muted);font-size:.85rem;padding:2rem 0;">
  Rapport gÃ©nÃ©rÃ© le 23 fÃ©vrier 2026 &bull; Assistant Matanne v2.x &bull; 570 fichiers analysÃ©s, 94 104 lignes de code<br>
  <em>Architecture score global : <strong>7.9/10</strong> â€” projet remarquablement mature avec des axes d'amÃ©lioration principalement dans l'adoption des concepts existants.</em>
</p>

</div><!-- end main -->

<script>
// Highlight active nav item on scroll
document.addEventListener('DOMContentLoaded', () => {
  const sections = document.querySelectorAll('section[id], div[id]');
  const navLinks = document.querySelectorAll('.sidebar nav a[href^="#"]');
  const observer = new IntersectionObserver(entries => {
    entries.forEach(entry => {
      if (entry.isIntersecting) {
        navLinks.forEach(l => l.style.background = '');
        const active = document.querySelector(`.sidebar nav a[href="#${entry.target.id}"]`);
        if (active) active.style.background = 'rgba(59,130,246,.15)';
      }
    });
  }, { rootMargin: '-20% 0px -70% 0px' });
  sections.forEach(s => observer.observe(s));
});
</script>
</body>
</html>
