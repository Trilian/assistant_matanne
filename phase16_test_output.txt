STDOUT:
============================= test session starts =============================
platform win32 -- Python 3.11.9, pytest-9.0.2, pluggy-1.6.0 -- D:\Projet_streamlit\assistant_matanne\.venv\Scripts\python.exe
cachedir: .pytest_cache
rootdir: d:\Projet_streamlit\assistant_matanne
configfile: pytest.ini (WARNING: ignoring pytest config in pyproject.toml!)
plugins: anyio-4.12.1, asyncio-1.3.0, cov-7.0.0
asyncio: mode=Mode.AUTO, debug=False, asyncio_default_fixture_loop_scope=function, asyncio_default_test_loop_scope=function
collecting ... collected 27 items

tests/integration/test_phase_16_expanded.py::TestRecetteServiceExpanded::test_recette_create_and_retrieve FAILED [  3%]
tests/integration/test_phase_16_expanded.py::TestRecetteServiceExpanded::test_recette_with_ingredients FAILED [  7%]
tests/integration/test_phase_16_expanded.py::TestRecetteServiceExpanded::test_recette_filtering_by_difficulte FAILED [ 11%]
tests/integration/test_phase_16_expanded.py::TestRecetteServiceExpanded::test_recette_update_and_save FAILED [ 14%]
tests/integration/test_phase_16_expanded.py::TestRecetteServiceExpanded::test_recette_delete FAILED [ 18%]
tests/integration/test_phase_16_expanded.py::TestPlanningServiceExpanded::test_planning_create_week FAILED [ 22%]
tests/integration/test_phase_16_expanded.py::TestPlanningServiceExpanded::test_planning_with_multiple_recipes FAILED [ 25%]
tests/integration/test_phase_16_expanded.py::TestPlanningServiceExpanded::test_planning_auto_generated_flag FAILED [ 29%]
tests/integration/test_phase_16_expanded.py::TestPlanningServiceExpanded::test_planning_date_overlap_detection FAILED [ 33%]
tests/integration/test_phase_16_expanded.py::TestCoursesServiceExpanded::test_article_courses_create FAILED [ 37%]
tests/integration/test_phase_16_expanded.py::TestCoursesServiceExpanded::test_article_courses_mark_purchased FAILED [ 40%]
tests/integration/test_phase_16_expanded.py::TestCoursesServiceExpanded::test_article_courses_by_category FAILED [ 44%]
tests/integration/test_phase_16_expanded.py::TestCoursesServiceExpanded::test_article_courses_essential_items FAILED [ 48%]
tests/integration/test_phase_16_expanded.py::TestInventaireServiceExpanded::test_article_inventaire_create FAILED [ 51%]
tests/integration/test_phase_16_expanded.py::TestInventaireServiceExpanded::test_article_inventaire_low_stock_alert FAILED [ 55%]
tests/integration/test_phase_16_expanded.py::TestInventaireServiceExpanded::test_article_inventaire_update_quantity FAILED [ 59%]
tests/integration/test_phase_16_expanded.py::TestInventaireServiceExpanded::test_article_inventaire_locations FAILED [ 62%]
tests/integration/test_phase_16_expanded.py::TestInventaireServiceExpanded::test_article_inventaire_with_historique FAILED [ 66%]
tests/integration/test_phase_16_expanded.py::TestDomainRecetteComplex::test_recette_seasonal_variations FAILED [ 70%]
tests/integration/test_phase_16_expanded.py::TestDomainRecetteComplex::test_recette_diet_restrictions FAILED [ 74%]
tests/integration/test_phase_16_expanded.py::TestDomainRecetteComplex::test_recette_cost_calculation FAILED [ 77%]
tests/integration/test_phase_16_expanded.py::TestDomainPlanningComplex::test_planning_weekly_nutrition_balance FAILED [ 81%]
tests/integration/test_phase_16_expanded.py::TestDomainShoppingComplex::test_shopping_list_budget_tracking FAILED [ 85%]
tests/integration/test_phase_16_expanded.py::TestUIRecipeDisplay::test_recipe_detail_rendering FAILED [ 88%]
tests/integration/test_phase_16_expanded.py::TestUIPlanningDisplay::test_planning_weekly_view FAILED [ 92%]
tests/integration/test_phase_16_expanded.py::TestUIShoppingDisplay::test_shopping_list_view FAILED [ 96%]
tests/integration/test_phase_16_expanded.py::TestEndToEndWorkflows::test_complete_meal_prep_workflow FAILED [100%]

================================== FAILURES ===================================
_________ TestRecetteServiceExpanded.test_recette_create_and_retrieve _________
.venv\Lib\site-packages\streamlit\elements\spinner.py:116: in spinner
    create_transient, clear_transient = self.dg._transient(
.venv\Lib\site-packages\streamlit\delta_generator.py:636: in _transient
    transient_cursor = self._get_transient_cursor()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\delta_generator.py:441: in _get_transient_cursor
    raise NoSessionContext("Cursor is not set")
E   streamlit.errors.NoSessionContext: Cursor is not set

During handling of the above exception, another exception occurred:
tests\integration\test_phase_16_expanded.py:26: in test_recette_create_and_retrieve
    with get_db_context() as session:
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src\core\database.py:149: in obtenir_contexte_db
    fabrique = obtenir_fabrique_session()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:120: in obtenir_fabrique_session
    moteur = obtenir_moteur()
             ^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:281: in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:326: in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:385: in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:88: in obtenir_moteur
    raise ErreurBaseDeDonnees(
E   src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found
E   
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stdout setup ----------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
---------------------------- Captured stderr setup ----------------------------
2026-02-03 22:29:25.077 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:25.077 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:25.077 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:25.077 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:25.077 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:25.077 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:25.077 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:25.077 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:25.077 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:25.077 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:25.077 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:25.077 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:25.077 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:25.077 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:25.077 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:25.077 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:25.077 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:25.077 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:25.078 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:25.078 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
----------------------------- Captured log setup ------------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m | src.core.config           | [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[31mERROR[0m | src.core.database         | Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stderr call -----------------------------
2026-02-03 22:29:25.082 WARNING streamlit.runtime.scriptrunner_utils.script_run_context: Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
------------------------------ Captured log call ------------------------------
INFO     src.core.config:config.py:490 [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
WARNING  src.core.database:database.py:77 [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    src.core.database:database.py:87 Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
-------------------------- Captured stdout teardown ---------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
-------------------------- Captured stderr teardown ---------------------------
2026-02-03 22:29:30.098 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:30.098 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:30.098 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:30.098 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:30.098 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:30.098 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:30.098 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:30.098 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:30.098 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:30.098 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:30.098 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:30.098 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
---------------------------- Captured log teardown ----------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
__________ TestRecetteServiceExpanded.test_recette_with_ingredients ___________
.venv\Lib\site-packages\streamlit\elements\spinner.py:116: in spinner
    create_transient, clear_transient = self.dg._transient(
.venv\Lib\site-packages\streamlit\delta_generator.py:636: in _transient
    transient_cursor = self._get_transient_cursor()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\delta_generator.py:441: in _get_transient_cursor
    raise NoSessionContext("Cursor is not set")
E   streamlit.errors.NoSessionContext: Cursor is not set

During handling of the above exception, another exception occurred:
tests\integration\test_phase_16_expanded.py:46: in test_recette_with_ingredients
    with get_db_context() as session:
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src\core\database.py:149: in obtenir_contexte_db
    fabrique = obtenir_fabrique_session()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:120: in obtenir_fabrique_session
    moteur = obtenir_moteur()
             ^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:281: in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:326: in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:385: in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:88: in obtenir_moteur
    raise ErreurBaseDeDonnees(
E   src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found
E   
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stdout setup ----------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
---------------------------- Captured stderr setup ----------------------------
2026-02-03 22:29:30.099 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:30.100 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:30.100 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:30.100 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:30.100 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:30.100 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:30.100 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:30.100 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:30.100 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:30.100 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:30.100 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:30.100 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
----------------------------- Captured log setup ------------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m | src.core.config           | [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[31mERROR[0m | src.core.database         | Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stderr call -----------------------------
2026-02-03 22:29:30.102 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
------------------------------ Captured log call ------------------------------
INFO     src.core.config:config.py:490 [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
WARNING  src.core.database:database.py:77 [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    src.core.database:database.py:87 Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
-------------------------- Captured stdout teardown ---------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
-------------------------- Captured stderr teardown ---------------------------
2026-02-03 22:29:34.914 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:34.914 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:34.914 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:34.914 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:34.914 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:34.914 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:34.914 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:34.914 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:34.914 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:34.914 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:34.914 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:34.914 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
---------------------------- Captured log teardown ----------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
_______ TestRecetteServiceExpanded.test_recette_filtering_by_difficulte _______
.venv\Lib\site-packages\streamlit\elements\spinner.py:116: in spinner
    create_transient, clear_transient = self.dg._transient(
.venv\Lib\site-packages\streamlit\delta_generator.py:636: in _transient
    transient_cursor = self._get_transient_cursor()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\delta_generator.py:441: in _get_transient_cursor
    raise NoSessionContext("Cursor is not set")
E   streamlit.errors.NoSessionContext: Cursor is not set

During handling of the above exception, another exception occurred:
tests\integration\test_phase_16_expanded.py:73: in test_recette_filtering_by_difficulte
    with get_db_context() as session:
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src\core\database.py:149: in obtenir_contexte_db
    fabrique = obtenir_fabrique_session()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:120: in obtenir_fabrique_session
    moteur = obtenir_moteur()
             ^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:281: in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:326: in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:385: in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:88: in obtenir_moteur
    raise ErreurBaseDeDonnees(
E   src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found
E   
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stdout setup ----------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
---------------------------- Captured stderr setup ----------------------------
2026-02-03 22:29:34.916 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:34.916 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:34.916 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:34.916 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:34.916 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:34.916 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:34.916 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:34.916 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:34.916 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:34.916 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:34.916 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:34.916 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
----------------------------- Captured log setup ------------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m | src.core.config           | [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[31mERROR[0m | src.core.database         | Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stderr call -----------------------------
2026-02-03 22:29:34.918 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
------------------------------ Captured log call ------------------------------
INFO     src.core.config:config.py:490 [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
WARNING  src.core.database:database.py:77 [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    src.core.database:database.py:87 Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
-------------------------- Captured stdout teardown ---------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
-------------------------- Captured stderr teardown ---------------------------
2026-02-03 22:29:40.824 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:40.824 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:40.824 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:40.824 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:40.824 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:40.825 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:40.825 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:40.825 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:40.825 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:40.825 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:40.825 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:40.825 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
---------------------------- Captured log teardown ----------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
___________ TestRecetteServiceExpanded.test_recette_update_and_save ___________
.venv\Lib\site-packages\streamlit\elements\spinner.py:116: in spinner
    create_transient, clear_transient = self.dg._transient(
.venv\Lib\site-packages\streamlit\delta_generator.py:636: in _transient
    transient_cursor = self._get_transient_cursor()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\delta_generator.py:441: in _get_transient_cursor
    raise NoSessionContext("Cursor is not set")
E   streamlit.errors.NoSessionContext: Cursor is not set

During handling of the above exception, another exception occurred:
tests\integration\test_phase_16_expanded.py:98: in test_recette_update_and_save
    with get_db_context() as session:
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src\core\database.py:149: in obtenir_contexte_db
    fabrique = obtenir_fabrique_session()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:120: in obtenir_fabrique_session
    moteur = obtenir_moteur()
             ^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:281: in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:326: in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:385: in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:88: in obtenir_moteur
    raise ErreurBaseDeDonnees(
E   src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found
E   
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stdout setup ----------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
---------------------------- Captured stderr setup ----------------------------
2026-02-03 22:29:40.826 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:40.826 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:40.826 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:40.826 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:40.826 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:40.826 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:40.826 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:40.826 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:40.826 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:40.826 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:40.826 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:40.826 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
----------------------------- Captured log setup ------------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m | src.core.config           | [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[31mERROR[0m | src.core.database         | Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stderr call -----------------------------
2026-02-03 22:29:40.828 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
------------------------------ Captured log call ------------------------------
INFO     src.core.config:config.py:490 [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
WARNING  src.core.database:database.py:77 [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    src.core.database:database.py:87 Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
-------------------------- Captured stdout teardown ---------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
-------------------------- Captured stderr teardown ---------------------------
2026-02-03 22:29:45.447 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:45.447 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:45.447 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:45.447 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:45.447 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:45.447 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:45.447 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:45.447 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:45.447 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:45.447 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:45.447 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:45.448 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
---------------------------- Captured log teardown ----------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
_______________ TestRecetteServiceExpanded.test_recette_delete ________________
.venv\Lib\site-packages\streamlit\elements\spinner.py:116: in spinner
    create_transient, clear_transient = self.dg._transient(
.venv\Lib\site-packages\streamlit\delta_generator.py:636: in _transient
    transient_cursor = self._get_transient_cursor()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\delta_generator.py:441: in _get_transient_cursor
    raise NoSessionContext("Cursor is not set")
E   streamlit.errors.NoSessionContext: Cursor is not set

During handling of the above exception, another exception occurred:
tests\integration\test_phase_16_expanded.py:120: in test_recette_delete
    with get_db_context() as session:
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src\core\database.py:149: in obtenir_contexte_db
    fabrique = obtenir_fabrique_session()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:120: in obtenir_fabrique_session
    moteur = obtenir_moteur()
             ^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:281: in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:326: in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:385: in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:88: in obtenir_moteur
    raise ErreurBaseDeDonnees(
E   src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found
E   
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stdout setup ----------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
---------------------------- Captured stderr setup ----------------------------
2026-02-03 22:29:45.448 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:45.449 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:45.449 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:45.449 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:45.449 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:45.449 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:45.449 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:45.449 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:45.449 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:45.449 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:45.449 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:45.449 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
----------------------------- Captured log setup ------------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m | src.core.config           | [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[31mERROR[0m | src.core.database         | Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stderr call -----------------------------
2026-02-03 22:29:45.451 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
------------------------------ Captured log call ------------------------------
INFO     src.core.config:config.py:490 [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
WARNING  src.core.database:database.py:77 [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    src.core.database:database.py:87 Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
-------------------------- Captured stdout teardown ---------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
-------------------------- Captured stderr teardown ---------------------------
2026-02-03 22:29:50.185 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:50.185 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:50.185 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:50.185 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:50.185 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:50.185 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:50.185 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:50.185 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:50.185 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:50.186 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:50.186 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:50.186 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
---------------------------- Captured log teardown ----------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
____________ TestPlanningServiceExpanded.test_planning_create_week ____________
.venv\Lib\site-packages\streamlit\elements\spinner.py:116: in spinner
    create_transient, clear_transient = self.dg._transient(
.venv\Lib\site-packages\streamlit\delta_generator.py:636: in _transient
    transient_cursor = self._get_transient_cursor()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\delta_generator.py:441: in _get_transient_cursor
    raise NoSessionContext("Cursor is not set")
E   streamlit.errors.NoSessionContext: Cursor is not set

During handling of the above exception, another exception occurred:
tests\integration\test_phase_16_expanded.py:146: in test_planning_create_week
    with get_db_context() as session:
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src\core\database.py:149: in obtenir_contexte_db
    fabrique = obtenir_fabrique_session()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:120: in obtenir_fabrique_session
    moteur = obtenir_moteur()
             ^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:281: in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:326: in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:385: in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:88: in obtenir_moteur
    raise ErreurBaseDeDonnees(
E   src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found
E   
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stdout setup ----------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
---------------------------- Captured stderr setup ----------------------------
2026-02-03 22:29:50.187 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:50.187 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:50.187 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:50.187 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:50.187 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:50.187 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:50.187 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:50.187 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:50.187 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:50.187 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:50.187 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:50.187 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
----------------------------- Captured log setup ------------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m | src.core.config           | [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[31mERROR[0m | src.core.database         | Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stderr call -----------------------------
2026-02-03 22:29:50.189 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
------------------------------ Captured log call ------------------------------
INFO     src.core.config:config.py:490 [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
WARNING  src.core.database:database.py:77 [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    src.core.database:database.py:87 Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
-------------------------- Captured stdout teardown ---------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
-------------------------- Captured stderr teardown ---------------------------
2026-02-03 22:29:54.825 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:54.825 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:54.825 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:54.825 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:54.825 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:54.825 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:54.825 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:54.825 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:54.825 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:54.825 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:54.825 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:54.825 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
---------------------------- Captured log teardown ----------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
_______ TestPlanningServiceExpanded.test_planning_with_multiple_recipes _______
.venv\Lib\site-packages\streamlit\elements\spinner.py:116: in spinner
    create_transient, clear_transient = self.dg._transient(
.venv\Lib\site-packages\streamlit\delta_generator.py:636: in _transient
    transient_cursor = self._get_transient_cursor()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\delta_generator.py:441: in _get_transient_cursor
    raise NoSessionContext("Cursor is not set")
E   streamlit.errors.NoSessionContext: Cursor is not set

During handling of the above exception, another exception occurred:
tests\integration\test_phase_16_expanded.py:167: in test_planning_with_multiple_recipes
    with get_db_context() as session:
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src\core\database.py:149: in obtenir_contexte_db
    fabrique = obtenir_fabrique_session()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:120: in obtenir_fabrique_session
    moteur = obtenir_moteur()
             ^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:281: in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:326: in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:385: in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:88: in obtenir_moteur
    raise ErreurBaseDeDonnees(
E   src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found
E   
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stdout setup ----------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
---------------------------- Captured stderr setup ----------------------------
2026-02-03 22:29:54.826 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:54.826 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:54.827 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:54.827 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:54.827 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:54.827 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:54.827 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:54.827 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:54.827 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:54.827 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:54.827 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:29:54.827 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
----------------------------- Captured log setup ------------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m | src.core.config           | [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[31mERROR[0m | src.core.database         | Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stderr call -----------------------------
2026-02-03 22:29:54.829 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
------------------------------ Captured log call ------------------------------
INFO     src.core.config:config.py:490 [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
WARNING  src.core.database:database.py:77 [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    src.core.database:database.py:87 Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
-------------------------- Captured stdout teardown ---------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
-------------------------- Captured stderr teardown ---------------------------
2026-02-03 22:30:00.037 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:00.037 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:00.037 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:00.037 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:00.037 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:00.037 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:00.037 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:00.037 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:00.037 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:00.037 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:00.037 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:00.037 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
---------------------------- Captured log teardown ----------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
________ TestPlanningServiceExpanded.test_planning_auto_generated_flag ________
.venv\Lib\site-packages\streamlit\elements\spinner.py:116: in spinner
    create_transient, clear_transient = self.dg._transient(
.venv\Lib\site-packages\streamlit\delta_generator.py:636: in _transient
    transient_cursor = self._get_transient_cursor()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\delta_generator.py:441: in _get_transient_cursor
    raise NoSessionContext("Cursor is not set")
E   streamlit.errors.NoSessionContext: Cursor is not set

During handling of the above exception, another exception occurred:
tests\integration\test_phase_16_expanded.py:205: in test_planning_auto_generated_flag
    with get_db_context() as session:
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src\core\database.py:149: in obtenir_contexte_db
    fabrique = obtenir_fabrique_session()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:120: in obtenir_fabrique_session
    moteur = obtenir_moteur()
             ^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:281: in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:326: in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:385: in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:88: in obtenir_moteur
    raise ErreurBaseDeDonnees(
E   src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found
E   
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stdout setup ----------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
---------------------------- Captured stderr setup ----------------------------
2026-02-03 22:30:00.038 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:00.038 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:00.038 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:00.038 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:00.039 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:00.039 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:00.039 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:00.039 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:00.039 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:00.039 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:00.039 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:00.039 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
----------------------------- Captured log setup ------------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m | src.core.config           | [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[31mERROR[0m | src.core.database         | Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stderr call -----------------------------
2026-02-03 22:30:00.041 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
------------------------------ Captured log call ------------------------------
INFO     src.core.config:config.py:490 [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
WARNING  src.core.database:database.py:77 [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    src.core.database:database.py:87 Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
-------------------------- Captured stdout teardown ---------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
-------------------------- Captured stderr teardown ---------------------------
2026-02-03 22:30:04.981 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:04.981 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:04.981 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:04.981 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:04.981 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:04.981 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:04.981 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:04.982 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:04.982 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:04.982 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:04.982 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:04.982 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
---------------------------- Captured log teardown ----------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
______ TestPlanningServiceExpanded.test_planning_date_overlap_detection _______
.venv\Lib\site-packages\streamlit\elements\spinner.py:116: in spinner
    create_transient, clear_transient = self.dg._transient(
.venv\Lib\site-packages\streamlit\delta_generator.py:636: in _transient
    transient_cursor = self._get_transient_cursor()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\delta_generator.py:441: in _get_transient_cursor
    raise NoSessionContext("Cursor is not set")
E   streamlit.errors.NoSessionContext: Cursor is not set

During handling of the above exception, another exception occurred:
tests\integration\test_phase_16_expanded.py:231: in test_planning_date_overlap_detection
    with get_db_context() as session:
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src\core\database.py:149: in obtenir_contexte_db
    fabrique = obtenir_fabrique_session()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:120: in obtenir_fabrique_session
    moteur = obtenir_moteur()
             ^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:281: in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:326: in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:385: in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:88: in obtenir_moteur
    raise ErreurBaseDeDonnees(
E   src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found
E   
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stdout setup ----------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
---------------------------- Captured stderr setup ----------------------------
2026-02-03 22:30:04.983 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:04.983 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:04.983 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:04.983 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:04.983 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:04.983 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:04.983 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:04.983 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:04.983 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:04.983 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:04.983 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:04.983 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
----------------------------- Captured log setup ------------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m | src.core.config           | [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[31mERROR[0m | src.core.database         | Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stderr call -----------------------------
2026-02-03 22:30:04.985 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
------------------------------ Captured log call ------------------------------
INFO     src.core.config:config.py:490 [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
WARNING  src.core.database:database.py:77 [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    src.core.database:database.py:87 Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
-------------------------- Captured stdout teardown ---------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
-------------------------- Captured stderr teardown ---------------------------
2026-02-03 22:30:09.592 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:09.592 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:09.592 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:09.592 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:09.592 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:09.592 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:09.592 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:09.592 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:09.592 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:09.592 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:09.592 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:09.592 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
---------------------------- Captured log teardown ----------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
___________ TestCoursesServiceExpanded.test_article_courses_create ____________
.venv\Lib\site-packages\streamlit\elements\spinner.py:116: in spinner
    create_transient, clear_transient = self.dg._transient(
.venv\Lib\site-packages\streamlit\delta_generator.py:636: in _transient
    transient_cursor = self._get_transient_cursor()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\delta_generator.py:441: in _get_transient_cursor
    raise NoSessionContext("Cursor is not set")
E   streamlit.errors.NoSessionContext: Cursor is not set

During handling of the above exception, another exception occurred:
tests\integration\test_phase_16_expanded.py:256: in test_article_courses_create
    with get_db_context() as session:
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src\core\database.py:149: in obtenir_contexte_db
    fabrique = obtenir_fabrique_session()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:120: in obtenir_fabrique_session
    moteur = obtenir_moteur()
             ^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:281: in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:326: in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:385: in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:88: in obtenir_moteur
    raise ErreurBaseDeDonnees(
E   src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found
E   
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stdout setup ----------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
---------------------------- Captured stderr setup ----------------------------
2026-02-03 22:30:09.593 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:09.593 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:09.593 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:09.593 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:09.593 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:09.594 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:09.594 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:09.594 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:09.594 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:09.594 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:09.594 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:09.594 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
----------------------------- Captured log setup ------------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m | src.core.config           | [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[31mERROR[0m | src.core.database         | Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stderr call -----------------------------
2026-02-03 22:30:09.595 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
------------------------------ Captured log call ------------------------------
INFO     src.core.config:config.py:490 [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
WARNING  src.core.database:database.py:77 [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    src.core.database:database.py:87 Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
-------------------------- Captured stdout teardown ---------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
-------------------------- Captured stderr teardown ---------------------------
2026-02-03 22:30:14.341 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:14.341 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:14.341 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:14.341 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:14.341 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:14.341 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:14.341 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:14.341 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:14.341 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:14.341 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:14.341 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:14.341 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
---------------------------- Captured log teardown ----------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
_______ TestCoursesServiceExpanded.test_article_courses_mark_purchased ________
.venv\Lib\site-packages\streamlit\elements\spinner.py:116: in spinner
    create_transient, clear_transient = self.dg._transient(
.venv\Lib\site-packages\streamlit\delta_generator.py:636: in _transient
    transient_cursor = self._get_transient_cursor()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\delta_generator.py:441: in _get_transient_cursor
    raise NoSessionContext("Cursor is not set")
E   streamlit.errors.NoSessionContext: Cursor is not set

During handling of the above exception, another exception occurred:
tests\integration\test_phase_16_expanded.py:283: in test_article_courses_mark_purchased
    with get_db_context() as session:
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src\core\database.py:149: in obtenir_contexte_db
    fabrique = obtenir_fabrique_session()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:120: in obtenir_fabrique_session
    moteur = obtenir_moteur()
             ^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:281: in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:326: in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:385: in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:88: in obtenir_moteur
    raise ErreurBaseDeDonnees(
E   src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found
E   
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stdout setup ----------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
---------------------------- Captured stderr setup ----------------------------
2026-02-03 22:30:14.342 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:14.342 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:14.342 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:14.342 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:14.343 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:14.343 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:14.343 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:14.343 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:14.343 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:14.343 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:14.343 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:14.343 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
----------------------------- Captured log setup ------------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m | src.core.config           | [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[31mERROR[0m | src.core.database         | Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stderr call -----------------------------
2026-02-03 22:30:14.345 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
------------------------------ Captured log call ------------------------------
INFO     src.core.config:config.py:490 [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
WARNING  src.core.database:database.py:77 [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    src.core.database:database.py:87 Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
-------------------------- Captured stdout teardown ---------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
-------------------------- Captured stderr teardown ---------------------------
2026-02-03 22:30:19.652 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:19.652 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:19.652 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:19.652 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:19.652 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:19.652 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:19.652 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:19.652 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:19.652 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:19.652 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:19.652 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:19.652 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
---------------------------- Captured log teardown ----------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
_________ TestCoursesServiceExpanded.test_article_courses_by_category _________
.venv\Lib\site-packages\streamlit\elements\spinner.py:116: in spinner
    create_transient, clear_transient = self.dg._transient(
.venv\Lib\site-packages\streamlit\delta_generator.py:636: in _transient
    transient_cursor = self._get_transient_cursor()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\delta_generator.py:441: in _get_transient_cursor
    raise NoSessionContext("Cursor is not set")
E   streamlit.errors.NoSessionContext: Cursor is not set

During handling of the above exception, another exception occurred:
tests\integration\test_phase_16_expanded.py:306: in test_article_courses_by_category
    with get_db_context() as session:
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src\core\database.py:149: in obtenir_contexte_db
    fabrique = obtenir_fabrique_session()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:120: in obtenir_fabrique_session
    moteur = obtenir_moteur()
             ^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:281: in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:326: in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:385: in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:88: in obtenir_moteur
    raise ErreurBaseDeDonnees(
E   src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found
E   
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stdout setup ----------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
---------------------------- Captured stderr setup ----------------------------
2026-02-03 22:30:19.653 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:19.653 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:19.653 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:19.653 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:19.653 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:19.653 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:19.653 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:19.653 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:19.653 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:19.653 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:19.654 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:19.654 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
----------------------------- Captured log setup ------------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m | src.core.config           | [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[31mERROR[0m | src.core.database         | Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stderr call -----------------------------
2026-02-03 22:30:19.655 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
------------------------------ Captured log call ------------------------------
INFO     src.core.config:config.py:490 [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
WARNING  src.core.database:database.py:77 [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    src.core.database:database.py:87 Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
-------------------------- Captured stdout teardown ---------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
-------------------------- Captured stderr teardown ---------------------------
2026-02-03 22:30:24.664 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:24.664 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:24.664 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:24.664 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:24.664 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:24.664 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:24.665 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:24.665 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:24.665 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:24.665 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:24.665 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:24.665 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
---------------------------- Captured log teardown ----------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
_______ TestCoursesServiceExpanded.test_article_courses_essential_items _______
.venv\Lib\site-packages\streamlit\elements\spinner.py:116: in spinner
    create_transient, clear_transient = self.dg._transient(
.venv\Lib\site-packages\streamlit\delta_generator.py:636: in _transient
    transient_cursor = self._get_transient_cursor()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\delta_generator.py:441: in _get_transient_cursor
    raise NoSessionContext("Cursor is not set")
E   streamlit.errors.NoSessionContext: Cursor is not set

During handling of the above exception, another exception occurred:
tests\integration\test_phase_16_expanded.py:341: in test_article_courses_essential_items
    with get_db_context() as session:
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src\core\database.py:149: in obtenir_contexte_db
    fabrique = obtenir_fabrique_session()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:120: in obtenir_fabrique_session
    moteur = obtenir_moteur()
             ^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:281: in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:326: in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:385: in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:88: in obtenir_moteur
    raise ErreurBaseDeDonnees(
E   src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found
E   
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stdout setup ----------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
---------------------------- Captured stderr setup ----------------------------
2026-02-03 22:30:24.666 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:24.666 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:24.666 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:24.666 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:24.667 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:24.667 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:24.667 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:24.667 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:24.667 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:24.667 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:24.667 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:24.667 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
----------------------------- Captured log setup ------------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m | src.core.config           | [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[31mERROR[0m | src.core.database         | Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stderr call -----------------------------
2026-02-03 22:30:24.669 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
------------------------------ Captured log call ------------------------------
INFO     src.core.config:config.py:490 [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
WARNING  src.core.database:database.py:77 [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    src.core.database:database.py:87 Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
-------------------------- Captured stdout teardown ---------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
-------------------------- Captured stderr teardown ---------------------------
2026-02-03 22:30:29.589 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:29.589 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:29.589 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:29.589 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:29.589 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:29.589 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:29.589 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:29.589 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:29.589 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:29.589 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:29.589 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:29.589 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
---------------------------- Captured log teardown ----------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
________ TestInventaireServiceExpanded.test_article_inventaire_create _________
.venv\Lib\site-packages\streamlit\elements\spinner.py:116: in spinner
    create_transient, clear_transient = self.dg._transient(
.venv\Lib\site-packages\streamlit\delta_generator.py:636: in _transient
    transient_cursor = self._get_transient_cursor()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\delta_generator.py:441: in _get_transient_cursor
    raise NoSessionContext("Cursor is not set")
E   streamlit.errors.NoSessionContext: Cursor is not set

During handling of the above exception, another exception occurred:
tests\integration\test_phase_16_expanded.py:384: in test_article_inventaire_create
    with get_db_context() as session:
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src\core\database.py:149: in obtenir_contexte_db
    fabrique = obtenir_fabrique_session()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:120: in obtenir_fabrique_session
    moteur = obtenir_moteur()
             ^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:281: in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:326: in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:385: in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:88: in obtenir_moteur
    raise ErreurBaseDeDonnees(
E   src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found
E   
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stdout setup ----------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
---------------------------- Captured stderr setup ----------------------------
2026-02-03 22:30:29.590 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:29.590 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:29.590 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:29.590 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:29.591 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:29.591 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:29.591 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:29.591 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:29.591 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:29.591 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:29.591 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:29.591 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
----------------------------- Captured log setup ------------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m | src.core.config           | [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[31mERROR[0m | src.core.database         | Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stderr call -----------------------------
2026-02-03 22:30:29.592 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
------------------------------ Captured log call ------------------------------
INFO     src.core.config:config.py:490 [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
WARNING  src.core.database:database.py:77 [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    src.core.database:database.py:87 Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
-------------------------- Captured stdout teardown ---------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
-------------------------- Captured stderr teardown ---------------------------
2026-02-03 22:30:34.449 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:34.449 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:34.449 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:34.449 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:34.449 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:34.449 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:34.449 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:34.449 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:34.450 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:34.450 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:34.450 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:34.450 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
---------------------------- Captured log teardown ----------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
____ TestInventaireServiceExpanded.test_article_inventaire_low_stock_alert ____
.venv\Lib\site-packages\streamlit\elements\spinner.py:116: in spinner
    create_transient, clear_transient = self.dg._transient(
.venv\Lib\site-packages\streamlit\delta_generator.py:636: in _transient
    transient_cursor = self._get_transient_cursor()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\delta_generator.py:441: in _get_transient_cursor
    raise NoSessionContext("Cursor is not set")
E   streamlit.errors.NoSessionContext: Cursor is not set

During handling of the above exception, another exception occurred:
tests\integration\test_phase_16_expanded.py:405: in test_article_inventaire_low_stock_alert
    with get_db_context() as session:
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src\core\database.py:149: in obtenir_contexte_db
    fabrique = obtenir_fabrique_session()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:120: in obtenir_fabrique_session
    moteur = obtenir_moteur()
             ^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:281: in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:326: in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:385: in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:88: in obtenir_moteur
    raise ErreurBaseDeDonnees(
E   src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found
E   
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stdout setup ----------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
---------------------------- Captured stderr setup ----------------------------
2026-02-03 22:30:34.451 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:34.451 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:34.451 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:34.451 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:34.451 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:34.451 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:34.451 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:34.451 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:34.451 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:34.451 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:34.451 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:34.451 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
----------------------------- Captured log setup ------------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m | src.core.config           | [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[31mERROR[0m | src.core.database         | Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stderr call -----------------------------
2026-02-03 22:30:34.453 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
------------------------------ Captured log call ------------------------------
INFO     src.core.config:config.py:490 [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
WARNING  src.core.database:database.py:77 [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    src.core.database:database.py:87 Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
-------------------------- Captured stdout teardown ---------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
-------------------------- Captured stderr teardown ---------------------------
2026-02-03 22:30:41.084 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:41.084 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:41.084 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:41.084 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:41.084 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:41.084 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:41.084 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:41.084 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:41.084 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:41.084 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:41.084 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:41.084 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
---------------------------- Captured log teardown ----------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
____ TestInventaireServiceExpanded.test_article_inventaire_update_quantity ____
.venv\Lib\site-packages\streamlit\elements\spinner.py:116: in spinner
    create_transient, clear_transient = self.dg._transient(
.venv\Lib\site-packages\streamlit\delta_generator.py:636: in _transient
    transient_cursor = self._get_transient_cursor()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\delta_generator.py:441: in _get_transient_cursor
    raise NoSessionContext("Cursor is not set")
E   streamlit.errors.NoSessionContext: Cursor is not set

During handling of the above exception, another exception occurred:
tests\integration\test_phase_16_expanded.py:437: in test_article_inventaire_update_quantity
    with get_db_context() as session:
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src\core\database.py:149: in obtenir_contexte_db
    fabrique = obtenir_fabrique_session()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:120: in obtenir_fabrique_session
    moteur = obtenir_moteur()
             ^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:281: in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:326: in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:385: in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:88: in obtenir_moteur
    raise ErreurBaseDeDonnees(
E   src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found
E   
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stdout setup ----------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
---------------------------- Captured stderr setup ----------------------------
2026-02-03 22:30:41.085 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:41.085 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:41.085 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:41.085 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:41.086 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:41.086 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:41.086 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:41.086 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:41.086 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:41.086 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:41.086 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:41.086 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
----------------------------- Captured log setup ------------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m | src.core.config           | [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[31mERROR[0m | src.core.database         | Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stderr call -----------------------------
2026-02-03 22:30:41.088 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
------------------------------ Captured log call ------------------------------
INFO     src.core.config:config.py:490 [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
WARNING  src.core.database:database.py:77 [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    src.core.database:database.py:87 Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
-------------------------- Captured stdout teardown ---------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
-------------------------- Captured stderr teardown ---------------------------
2026-02-03 22:30:45.844 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:45.844 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:45.844 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:45.844 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:45.845 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:45.845 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:45.845 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:45.845 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:45.845 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:45.845 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:45.845 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:45.845 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
---------------------------- Captured log teardown ----------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
_______ TestInventaireServiceExpanded.test_article_inventaire_locations _______
.venv\Lib\site-packages\streamlit\elements\spinner.py:116: in spinner
    create_transient, clear_transient = self.dg._transient(
.venv\Lib\site-packages\streamlit\delta_generator.py:636: in _transient
    transient_cursor = self._get_transient_cursor()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\delta_generator.py:441: in _get_transient_cursor
    raise NoSessionContext("Cursor is not set")
E   streamlit.errors.NoSessionContext: Cursor is not set

During handling of the above exception, another exception occurred:
tests\integration\test_phase_16_expanded.py:461: in test_article_inventaire_locations
    with get_db_context() as session:
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src\core\database.py:149: in obtenir_contexte_db
    fabrique = obtenir_fabrique_session()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:120: in obtenir_fabrique_session
    moteur = obtenir_moteur()
             ^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:281: in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:326: in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:385: in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:88: in obtenir_moteur
    raise ErreurBaseDeDonnees(
E   src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found
E   
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stdout setup ----------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
---------------------------- Captured stderr setup ----------------------------
2026-02-03 22:30:45.846 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:45.846 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:45.846 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:45.846 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:45.846 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:45.846 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:45.846 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:45.846 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:45.846 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:45.846 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:45.846 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:45.847 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
----------------------------- Captured log setup ------------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m | src.core.config           | [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[31mERROR[0m | src.core.database         | Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stderr call -----------------------------
2026-02-03 22:30:45.848 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
------------------------------ Captured log call ------------------------------
INFO     src.core.config:config.py:490 [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
WARNING  src.core.database:database.py:77 [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    src.core.database:database.py:87 Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
-------------------------- Captured stdout teardown ---------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
-------------------------- Captured stderr teardown ---------------------------
2026-02-03 22:30:50.492 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:50.492 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:50.492 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:50.492 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:50.492 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:50.492 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:50.492 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:50.492 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:50.492 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:50.492 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:50.492 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:50.492 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
---------------------------- Captured log teardown ----------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
____ TestInventaireServiceExpanded.test_article_inventaire_with_historique ____
.venv\Lib\site-packages\streamlit\elements\spinner.py:116: in spinner
    create_transient, clear_transient = self.dg._transient(
.venv\Lib\site-packages\streamlit\delta_generator.py:636: in _transient
    transient_cursor = self._get_transient_cursor()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\delta_generator.py:441: in _get_transient_cursor
    raise NoSessionContext("Cursor is not set")
E   streamlit.errors.NoSessionContext: Cursor is not set

During handling of the above exception, another exception occurred:
tests\integration\test_phase_16_expanded.py:489: in test_article_inventaire_with_historique
    with get_db_context() as session:
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src\core\database.py:149: in obtenir_contexte_db
    fabrique = obtenir_fabrique_session()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:120: in obtenir_fabrique_session
    moteur = obtenir_moteur()
             ^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:281: in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:326: in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:385: in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:88: in obtenir_moteur
    raise ErreurBaseDeDonnees(
E   src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found
E   
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stdout setup ----------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
---------------------------- Captured stderr setup ----------------------------
2026-02-03 22:30:50.493 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:50.493 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:50.493 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:50.493 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:50.493 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:50.493 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:50.493 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:50.494 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:50.494 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:50.494 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:50.494 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:50.494 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
----------------------------- Captured log setup ------------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m | src.core.config           | [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[31mERROR[0m | src.core.database         | Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stderr call -----------------------------
2026-02-03 22:30:50.495 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
------------------------------ Captured log call ------------------------------
INFO     src.core.config:config.py:490 [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
WARNING  src.core.database:database.py:77 [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    src.core.database:database.py:87 Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
-------------------------- Captured stdout teardown ---------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
-------------------------- Captured stderr teardown ---------------------------
2026-02-03 22:30:55.274 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:55.274 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:55.274 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:55.274 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:55.274 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:55.275 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:55.275 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:55.275 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:55.275 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:55.275 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:55.275 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:55.275 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
---------------------------- Captured log teardown ----------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
__________ TestDomainRecetteComplex.test_recette_seasonal_variations __________
.venv\Lib\site-packages\streamlit\elements\spinner.py:116: in spinner
    create_transient, clear_transient = self.dg._transient(
.venv\Lib\site-packages\streamlit\delta_generator.py:636: in _transient
    transient_cursor = self._get_transient_cursor()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\delta_generator.py:441: in _get_transient_cursor
    raise NoSessionContext("Cursor is not set")
E   streamlit.errors.NoSessionContext: Cursor is not set

During handling of the above exception, another exception occurred:
tests\integration\test_phase_16_expanded.py:534: in test_recette_seasonal_variations
    with get_db_context() as session:
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src\core\database.py:149: in obtenir_contexte_db
    fabrique = obtenir_fabrique_session()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:120: in obtenir_fabrique_session
    moteur = obtenir_moteur()
             ^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:281: in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:326: in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:385: in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:88: in obtenir_moteur
    raise ErreurBaseDeDonnees(
E   src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found
E   
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stdout setup ----------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
---------------------------- Captured stderr setup ----------------------------
2026-02-03 22:30:55.276 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:55.276 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:55.276 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:55.276 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:55.276 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:55.276 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:55.276 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:55.276 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:55.276 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:55.276 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:55.276 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:55.276 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
----------------------------- Captured log setup ------------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m | src.core.config           | [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[31mERROR[0m | src.core.database         | Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stderr call -----------------------------
2026-02-03 22:30:55.278 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
------------------------------ Captured log call ------------------------------
INFO     src.core.config:config.py:490 [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
WARNING  src.core.database:database.py:77 [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    src.core.database:database.py:87 Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
-------------------------- Captured stdout teardown ---------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
-------------------------- Captured stderr teardown ---------------------------
2026-02-03 22:30:59.904 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:59.904 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:59.904 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:59.904 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:59.904 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:59.904 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:59.904 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:59.904 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:59.905 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:59.905 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:59.905 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:59.905 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
---------------------------- Captured log teardown ----------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
___________ TestDomainRecetteComplex.test_recette_diet_restrictions ___________
.venv\Lib\site-packages\streamlit\elements\spinner.py:116: in spinner
    create_transient, clear_transient = self.dg._transient(
.venv\Lib\site-packages\streamlit\delta_generator.py:636: in _transient
    transient_cursor = self._get_transient_cursor()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\delta_generator.py:441: in _get_transient_cursor
    raise NoSessionContext("Cursor is not set")
E   streamlit.errors.NoSessionContext: Cursor is not set

During handling of the above exception, another exception occurred:
tests\integration\test_phase_16_expanded.py:560: in test_recette_diet_restrictions
    with get_db_context() as session:
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src\core\database.py:149: in obtenir_contexte_db
    fabrique = obtenir_fabrique_session()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:120: in obtenir_fabrique_session
    moteur = obtenir_moteur()
             ^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:281: in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:326: in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:385: in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:88: in obtenir_moteur
    raise ErreurBaseDeDonnees(
E   src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found
E   
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stdout setup ----------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
---------------------------- Captured stderr setup ----------------------------
2026-02-03 22:30:59.906 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:59.906 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:59.906 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:59.906 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:59.906 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:59.906 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:59.906 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:59.906 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:59.906 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:59.907 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:59.907 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:30:59.907 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
----------------------------- Captured log setup ------------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m | src.core.config           | [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[31mERROR[0m | src.core.database         | Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stderr call -----------------------------
2026-02-03 22:30:59.908 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
------------------------------ Captured log call ------------------------------
INFO     src.core.config:config.py:490 [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
WARNING  src.core.database:database.py:77 [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    src.core.database:database.py:87 Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
-------------------------- Captured stdout teardown ---------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
-------------------------- Captured stderr teardown ---------------------------
2026-02-03 22:31:04.551 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:04.551 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:04.551 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:04.551 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:04.551 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:04.551 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:04.551 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:04.551 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:04.551 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:04.551 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:04.551 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:04.551 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
---------------------------- Captured log teardown ----------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
___________ TestDomainRecetteComplex.test_recette_cost_calculation ____________
.venv\Lib\site-packages\streamlit\elements\spinner.py:116: in spinner
    create_transient, clear_transient = self.dg._transient(
.venv\Lib\site-packages\streamlit\delta_generator.py:636: in _transient
    transient_cursor = self._get_transient_cursor()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\delta_generator.py:441: in _get_transient_cursor
    raise NoSessionContext("Cursor is not set")
E   streamlit.errors.NoSessionContext: Cursor is not set

During handling of the above exception, another exception occurred:
tests\integration\test_phase_16_expanded.py:586: in test_recette_cost_calculation
    with get_db_context() as session:
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src\core\database.py:149: in obtenir_contexte_db
    fabrique = obtenir_fabrique_session()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:120: in obtenir_fabrique_session
    moteur = obtenir_moteur()
             ^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:281: in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:326: in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:385: in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:88: in obtenir_moteur
    raise ErreurBaseDeDonnees(
E   src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found
E   
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stdout setup ----------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
---------------------------- Captured stderr setup ----------------------------
2026-02-03 22:31:04.552 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:04.552 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:04.552 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:04.552 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:04.552 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:04.553 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:04.553 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:04.553 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:04.553 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:04.553 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:04.553 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:04.553 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
----------------------------- Captured log setup ------------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m | src.core.config           | [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[31mERROR[0m | src.core.database         | Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stderr call -----------------------------
2026-02-03 22:31:04.554 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
------------------------------ Captured log call ------------------------------
INFO     src.core.config:config.py:490 [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
WARNING  src.core.database:database.py:77 [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    src.core.database:database.py:87 Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
-------------------------- Captured stdout teardown ---------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
-------------------------- Captured stderr teardown ---------------------------
2026-02-03 22:31:09.541 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:09.541 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:09.541 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:09.541 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:09.541 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:09.541 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:09.541 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:09.541 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:09.541 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:09.542 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:09.542 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:09.542 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
---------------------------- Captured log teardown ----------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
______ TestDomainPlanningComplex.test_planning_weekly_nutrition_balance _______
.venv\Lib\site-packages\streamlit\elements\spinner.py:116: in spinner
    create_transient, clear_transient = self.dg._transient(
.venv\Lib\site-packages\streamlit\delta_generator.py:636: in _transient
    transient_cursor = self._get_transient_cursor()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\delta_generator.py:441: in _get_transient_cursor
    raise NoSessionContext("Cursor is not set")
E   streamlit.errors.NoSessionContext: Cursor is not set

During handling of the above exception, another exception occurred:
tests\integration\test_phase_16_expanded.py:607: in test_planning_weekly_nutrition_balance
    with get_db_context() as session:
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src\core\database.py:149: in obtenir_contexte_db
    fabrique = obtenir_fabrique_session()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:120: in obtenir_fabrique_session
    moteur = obtenir_moteur()
             ^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:281: in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:326: in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:385: in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:88: in obtenir_moteur
    raise ErreurBaseDeDonnees(
E   src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found
E   
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stdout setup ----------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
---------------------------- Captured stderr setup ----------------------------
2026-02-03 22:31:09.543 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:09.543 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:09.543 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:09.543 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:09.543 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:09.543 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:09.543 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:09.543 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:09.543 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:09.543 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:09.543 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:09.543 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
----------------------------- Captured log setup ------------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m | src.core.config           | [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[31mERROR[0m | src.core.database         | Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stderr call -----------------------------
2026-02-03 22:31:09.545 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
------------------------------ Captured log call ------------------------------
INFO     src.core.config:config.py:490 [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
WARNING  src.core.database:database.py:77 [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    src.core.database:database.py:87 Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
-------------------------- Captured stdout teardown ---------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
-------------------------- Captured stderr teardown ---------------------------
2026-02-03 22:31:14.183 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:14.183 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:14.183 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:14.183 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:14.183 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:14.183 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:14.183 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:14.183 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:14.183 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:14.183 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:14.183 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:14.183 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
---------------------------- Captured log teardown ----------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
________ TestDomainShoppingComplex.test_shopping_list_budget_tracking _________
.venv\Lib\site-packages\streamlit\elements\spinner.py:116: in spinner
    create_transient, clear_transient = self.dg._transient(
.venv\Lib\site-packages\streamlit\delta_generator.py:636: in _transient
    transient_cursor = self._get_transient_cursor()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\delta_generator.py:441: in _get_transient_cursor
    raise NoSessionContext("Cursor is not set")
E   streamlit.errors.NoSessionContext: Cursor is not set

During handling of the above exception, another exception occurred:
tests\integration\test_phase_16_expanded.py:650: in test_shopping_list_budget_tracking
    with get_db_context() as session:
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src\core\database.py:149: in obtenir_contexte_db
    fabrique = obtenir_fabrique_session()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:120: in obtenir_fabrique_session
    moteur = obtenir_moteur()
             ^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:281: in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:326: in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:385: in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:88: in obtenir_moteur
    raise ErreurBaseDeDonnees(
E   src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found
E   
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stdout setup ----------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
---------------------------- Captured stderr setup ----------------------------
2026-02-03 22:31:14.184 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:14.184 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:14.185 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:14.185 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:14.185 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:14.185 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:14.185 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:14.185 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:14.185 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:14.185 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:14.185 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:14.185 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
----------------------------- Captured log setup ------------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m | src.core.config           | [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[31mERROR[0m | src.core.database         | Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stderr call -----------------------------
2026-02-03 22:31:14.187 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
------------------------------ Captured log call ------------------------------
INFO     src.core.config:config.py:490 [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
WARNING  src.core.database:database.py:77 [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    src.core.database:database.py:87 Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
-------------------------- Captured stdout teardown ---------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
-------------------------- Captured stderr teardown ---------------------------
2026-02-03 22:31:18.888 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:18.888 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:18.888 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:18.888 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:18.888 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:18.888 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:18.888 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:18.888 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:18.889 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:18.889 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:18.889 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:18.889 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
---------------------------- Captured log teardown ----------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
______________ TestUIRecipeDisplay.test_recipe_detail_rendering _______________
.venv\Lib\site-packages\streamlit\elements\spinner.py:116: in spinner
    create_transient, clear_transient = self.dg._transient(
.venv\Lib\site-packages\streamlit\delta_generator.py:636: in _transient
    transient_cursor = self._get_transient_cursor()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\delta_generator.py:441: in _get_transient_cursor
    raise NoSessionContext("Cursor is not set")
E   streamlit.errors.NoSessionContext: Cursor is not set

During handling of the above exception, another exception occurred:
tests\integration\test_phase_16_expanded.py:688: in test_recipe_detail_rendering
    with get_db_context() as session:
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src\core\database.py:149: in obtenir_contexte_db
    fabrique = obtenir_fabrique_session()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:120: in obtenir_fabrique_session
    moteur = obtenir_moteur()
             ^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:281: in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:326: in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:385: in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:88: in obtenir_moteur
    raise ErreurBaseDeDonnees(
E   src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found
E   
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stdout setup ----------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
---------------------------- Captured stderr setup ----------------------------
2026-02-03 22:31:18.890 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:18.890 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:18.890 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:18.890 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:18.890 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:18.890 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:18.890 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:18.890 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:18.890 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:18.890 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:18.890 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:18.890 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
----------------------------- Captured log setup ------------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m | src.core.config           | [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[31mERROR[0m | src.core.database         | Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stderr call -----------------------------
2026-02-03 22:31:18.892 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
------------------------------ Captured log call ------------------------------
INFO     src.core.config:config.py:490 [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
WARNING  src.core.database:database.py:77 [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    src.core.database:database.py:87 Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
-------------------------- Captured stdout teardown ---------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
-------------------------- Captured stderr teardown ---------------------------
2026-02-03 22:31:23.556 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:23.556 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:23.557 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:23.557 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:23.557 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:23.557 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:23.557 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:23.557 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:23.557 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:23.557 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:23.557 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:23.557 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
---------------------------- Captured log teardown ----------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
_______________ TestUIPlanningDisplay.test_planning_weekly_view _______________
.venv\Lib\site-packages\streamlit\elements\spinner.py:116: in spinner
    create_transient, clear_transient = self.dg._transient(
.venv\Lib\site-packages\streamlit\delta_generator.py:636: in _transient
    transient_cursor = self._get_transient_cursor()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\delta_generator.py:441: in _get_transient_cursor
    raise NoSessionContext("Cursor is not set")
E   streamlit.errors.NoSessionContext: Cursor is not set

During handling of the above exception, another exception occurred:
tests\integration\test_phase_16_expanded.py:713: in test_planning_weekly_view
    with get_db_context() as session:
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src\core\database.py:149: in obtenir_contexte_db
    fabrique = obtenir_fabrique_session()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:120: in obtenir_fabrique_session
    moteur = obtenir_moteur()
             ^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:281: in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:326: in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:385: in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:88: in obtenir_moteur
    raise ErreurBaseDeDonnees(
E   src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.145.223), port 6543 failed: FATAL:  Tenant or user not found
E   
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stdout setup ----------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
---------------------------- Captured stderr setup ----------------------------
2026-02-03 22:31:23.558 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:23.558 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:23.558 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:23.558 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:23.558 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:23.558 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:23.558 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:23.558 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:23.558 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:23.558 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:23.558 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:23.558 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
----------------------------- Captured log setup ------------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m | src.core.config           | [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.145.223), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.145.223), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[31mERROR[0m | src.core.database         | Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.145.223), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stderr call -----------------------------
2026-02-03 22:31:23.560 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
------------------------------ Captured log call ------------------------------
INFO     src.core.config:config.py:490 [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
WARNING  src.core.database:database.py:77 [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.145.223), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.145.223), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    src.core.database:database.py:87 Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.145.223), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
-------------------------- Captured stdout teardown ---------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
-------------------------- Captured stderr teardown ---------------------------
2026-02-03 22:31:28.301 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:28.301 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:28.301 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:28.301 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:28.301 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:28.301 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:28.301 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:28.301 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:28.301 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:28.301 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:28.301 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:28.302 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
---------------------------- Captured log teardown ----------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
________________ TestUIShoppingDisplay.test_shopping_list_view ________________
.venv\Lib\site-packages\streamlit\elements\spinner.py:116: in spinner
    create_transient, clear_transient = self.dg._transient(
.venv\Lib\site-packages\streamlit\delta_generator.py:636: in _transient
    transient_cursor = self._get_transient_cursor()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\delta_generator.py:441: in _get_transient_cursor
    raise NoSessionContext("Cursor is not set")
E   streamlit.errors.NoSessionContext: Cursor is not set

During handling of the above exception, another exception occurred:
tests\integration\test_phase_16_expanded.py:756: in test_shopping_list_view
    with get_db_context() as session:
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src\core\database.py:149: in obtenir_contexte_db
    fabrique = obtenir_fabrique_session()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:120: in obtenir_fabrique_session
    moteur = obtenir_moteur()
             ^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:281: in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:326: in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:385: in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:88: in obtenir_moteur
    raise ErreurBaseDeDonnees(
E   src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.145.223), port 6543 failed: FATAL:  Tenant or user not found
E   
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stdout setup ----------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
---------------------------- Captured stderr setup ----------------------------
2026-02-03 22:31:28.302 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:28.303 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:28.303 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:28.303 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:28.303 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:28.303 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:28.303 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:28.303 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:28.303 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:28.303 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:28.303 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:28.303 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
----------------------------- Captured log setup ------------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m | src.core.config           | [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.145.223), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.145.223), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.145.223), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[31mERROR[0m | src.core.database         | Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.145.223), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stderr call -----------------------------
2026-02-03 22:31:28.305 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
------------------------------ Captured log call ------------------------------
INFO     src.core.config:config.py:490 [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
WARNING  src.core.database:database.py:77 [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.145.223), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.145.223), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.145.223), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    src.core.database:database.py:87 Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.145.223), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
-------------------------- Captured stdout teardown ---------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
-------------------------- Captured stderr teardown ---------------------------
2026-02-03 22:31:32.963 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:32.963 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:32.963 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:32.963 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:32.963 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:32.963 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:32.964 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:32.964 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:32.964 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:32.964 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:32.964 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:32.964 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
---------------------------- Captured log teardown ----------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
___________ TestEndToEndWorkflows.test_complete_meal_prep_workflow ____________
.venv\Lib\site-packages\streamlit\elements\spinner.py:116: in spinner
    create_transient, clear_transient = self.dg._transient(
.venv\Lib\site-packages\streamlit\delta_generator.py:636: in _transient
    transient_cursor = self._get_transient_cursor()
                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\delta_generator.py:441: in _get_transient_cursor
    raise NoSessionContext("Cursor is not set")
E   streamlit.errors.NoSessionContext: Cursor is not set

During handling of the above exception, another exception occurred:
tests\integration\test_phase_16_expanded.py:796: in test_complete_meal_prep_workflow
    with get_db_context() as session:
C:\Program Files\WindowsApps\PythonSoftwareFoundation.Python.3.11_3.11.2544.0_x64__qbz5n2kfra8p0\Lib\contextlib.py:137: in __enter__
    return next(self.gen)
           ^^^^^^^^^^^^^^
src\core\database.py:149: in obtenir_contexte_db
    fabrique = obtenir_fabrique_session()
               ^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:120: in obtenir_fabrique_session
    moteur = obtenir_moteur()
             ^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:281: in __call__
    return self._get_or_create_cached_value(args, kwargs, spinner_message)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:326: in _get_or_create_cached_value
    return self._handle_cache_miss(cache, value_key, func_args, func_kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
.venv\Lib\site-packages\streamlit\runtime\caching\cache_utils.py:385: in _handle_cache_miss
    computed_value = self._info.func(*func_args, **func_kwargs)
                     ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
src\core\database.py:88: in obtenir_moteur
    raise ErreurBaseDeDonnees(
E   src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found
E   
E   (Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stdout setup ----------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
---------------------------- Captured stderr setup ----------------------------
2026-02-03 22:31:32.965 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:32.965 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:32.965 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:32.965 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:32.965 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:32.965 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:32.965 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:32.965 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:32.965 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:32.965 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:32.965 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:32.965 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
----------------------------- Captured log setup ------------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
---------------------------- Captured stdout call -----------------------------
[32mINFO[0m | src.core.config           | [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.145.223), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.145.223), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[33mWARNING[0m | src.core.database         | [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
[31mERROR[0m | src.core.database         | Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
---------------------------- Captured stderr call -----------------------------
2026-02-03 22:31:32.967 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
------------------------------ Captured log call ------------------------------
INFO     src.core.config:config.py:490 [OK] Configuration chargée: Assistant MaTanne v2 v2.0.0
WARNING  src.core.database:database.py:77 [ERROR] Tentative 1/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.145.223), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 2/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.145.223), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
WARNING  src.core.database:database.py:77 [ERROR] Tentative 3/3 échouée: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
ERROR    src.core.database:database.py:87 Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
-------------------------- Captured stdout teardown ---------------------------
[32mINFO[0m | src.core.cache            | Cache cleared
-------------------------- Captured stderr teardown ---------------------------
2026-02-03 22:31:37.625 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:37.625 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:37.625 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:37.625 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:37.625 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:37.626 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:37.626 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:37.626 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:37.626 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:37.626 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:37.626 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
2026-02-03 22:31:37.626 Thread 'MainThread': missing ScriptRunContext! This warning can be ignored when running in bare mode.
---------------------------- Captured log teardown ----------------------------
INFO     src.core.cache:cache.py:164 Cache cleared
=========================== short test summary info ===========================
FAILED tests/integration/test_phase_16_expanded.py::TestRecetteServiceExpanded::test_recette_create_and_retrieve - src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
FAILED tests/integration/test_phase_16_expanded.py::TestRecetteServiceExpanded::test_recette_with_ingredients - src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
FAILED tests/integration/test_phase_16_expanded.py::TestRecetteServiceExpanded::test_recette_filtering_by_difficulte - src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
FAILED tests/integration/test_phase_16_expanded.py::TestRecetteServiceExpanded::test_recette_update_and_save - src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
FAILED tests/integration/test_phase_16_expanded.py::TestRecetteServiceExpanded::test_recette_delete - src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
FAILED tests/integration/test_phase_16_expanded.py::TestPlanningServiceExpanded::test_planning_create_week - src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
FAILED tests/integration/test_phase_16_expanded.py::TestPlanningServiceExpanded::test_planning_with_multiple_recipes - src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
FAILED tests/integration/test_phase_16_expanded.py::TestPlanningServiceExpanded::test_planning_auto_generated_flag - src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
FAILED tests/integration/test_phase_16_expanded.py::TestPlanningServiceExpanded::test_planning_date_overlap_detection - src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
FAILED tests/integration/test_phase_16_expanded.py::TestCoursesServiceExpanded::test_article_courses_create - src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
FAILED tests/integration/test_phase_16_expanded.py::TestCoursesServiceExpanded::test_article_courses_mark_purchased - src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
FAILED tests/integration/test_phase_16_expanded.py::TestCoursesServiceExpanded::test_article_courses_by_category - src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
FAILED tests/integration/test_phase_16_expanded.py::TestCoursesServiceExpanded::test_article_courses_essential_items - src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
FAILED tests/integration/test_phase_16_expanded.py::TestInventaireServiceExpanded::test_article_inventaire_create - src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
FAILED tests/integration/test_phase_16_expanded.py::TestInventaireServiceExpanded::test_article_inventaire_low_stock_alert - src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
FAILED tests/integration/test_phase_16_expanded.py::TestInventaireServiceExpanded::test_article_inventaire_update_quantity - src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
FAILED tests/integration/test_phase_16_expanded.py::TestInventaireServiceExpanded::test_article_inventaire_locations - src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
FAILED tests/integration/test_phase_16_expanded.py::TestInventaireServiceExpanded::test_article_inventaire_with_historique - src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
FAILED tests/integration/test_phase_16_expanded.py::TestDomainRecetteComplex::test_recette_seasonal_variations - src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
FAILED tests/integration/test_phase_16_expanded.py::TestDomainRecetteComplex::test_recette_diet_restrictions - src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
FAILED tests/integration/test_phase_16_expanded.py::TestDomainRecetteComplex::test_recette_cost_calculation - src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
FAILED tests/integration/test_phase_16_expanded.py::TestDomainPlanningComplex::test_planning_weekly_nutrition_balance - src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
FAILED tests/integration/test_phase_16_expanded.py::TestDomainShoppingComplex::test_shopping_list_budget_tracking - src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
FAILED tests/integration/test_phase_16_expanded.py::TestUIRecipeDisplay::test_recipe_detail_rendering - src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
FAILED tests/integration/test_phase_16_expanded.py::TestUIPlanningDisplay::test_planning_weekly_view - src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.145.223), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
FAILED tests/integration/test_phase_16_expanded.py::TestUIShoppingDisplay::test_shopping_list_view - src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.145.223), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
FAILED tests/integration/test_phase_16_expanded.py::TestEndToEndWorkflows::test_complete_meal_prep_workflow - src.core.errors_base.ErreurBaseDeDonnees: Impossible de se connecter après 3 tentatives: (psycopg2.OperationalError) connection to server at "aws-0-eu-central-1.pooler.supabase.com" (18.198.30.239), port 6543 failed: FATAL:  Tenant or user not found

(Background on this error at: https://sqlalche.me/e/20/e3q8)
================= 27 failed, 2 warnings in 132.64s (0:02:12) ==================


STDERR:


Return code: 1